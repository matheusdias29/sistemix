(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function $x(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var zv={exports:{}},_e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sl=Symbol.for("react.element"),Hx=Symbol.for("react.portal"),qx=Symbol.for("react.fragment"),Wx=Symbol.for("react.strict_mode"),Gx=Symbol.for("react.profiler"),Kx=Symbol.for("react.provider"),Qx=Symbol.for("react.context"),Yx=Symbol.for("react.forward_ref"),Xx=Symbol.for("react.suspense"),Jx=Symbol.for("react.memo"),Zx=Symbol.for("react.lazy"),zp=Symbol.iterator;function eN(t){return t===null||typeof t!="object"?null:(t=zp&&t[zp]||t["@@iterator"],typeof t=="function"?t:null)}var $v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Hv=Object.assign,qv={};function Pi(t,e,n){this.props=t,this.context=e,this.refs=qv,this.updater=n||$v}Pi.prototype.isReactComponent={};Pi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Pi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Wv(){}Wv.prototype=Pi.prototype;function bh(t,e,n){this.props=t,this.context=e,this.refs=qv,this.updater=n||$v}var Sh=bh.prototype=new Wv;Sh.constructor=bh;Hv(Sh,Pi.prototype);Sh.isPureReactComponent=!0;var $p=Array.isArray,Gv=Object.prototype.hasOwnProperty,Ch={current:null},Kv={key:!0,ref:!0,__self:!0,__source:!0};function Qv(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Gv.call(e,r)&&!Kv.hasOwnProperty(r)&&(s[r]=e[r]);var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)s[r]===void 0&&(s[r]=c[r]);return{$$typeof:sl,type:t,key:i,ref:o,props:s,_owner:Ch.current}}function tN(t,e){return{$$typeof:sl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ih(t){return typeof t=="object"&&t!==null&&t.$$typeof===sl}function nN(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Hp=/\/+/g;function md(t,e){return typeof t=="object"&&t!==null&&t.key!=null?nN(""+t.key):e.toString(36)}function ec(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case sl:case Hx:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+md(o,0):r,$p(s)?(n="",t!=null&&(n=t.replace(Hp,"$&/")+"/"),ec(s,e,n,"",function(d){return d})):s!=null&&(Ih(s)&&(s=tN(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Hp,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",$p(t))for(var c=0;c<t.length;c++){i=t[c];var u=r+md(i,c);o+=ec(i,e,n,u,s)}else if(u=eN(t),typeof u=="function")for(t=u.call(t),c=0;!(i=t.next()).done;)i=i.value,u=r+md(i,c++),o+=ec(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Al(t,e,n){if(t==null)return t;var r=[],s=0;return ec(t,r,"","",function(i){return e.call(n,i,s++)}),r}function rN(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Zt={current:null},tc={transition:null},sN={ReactCurrentDispatcher:Zt,ReactCurrentBatchConfig:tc,ReactCurrentOwner:Ch};function Yv(){throw Error("act(...) is not supported in production builds of React.")}_e.Children={map:Al,forEach:function(t,e,n){Al(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Al(t,function(){e++}),e},toArray:function(t){return Al(t,function(e){return e})||[]},only:function(t){if(!Ih(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};_e.Component=Pi;_e.Fragment=qx;_e.Profiler=Gx;_e.PureComponent=bh;_e.StrictMode=Wx;_e.Suspense=Xx;_e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sN;_e.act=Yv;_e.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Hv({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Ch.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)Gv.call(e,u)&&!Kv.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:sl,type:t.type,key:s,ref:i,props:r,_owner:o}};_e.createContext=function(t){return t={$$typeof:Qx,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Kx,_context:t},t.Consumer=t};_e.createElement=Qv;_e.createFactory=function(t){var e=Qv.bind(null,t);return e.type=t,e};_e.createRef=function(){return{current:null}};_e.forwardRef=function(t){return{$$typeof:Yx,render:t}};_e.isValidElement=Ih;_e.lazy=function(t){return{$$typeof:Zx,_payload:{_status:-1,_result:t},_init:rN}};_e.memo=function(t,e){return{$$typeof:Jx,type:t,compare:e===void 0?null:e}};_e.startTransition=function(t){var e=tc.transition;tc.transition={};try{t()}finally{tc.transition=e}};_e.unstable_act=Yv;_e.useCallback=function(t,e){return Zt.current.useCallback(t,e)};_e.useContext=function(t){return Zt.current.useContext(t)};_e.useDebugValue=function(){};_e.useDeferredValue=function(t){return Zt.current.useDeferredValue(t)};_e.useEffect=function(t,e){return Zt.current.useEffect(t,e)};_e.useId=function(){return Zt.current.useId()};_e.useImperativeHandle=function(t,e,n){return Zt.current.useImperativeHandle(t,e,n)};_e.useInsertionEffect=function(t,e){return Zt.current.useInsertionEffect(t,e)};_e.useLayoutEffect=function(t,e){return Zt.current.useLayoutEffect(t,e)};_e.useMemo=function(t,e){return Zt.current.useMemo(t,e)};_e.useReducer=function(t,e,n){return Zt.current.useReducer(t,e,n)};_e.useRef=function(t){return Zt.current.useRef(t)};_e.useState=function(t){return Zt.current.useState(t)};_e.useSyncExternalStore=function(t,e,n){return Zt.current.useSyncExternalStore(t,e,n)};_e.useTransition=function(){return Zt.current.useTransition()};_e.version="18.3.1";zv.exports=_e;var E=zv.exports;const a=$x(E);var Xv={exports:{}},bn={},Jv={exports:{}},Zv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,q){var Z=H.length;H.push(q);e:for(;0<Z;){var K=Z-1>>>1,se=H[K];if(0<s(se,q))H[K]=q,H[Z]=se,Z=K;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var q=H[0],Z=H.pop();if(Z!==q){H[0]=Z;e:for(var K=0,se=H.length,U=se>>>1;K<U;){var G=2*(K+1)-1,re=H[G],fe=G+1,Ee=H[fe];if(0>s(re,Z))fe<se&&0>s(Ee,re)?(H[K]=Ee,H[fe]=Z,K=fe):(H[K]=re,H[G]=Z,K=G);else if(fe<se&&0>s(Ee,Z))H[K]=Ee,H[fe]=Z,K=fe;else break e}}return q}function s(H,q){var Z=H.sortIndex-q.sortIndex;return Z!==0?Z:H.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],d=[],h=1,p=null,y=3,S=!1,P=!1,w=!1,A=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(H){for(var q=n(d);q!==null;){if(q.callback===null)r(d);else if(q.startTime<=H)r(d),q.sortIndex=q.expirationTime,e(u,q);else break;q=n(d)}}function D(H){if(w=!1,I(H),!P)if(n(u)!==null)P=!0,we(M);else{var q=n(d);q!==null&&Ae(D,q.startTime-H)}}function M(H,q){P=!1,w&&(w=!1,_(g),g=-1),S=!0;var Z=y;try{for(I(q),p=n(u);p!==null&&(!(p.expirationTime>q)||H&&!k());){var K=p.callback;if(typeof K=="function"){p.callback=null,y=p.priorityLevel;var se=K(p.expirationTime<=q);q=t.unstable_now(),typeof se=="function"?p.callback=se:p===n(u)&&r(u),I(q)}else r(u);p=n(u)}if(p!==null)var U=!0;else{var G=n(d);G!==null&&Ae(D,G.startTime-q),U=!1}return U}finally{p=null,y=Z,S=!1}}var V=!1,b=null,g=-1,x=5,T=-1;function k(){return!(t.unstable_now()-T<x)}function R(){if(b!==null){var H=t.unstable_now();T=H;var q=!0;try{q=b(!0,H)}finally{q?C():(V=!1,b=null)}}else V=!1}var C;if(typeof v=="function")C=function(){v(R)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,Se=te.port2;te.port1.onmessage=R,C=function(){Se.postMessage(null)}}else C=function(){A(R,0)};function we(H){b=H,V||(V=!0,C())}function Ae(H,q){g=A(function(){H(t.unstable_now())},q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){P||S||(P=!0,we(M))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(H){switch(y){case 1:case 2:case 3:var q=3;break;default:q=y}var Z=y;y=q;try{return H()}finally{y=Z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,q){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var Z=y;y=H;try{return q()}finally{y=Z}},t.unstable_scheduleCallback=function(H,q,Z){var K=t.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?K+Z:K):Z=K,H){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=Z+se,H={id:h++,callback:q,priorityLevel:H,startTime:Z,expirationTime:se,sortIndex:-1},Z>K?(H.sortIndex=Z,e(d,H),n(u)===null&&H===n(d)&&(w?(_(g),g=-1):w=!0,Ae(D,Z-K))):(H.sortIndex=se,e(u,H),P||S||(P=!0,we(M))),H},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(H){var q=y;return function(){var Z=y;y=q;try{return H.apply(this,arguments)}finally{y=Z}}}})(Zv);Jv.exports=Zv;var aN=Jv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iN=E,Nn=aN;function W(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var eE=new Set,To={};function Va(t,e){Ei(t,e),Ei(t+"Capture",e)}function Ei(t,e){for(To[t]=e,t=0;t<e.length;t++)eE.add(e[t])}var zr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Xd=Object.prototype.hasOwnProperty,oN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,qp={},Wp={};function lN(t){return Xd.call(Wp,t)?!0:Xd.call(qp,t)?!1:oN.test(t)?Wp[t]=!0:(qp[t]=!0,!1)}function cN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function uN(t,e,n,r){if(e===null||typeof e>"u"||cN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function en(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Vt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Vt[t]=new en(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Vt[e]=new en(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Vt[t]=new en(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Vt[t]=new en(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Vt[t]=new en(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Vt[t]=new en(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Vt[t]=new en(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Vt[t]=new en(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Vt[t]=new en(t,5,!1,t.toLowerCase(),null,!1,!1)});var Th=/[\-:]([a-z])/g;function Ah(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Th,Ah);Vt[e]=new en(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Th,Ah);Vt[e]=new en(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Th,Ah);Vt[e]=new en(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Vt[t]=new en(t,1,!1,t.toLowerCase(),null,!1,!1)});Vt.xlinkHref=new en("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Vt[t]=new en(t,1,!1,t.toLowerCase(),null,!0,!0)});function kh(t,e,n,r){var s=Vt.hasOwnProperty(e)?Vt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(uN(e,n,s,r)&&(n=null),r||s===null?lN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Yr=iN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,kl=Symbol.for("react.element"),Ya=Symbol.for("react.portal"),Xa=Symbol.for("react.fragment"),Ph=Symbol.for("react.strict_mode"),Jd=Symbol.for("react.profiler"),tE=Symbol.for("react.provider"),nE=Symbol.for("react.context"),Rh=Symbol.for("react.forward_ref"),Zd=Symbol.for("react.suspense"),em=Symbol.for("react.suspense_list"),Dh=Symbol.for("react.memo"),fs=Symbol.for("react.lazy"),rE=Symbol.for("react.offscreen"),Gp=Symbol.iterator;function Gi(t){return t===null||typeof t!="object"?null:(t=Gp&&t[Gp]||t["@@iterator"],typeof t=="function"?t:null)}var Ke=Object.assign,hd;function no(t){if(hd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);hd=e&&e[1]||""}return`
`+hd+t}var fd=!1;function pd(t,e){if(!t||fd)return"";fd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,c=i.length-1;1<=o&&0<=c&&s[o]!==i[c];)c--;for(;1<=o&&0<=c;o--,c--)if(s[o]!==i[c]){if(o!==1||c!==1)do if(o--,c--,0>c||s[o]!==i[c]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=c);break}}}finally{fd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?no(t):""}function dN(t){switch(t.tag){case 5:return no(t.type);case 16:return no("Lazy");case 13:return no("Suspense");case 19:return no("SuspenseList");case 0:case 2:case 15:return t=pd(t.type,!1),t;case 11:return t=pd(t.type.render,!1),t;case 1:return t=pd(t.type,!0),t;default:return""}}function tm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Xa:return"Fragment";case Ya:return"Portal";case Jd:return"Profiler";case Ph:return"StrictMode";case Zd:return"Suspense";case em:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case nE:return(t.displayName||"Context")+".Consumer";case tE:return(t._context.displayName||"Context")+".Provider";case Rh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Dh:return e=t.displayName||null,e!==null?e:tm(t.type)||"Memo";case fs:e=t._payload,t=t._init;try{return tm(t(e))}catch{}}return null}function mN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return tm(e);case 8:return e===Ph?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ls(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function sE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function hN(t){var e=sE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Pl(t){t._valueTracker||(t._valueTracker=hN(t))}function aE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=sE(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function xc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function nm(t,e){var n=e.checked;return Ke({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Kp(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ls(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function iE(t,e){e=e.checked,e!=null&&kh(t,"checked",e,!1)}function rm(t,e){iE(t,e);var n=Ls(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?sm(t,e.type,n):e.hasOwnProperty("defaultValue")&&sm(t,e.type,Ls(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Qp(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function sm(t,e,n){(e!=="number"||xc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ro=Array.isArray;function ci(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ls(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function am(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(W(91));return Ke({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Yp(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(W(92));if(ro(n)){if(1<n.length)throw Error(W(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ls(n)}}function oE(t,e){var n=Ls(e.value),r=Ls(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Xp(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function lE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function im(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?lE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Rl,cE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Rl=Rl||document.createElement("div"),Rl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Rl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ao(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ho={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fN=["Webkit","ms","Moz","O"];Object.keys(ho).forEach(function(t){fN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ho[e]=ho[t]})});function uE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ho.hasOwnProperty(t)&&ho[t]?(""+e).trim():e+"px"}function dE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=uE(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var pN=Ke({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function om(t,e){if(e){if(pN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(W(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(W(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(e.style!=null&&typeof e.style!="object")throw Error(W(62))}}function lm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var cm=null;function Vh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var um=null,ui=null,di=null;function Jp(t){if(t=ol(t)){if(typeof um!="function")throw Error(W(280));var e=t.stateNode;e&&(e=wu(e),um(t.stateNode,t.type,e))}}function mE(t){ui?di?di.push(t):di=[t]:ui=t}function hE(){if(ui){var t=ui,e=di;if(di=ui=null,Jp(t),e)for(t=0;t<e.length;t++)Jp(e[t])}}function fE(t,e){return t(e)}function pE(){}var gd=!1;function gE(t,e,n){if(gd)return t(e,n);gd=!0;try{return fE(t,e,n)}finally{gd=!1,(ui!==null||di!==null)&&(pE(),hE())}}function ko(t,e){var n=t.stateNode;if(n===null)return null;var r=wu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(W(231,e,typeof n));return n}var dm=!1;if(zr)try{var Ki={};Object.defineProperty(Ki,"passive",{get:function(){dm=!0}}),window.addEventListener("test",Ki,Ki),window.removeEventListener("test",Ki,Ki)}catch{dm=!1}function gN(t,e,n,r,s,i,o,c,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var fo=!1,Nc=null,bc=!1,mm=null,yN={onError:function(t){fo=!0,Nc=t}};function vN(t,e,n,r,s,i,o,c,u){fo=!1,Nc=null,gN.apply(yN,arguments)}function EN(t,e,n,r,s,i,o,c,u){if(vN.apply(this,arguments),fo){if(fo){var d=Nc;fo=!1,Nc=null}else throw Error(W(198));bc||(bc=!0,mm=d)}}function Oa(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function yE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Zp(t){if(Oa(t)!==t)throw Error(W(188))}function _N(t){var e=t.alternate;if(!e){if(e=Oa(t),e===null)throw Error(W(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Zp(s),t;if(i===r)return Zp(s),e;i=i.sibling}throw Error(W(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,c=s.child;c;){if(c===n){o=!0,n=s,r=i;break}if(c===r){o=!0,r=s,n=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===n){o=!0,n=i,r=s;break}if(c===r){o=!0,r=i,n=s;break}c=c.sibling}if(!o)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?t:e}function vE(t){return t=_N(t),t!==null?EE(t):null}function EE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=EE(t);if(e!==null)return e;t=t.sibling}return null}var _E=Nn.unstable_scheduleCallback,eg=Nn.unstable_cancelCallback,wN=Nn.unstable_shouldYield,xN=Nn.unstable_requestPaint,rt=Nn.unstable_now,NN=Nn.unstable_getCurrentPriorityLevel,Oh=Nn.unstable_ImmediatePriority,wE=Nn.unstable_UserBlockingPriority,Sc=Nn.unstable_NormalPriority,bN=Nn.unstable_LowPriority,xE=Nn.unstable_IdlePriority,yu=null,gr=null;function SN(t){if(gr&&typeof gr.onCommitFiberRoot=="function")try{gr.onCommitFiberRoot(yu,t,void 0,(t.current.flags&128)===128)}catch{}}var Zn=Math.clz32?Math.clz32:TN,CN=Math.log,IN=Math.LN2;function TN(t){return t>>>=0,t===0?32:31-(CN(t)/IN|0)|0}var Dl=64,Vl=4194304;function so(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Cc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~s;c!==0?r=so(c):(i&=o,i!==0&&(r=so(i)))}else o=n&~s,o!==0?r=so(o):i!==0&&(r=so(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Zn(e),s=1<<n,r|=t[n],e&=~s;return r}function AN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kN(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Zn(i),c=1<<o,u=s[o];u===-1?(!(c&n)||c&r)&&(s[o]=AN(c,e)):u<=e&&(t.expiredLanes|=c),i&=~c}}function hm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function NE(){var t=Dl;return Dl<<=1,!(Dl&4194240)&&(Dl=64),t}function yd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function al(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Zn(e),t[e]=n}function PN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Zn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Mh(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Zn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var De=0;function bE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var SE,Lh,CE,IE,TE,fm=!1,Ol=[],Ss=null,Cs=null,Is=null,Po=new Map,Ro=new Map,gs=[],RN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tg(t,e){switch(t){case"focusin":case"focusout":Ss=null;break;case"dragenter":case"dragleave":Cs=null;break;case"mouseover":case"mouseout":Is=null;break;case"pointerover":case"pointerout":Po.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ro.delete(e.pointerId)}}function Qi(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=ol(e),e!==null&&Lh(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function DN(t,e,n,r,s){switch(e){case"focusin":return Ss=Qi(Ss,t,e,n,r,s),!0;case"dragenter":return Cs=Qi(Cs,t,e,n,r,s),!0;case"mouseover":return Is=Qi(Is,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Po.set(i,Qi(Po.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Ro.set(i,Qi(Ro.get(i)||null,t,e,n,r,s)),!0}return!1}function AE(t){var e=pa(t.target);if(e!==null){var n=Oa(e);if(n!==null){if(e=n.tag,e===13){if(e=yE(n),e!==null){t.blockedOn=e,TE(t.priority,function(){CE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function nc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=pm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);cm=r,n.target.dispatchEvent(r),cm=null}else return e=ol(n),e!==null&&Lh(e),t.blockedOn=n,!1;e.shift()}return!0}function ng(t,e,n){nc(t)&&n.delete(e)}function VN(){fm=!1,Ss!==null&&nc(Ss)&&(Ss=null),Cs!==null&&nc(Cs)&&(Cs=null),Is!==null&&nc(Is)&&(Is=null),Po.forEach(ng),Ro.forEach(ng)}function Yi(t,e){t.blockedOn===e&&(t.blockedOn=null,fm||(fm=!0,Nn.unstable_scheduleCallback(Nn.unstable_NormalPriority,VN)))}function Do(t){function e(s){return Yi(s,t)}if(0<Ol.length){Yi(Ol[0],t);for(var n=1;n<Ol.length;n++){var r=Ol[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ss!==null&&Yi(Ss,t),Cs!==null&&Yi(Cs,t),Is!==null&&Yi(Is,t),Po.forEach(e),Ro.forEach(e),n=0;n<gs.length;n++)r=gs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<gs.length&&(n=gs[0],n.blockedOn===null);)AE(n),n.blockedOn===null&&gs.shift()}var mi=Yr.ReactCurrentBatchConfig,Ic=!0;function ON(t,e,n,r){var s=De,i=mi.transition;mi.transition=null;try{De=1,Fh(t,e,n,r)}finally{De=s,mi.transition=i}}function MN(t,e,n,r){var s=De,i=mi.transition;mi.transition=null;try{De=4,Fh(t,e,n,r)}finally{De=s,mi.transition=i}}function Fh(t,e,n,r){if(Ic){var s=pm(t,e,n,r);if(s===null)Id(t,e,r,Tc,n),tg(t,r);else if(DN(s,t,e,n,r))r.stopPropagation();else if(tg(t,r),e&4&&-1<RN.indexOf(t)){for(;s!==null;){var i=ol(s);if(i!==null&&SE(i),i=pm(t,e,n,r),i===null&&Id(t,e,r,Tc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Id(t,e,r,null,n)}}var Tc=null;function pm(t,e,n,r){if(Tc=null,t=Vh(r),t=pa(t),t!==null)if(e=Oa(t),e===null)t=null;else if(n=e.tag,n===13){if(t=yE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Tc=t,null}function kE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(NN()){case Oh:return 1;case wE:return 4;case Sc:case bN:return 16;case xE:return 536870912;default:return 16}default:return 16}}var xs=null,Uh=null,rc=null;function PE(){if(rc)return rc;var t,e=Uh,n=e.length,r,s="value"in xs?xs.value:xs.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return rc=s.slice(t,1<r?1-r:void 0)}function sc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ml(){return!0}function rg(){return!1}function Sn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ml:rg,this.isPropagationStopped=rg,this}return Ke(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ml)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ml)},persist:function(){},isPersistent:Ml}),e}var Ri={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jh=Sn(Ri),il=Ke({},Ri,{view:0,detail:0}),LN=Sn(il),vd,Ed,Xi,vu=Ke({},il,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Xi&&(Xi&&t.type==="mousemove"?(vd=t.screenX-Xi.screenX,Ed=t.screenY-Xi.screenY):Ed=vd=0,Xi=t),vd)},movementY:function(t){return"movementY"in t?t.movementY:Ed}}),sg=Sn(vu),FN=Ke({},vu,{dataTransfer:0}),UN=Sn(FN),jN=Ke({},il,{relatedTarget:0}),_d=Sn(jN),BN=Ke({},Ri,{animationName:0,elapsedTime:0,pseudoElement:0}),zN=Sn(BN),$N=Ke({},Ri,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),HN=Sn($N),qN=Ke({},Ri,{data:0}),ag=Sn(qN),WN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},GN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},KN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function QN(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=KN[t])?!!e[t]:!1}function Bh(){return QN}var YN=Ke({},il,{key:function(t){if(t.key){var e=WN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=sc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?GN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bh,charCode:function(t){return t.type==="keypress"?sc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?sc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),XN=Sn(YN),JN=Ke({},vu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ig=Sn(JN),ZN=Ke({},il,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bh}),eb=Sn(ZN),tb=Ke({},Ri,{propertyName:0,elapsedTime:0,pseudoElement:0}),nb=Sn(tb),rb=Ke({},vu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),sb=Sn(rb),ab=[9,13,27,32],zh=zr&&"CompositionEvent"in window,po=null;zr&&"documentMode"in document&&(po=document.documentMode);var ib=zr&&"TextEvent"in window&&!po,RE=zr&&(!zh||po&&8<po&&11>=po),og=" ",lg=!1;function DE(t,e){switch(t){case"keyup":return ab.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function VE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ja=!1;function ob(t,e){switch(t){case"compositionend":return VE(e);case"keypress":return e.which!==32?null:(lg=!0,og);case"textInput":return t=e.data,t===og&&lg?null:t;default:return null}}function lb(t,e){if(Ja)return t==="compositionend"||!zh&&DE(t,e)?(t=PE(),rc=Uh=xs=null,Ja=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return RE&&e.locale!=="ko"?null:e.data;default:return null}}var cb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!cb[t.type]:e==="textarea"}function OE(t,e,n,r){mE(r),e=Ac(e,"onChange"),0<e.length&&(n=new jh("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var go=null,Vo=null;function ub(t){WE(t,0)}function Eu(t){var e=ti(t);if(aE(e))return t}function db(t,e){if(t==="change")return e}var ME=!1;if(zr){var wd;if(zr){var xd="oninput"in document;if(!xd){var ug=document.createElement("div");ug.setAttribute("oninput","return;"),xd=typeof ug.oninput=="function"}wd=xd}else wd=!1;ME=wd&&(!document.documentMode||9<document.documentMode)}function dg(){go&&(go.detachEvent("onpropertychange",LE),Vo=go=null)}function LE(t){if(t.propertyName==="value"&&Eu(Vo)){var e=[];OE(e,Vo,t,Vh(t)),gE(ub,e)}}function mb(t,e,n){t==="focusin"?(dg(),go=e,Vo=n,go.attachEvent("onpropertychange",LE)):t==="focusout"&&dg()}function hb(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Eu(Vo)}function fb(t,e){if(t==="click")return Eu(e)}function pb(t,e){if(t==="input"||t==="change")return Eu(e)}function gb(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var tr=typeof Object.is=="function"?Object.is:gb;function Oo(t,e){if(tr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Xd.call(e,s)||!tr(t[s],e[s]))return!1}return!0}function mg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function hg(t,e){var n=mg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=mg(n)}}function FE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?FE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function UE(){for(var t=window,e=xc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=xc(t.document)}return e}function $h(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function yb(t){var e=UE(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&FE(n.ownerDocument.documentElement,n)){if(r!==null&&$h(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=hg(n,i);var o=hg(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var vb=zr&&"documentMode"in document&&11>=document.documentMode,Za=null,gm=null,yo=null,ym=!1;function fg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ym||Za==null||Za!==xc(r)||(r=Za,"selectionStart"in r&&$h(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),yo&&Oo(yo,r)||(yo=r,r=Ac(gm,"onSelect"),0<r.length&&(e=new jh("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Za)))}function Ll(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ei={animationend:Ll("Animation","AnimationEnd"),animationiteration:Ll("Animation","AnimationIteration"),animationstart:Ll("Animation","AnimationStart"),transitionend:Ll("Transition","TransitionEnd")},Nd={},jE={};zr&&(jE=document.createElement("div").style,"AnimationEvent"in window||(delete ei.animationend.animation,delete ei.animationiteration.animation,delete ei.animationstart.animation),"TransitionEvent"in window||delete ei.transitionend.transition);function _u(t){if(Nd[t])return Nd[t];if(!ei[t])return t;var e=ei[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in jE)return Nd[t]=e[n];return t}var BE=_u("animationend"),zE=_u("animationiteration"),$E=_u("animationstart"),HE=_u("transitionend"),qE=new Map,pg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ks(t,e){qE.set(t,e),Va(e,[t])}for(var bd=0;bd<pg.length;bd++){var Sd=pg[bd],Eb=Sd.toLowerCase(),_b=Sd[0].toUpperCase()+Sd.slice(1);Ks(Eb,"on"+_b)}Ks(BE,"onAnimationEnd");Ks(zE,"onAnimationIteration");Ks($E,"onAnimationStart");Ks("dblclick","onDoubleClick");Ks("focusin","onFocus");Ks("focusout","onBlur");Ks(HE,"onTransitionEnd");Ei("onMouseEnter",["mouseout","mouseover"]);Ei("onMouseLeave",["mouseout","mouseover"]);Ei("onPointerEnter",["pointerout","pointerover"]);Ei("onPointerLeave",["pointerout","pointerover"]);Va("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Va("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Va("onBeforeInput",["compositionend","keypress","textInput","paste"]);Va("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Va("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Va("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ao="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),wb=new Set("cancel close invalid load scroll toggle".split(" ").concat(ao));function gg(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,EN(r,e,void 0,t),t.currentTarget=null}function WE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var c=r[o],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==i&&s.isPropagationStopped())break e;gg(s,c,d),i=u}else for(o=0;o<r.length;o++){if(c=r[o],u=c.instance,d=c.currentTarget,c=c.listener,u!==i&&s.isPropagationStopped())break e;gg(s,c,d),i=u}}}if(bc)throw t=mm,bc=!1,mm=null,t}function Ue(t,e){var n=e[xm];n===void 0&&(n=e[xm]=new Set);var r=t+"__bubble";n.has(r)||(GE(e,t,2,!1),n.add(r))}function Cd(t,e,n){var r=0;e&&(r|=4),GE(n,t,r,e)}var Fl="_reactListening"+Math.random().toString(36).slice(2);function Mo(t){if(!t[Fl]){t[Fl]=!0,eE.forEach(function(n){n!=="selectionchange"&&(wb.has(n)||Cd(n,!1,t),Cd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Fl]||(e[Fl]=!0,Cd("selectionchange",!1,e))}}function GE(t,e,n,r){switch(kE(e)){case 1:var s=ON;break;case 4:s=MN;break;default:s=Fh}n=s.bind(null,e,n,t),s=void 0,!dm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Id(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;c!==null;){if(o=pa(c),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}c=c.parentNode}}r=r.return}gE(function(){var d=i,h=Vh(n),p=[];e:{var y=qE.get(t);if(y!==void 0){var S=jh,P=t;switch(t){case"keypress":if(sc(n)===0)break e;case"keydown":case"keyup":S=XN;break;case"focusin":P="focus",S=_d;break;case"focusout":P="blur",S=_d;break;case"beforeblur":case"afterblur":S=_d;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":S=sg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":S=UN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":S=eb;break;case BE:case zE:case $E:S=zN;break;case HE:S=nb;break;case"scroll":S=LN;break;case"wheel":S=sb;break;case"copy":case"cut":case"paste":S=HN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":S=ig}var w=(e&4)!==0,A=!w&&t==="scroll",_=w?y!==null?y+"Capture":null:y;w=[];for(var v=d,I;v!==null;){I=v;var D=I.stateNode;if(I.tag===5&&D!==null&&(I=D,_!==null&&(D=ko(v,_),D!=null&&w.push(Lo(v,D,I)))),A)break;v=v.return}0<w.length&&(y=new S(y,P,null,n,h),p.push({event:y,listeners:w}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",S=t==="mouseout"||t==="pointerout",y&&n!==cm&&(P=n.relatedTarget||n.fromElement)&&(pa(P)||P[$r]))break e;if((S||y)&&(y=h.window===h?h:(y=h.ownerDocument)?y.defaultView||y.parentWindow:window,S?(P=n.relatedTarget||n.toElement,S=d,P=P?pa(P):null,P!==null&&(A=Oa(P),P!==A||P.tag!==5&&P.tag!==6)&&(P=null)):(S=null,P=d),S!==P)){if(w=sg,D="onMouseLeave",_="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(w=ig,D="onPointerLeave",_="onPointerEnter",v="pointer"),A=S==null?y:ti(S),I=P==null?y:ti(P),y=new w(D,v+"leave",S,n,h),y.target=A,y.relatedTarget=I,D=null,pa(h)===d&&(w=new w(_,v+"enter",P,n,h),w.target=I,w.relatedTarget=A,D=w),A=D,S&&P)t:{for(w=S,_=P,v=0,I=w;I;I=Ha(I))v++;for(I=0,D=_;D;D=Ha(D))I++;for(;0<v-I;)w=Ha(w),v--;for(;0<I-v;)_=Ha(_),I--;for(;v--;){if(w===_||_!==null&&w===_.alternate)break t;w=Ha(w),_=Ha(_)}w=null}else w=null;S!==null&&yg(p,y,S,w,!1),P!==null&&A!==null&&yg(p,A,P,w,!0)}}e:{if(y=d?ti(d):window,S=y.nodeName&&y.nodeName.toLowerCase(),S==="select"||S==="input"&&y.type==="file")var M=db;else if(cg(y))if(ME)M=pb;else{M=hb;var V=mb}else(S=y.nodeName)&&S.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(M=fb);if(M&&(M=M(t,d))){OE(p,M,n,h);break e}V&&V(t,y,d),t==="focusout"&&(V=y._wrapperState)&&V.controlled&&y.type==="number"&&sm(y,"number",y.value)}switch(V=d?ti(d):window,t){case"focusin":(cg(V)||V.contentEditable==="true")&&(Za=V,gm=d,yo=null);break;case"focusout":yo=gm=Za=null;break;case"mousedown":ym=!0;break;case"contextmenu":case"mouseup":case"dragend":ym=!1,fg(p,n,h);break;case"selectionchange":if(vb)break;case"keydown":case"keyup":fg(p,n,h)}var b;if(zh)e:{switch(t){case"compositionstart":var g="onCompositionStart";break e;case"compositionend":g="onCompositionEnd";break e;case"compositionupdate":g="onCompositionUpdate";break e}g=void 0}else Ja?DE(t,n)&&(g="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(g="onCompositionStart");g&&(RE&&n.locale!=="ko"&&(Ja||g!=="onCompositionStart"?g==="onCompositionEnd"&&Ja&&(b=PE()):(xs=h,Uh="value"in xs?xs.value:xs.textContent,Ja=!0)),V=Ac(d,g),0<V.length&&(g=new ag(g,t,null,n,h),p.push({event:g,listeners:V}),b?g.data=b:(b=VE(n),b!==null&&(g.data=b)))),(b=ib?ob(t,n):lb(t,n))&&(d=Ac(d,"onBeforeInput"),0<d.length&&(h=new ag("onBeforeInput","beforeinput",null,n,h),p.push({event:h,listeners:d}),h.data=b))}WE(p,e)})}function Lo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ac(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ko(t,n),i!=null&&r.unshift(Lo(t,i,s)),i=ko(t,e),i!=null&&r.push(Lo(t,i,s))),t=t.return}return r}function Ha(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function yg(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var c=n,u=c.alternate,d=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&d!==null&&(c=d,s?(u=ko(n,i),u!=null&&o.unshift(Lo(n,u,c))):s||(u=ko(n,i),u!=null&&o.push(Lo(n,u,c)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var xb=/\r\n?/g,Nb=/\u0000|\uFFFD/g;function vg(t){return(typeof t=="string"?t:""+t).replace(xb,`
`).replace(Nb,"")}function Ul(t,e,n){if(e=vg(e),vg(t)!==e&&n)throw Error(W(425))}function kc(){}var vm=null,Em=null;function _m(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var wm=typeof setTimeout=="function"?setTimeout:void 0,bb=typeof clearTimeout=="function"?clearTimeout:void 0,Eg=typeof Promise=="function"?Promise:void 0,Sb=typeof queueMicrotask=="function"?queueMicrotask:typeof Eg<"u"?function(t){return Eg.resolve(null).then(t).catch(Cb)}:wm;function Cb(t){setTimeout(function(){throw t})}function Td(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Do(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Do(e)}function Ts(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function _g(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Di=Math.random().toString(36).slice(2),pr="__reactFiber$"+Di,Fo="__reactProps$"+Di,$r="__reactContainer$"+Di,xm="__reactEvents$"+Di,Ib="__reactListeners$"+Di,Tb="__reactHandles$"+Di;function pa(t){var e=t[pr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[$r]||n[pr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=_g(t);t!==null;){if(n=t[pr])return n;t=_g(t)}return e}t=n,n=t.parentNode}return null}function ol(t){return t=t[pr]||t[$r],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ti(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(W(33))}function wu(t){return t[Fo]||null}var Nm=[],ni=-1;function Qs(t){return{current:t}}function Be(t){0>ni||(t.current=Nm[ni],Nm[ni]=null,ni--)}function Le(t,e){ni++,Nm[ni]=t.current,t.current=e}var Fs={},$t=Qs(Fs),cn=Qs(!1),Na=Fs;function _i(t,e){var n=t.type.contextTypes;if(!n)return Fs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function un(t){return t=t.childContextTypes,t!=null}function Pc(){Be(cn),Be($t)}function wg(t,e,n){if($t.current!==Fs)throw Error(W(168));Le($t,e),Le(cn,n)}function KE(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(W(108,mN(t)||"Unknown",s));return Ke({},n,r)}function Rc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Fs,Na=$t.current,Le($t,t),Le(cn,cn.current),!0}function xg(t,e,n){var r=t.stateNode;if(!r)throw Error(W(169));n?(t=KE(t,e,Na),r.__reactInternalMemoizedMergedChildContext=t,Be(cn),Be($t),Le($t,t)):Be(cn),Le(cn,n)}var Vr=null,xu=!1,Ad=!1;function QE(t){Vr===null?Vr=[t]:Vr.push(t)}function Ab(t){xu=!0,QE(t)}function Ys(){if(!Ad&&Vr!==null){Ad=!0;var t=0,e=De;try{var n=Vr;for(De=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Vr=null,xu=!1}catch(s){throw Vr!==null&&(Vr=Vr.slice(t+1)),_E(Oh,Ys),s}finally{De=e,Ad=!1}}return null}var ri=[],si=0,Dc=null,Vc=0,On=[],Mn=0,ba=null,Or=1,Mr="";function ma(t,e){ri[si++]=Vc,ri[si++]=Dc,Dc=t,Vc=e}function YE(t,e,n){On[Mn++]=Or,On[Mn++]=Mr,On[Mn++]=ba,ba=t;var r=Or;t=Mr;var s=32-Zn(r)-1;r&=~(1<<s),n+=1;var i=32-Zn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Or=1<<32-Zn(e)+s|n<<s|r,Mr=i+t}else Or=1<<i|n<<s|r,Mr=t}function Hh(t){t.return!==null&&(ma(t,1),YE(t,1,0))}function qh(t){for(;t===Dc;)Dc=ri[--si],ri[si]=null,Vc=ri[--si],ri[si]=null;for(;t===ba;)ba=On[--Mn],On[Mn]=null,Mr=On[--Mn],On[Mn]=null,Or=On[--Mn],On[Mn]=null}var xn=null,_n=null,qe=!1,Yn=null;function XE(t,e){var n=Fn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ng(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,xn=t,_n=Ts(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,xn=t,_n=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ba!==null?{id:Or,overflow:Mr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Fn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,xn=t,_n=null,!0):!1;default:return!1}}function bm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Sm(t){if(qe){var e=_n;if(e){var n=e;if(!Ng(t,e)){if(bm(t))throw Error(W(418));e=Ts(n.nextSibling);var r=xn;e&&Ng(t,e)?XE(r,n):(t.flags=t.flags&-4097|2,qe=!1,xn=t)}}else{if(bm(t))throw Error(W(418));t.flags=t.flags&-4097|2,qe=!1,xn=t}}}function bg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;xn=t}function jl(t){if(t!==xn)return!1;if(!qe)return bg(t),qe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!_m(t.type,t.memoizedProps)),e&&(e=_n)){if(bm(t))throw JE(),Error(W(418));for(;e;)XE(t,e),e=Ts(e.nextSibling)}if(bg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(W(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){_n=Ts(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}_n=null}}else _n=xn?Ts(t.stateNode.nextSibling):null;return!0}function JE(){for(var t=_n;t;)t=Ts(t.nextSibling)}function wi(){_n=xn=null,qe=!1}function Wh(t){Yn===null?Yn=[t]:Yn.push(t)}var kb=Yr.ReactCurrentBatchConfig;function Ji(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var c=s.refs;o===null?delete c[i]:c[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,t))}return t}function Bl(t,e){throw t=Object.prototype.toString.call(e),Error(W(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Sg(t){var e=t._init;return e(t._payload)}function ZE(t){function e(_,v){if(t){var I=_.deletions;I===null?(_.deletions=[v],_.flags|=16):I.push(v)}}function n(_,v){if(!t)return null;for(;v!==null;)e(_,v),v=v.sibling;return null}function r(_,v){for(_=new Map;v!==null;)v.key!==null?_.set(v.key,v):_.set(v.index,v),v=v.sibling;return _}function s(_,v){return _=Rs(_,v),_.index=0,_.sibling=null,_}function i(_,v,I){return _.index=I,t?(I=_.alternate,I!==null?(I=I.index,I<v?(_.flags|=2,v):I):(_.flags|=2,v)):(_.flags|=1048576,v)}function o(_){return t&&_.alternate===null&&(_.flags|=2),_}function c(_,v,I,D){return v===null||v.tag!==6?(v=Md(I,_.mode,D),v.return=_,v):(v=s(v,I),v.return=_,v)}function u(_,v,I,D){var M=I.type;return M===Xa?h(_,v,I.props.children,D,I.key):v!==null&&(v.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===fs&&Sg(M)===v.type)?(D=s(v,I.props),D.ref=Ji(_,v,I),D.return=_,D):(D=dc(I.type,I.key,I.props,null,_.mode,D),D.ref=Ji(_,v,I),D.return=_,D)}function d(_,v,I,D){return v===null||v.tag!==4||v.stateNode.containerInfo!==I.containerInfo||v.stateNode.implementation!==I.implementation?(v=Ld(I,_.mode,D),v.return=_,v):(v=s(v,I.children||[]),v.return=_,v)}function h(_,v,I,D,M){return v===null||v.tag!==7?(v=_a(I,_.mode,D,M),v.return=_,v):(v=s(v,I),v.return=_,v)}function p(_,v,I){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Md(""+v,_.mode,I),v.return=_,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case kl:return I=dc(v.type,v.key,v.props,null,_.mode,I),I.ref=Ji(_,null,v),I.return=_,I;case Ya:return v=Ld(v,_.mode,I),v.return=_,v;case fs:var D=v._init;return p(_,D(v._payload),I)}if(ro(v)||Gi(v))return v=_a(v,_.mode,I,null),v.return=_,v;Bl(_,v)}return null}function y(_,v,I,D){var M=v!==null?v.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return M!==null?null:c(_,v,""+I,D);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case kl:return I.key===M?u(_,v,I,D):null;case Ya:return I.key===M?d(_,v,I,D):null;case fs:return M=I._init,y(_,v,M(I._payload),D)}if(ro(I)||Gi(I))return M!==null?null:h(_,v,I,D,null);Bl(_,I)}return null}function S(_,v,I,D,M){if(typeof D=="string"&&D!==""||typeof D=="number")return _=_.get(I)||null,c(v,_,""+D,M);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case kl:return _=_.get(D.key===null?I:D.key)||null,u(v,_,D,M);case Ya:return _=_.get(D.key===null?I:D.key)||null,d(v,_,D,M);case fs:var V=D._init;return S(_,v,I,V(D._payload),M)}if(ro(D)||Gi(D))return _=_.get(I)||null,h(v,_,D,M,null);Bl(v,D)}return null}function P(_,v,I,D){for(var M=null,V=null,b=v,g=v=0,x=null;b!==null&&g<I.length;g++){b.index>g?(x=b,b=null):x=b.sibling;var T=y(_,b,I[g],D);if(T===null){b===null&&(b=x);break}t&&b&&T.alternate===null&&e(_,b),v=i(T,v,g),V===null?M=T:V.sibling=T,V=T,b=x}if(g===I.length)return n(_,b),qe&&ma(_,g),M;if(b===null){for(;g<I.length;g++)b=p(_,I[g],D),b!==null&&(v=i(b,v,g),V===null?M=b:V.sibling=b,V=b);return qe&&ma(_,g),M}for(b=r(_,b);g<I.length;g++)x=S(b,_,g,I[g],D),x!==null&&(t&&x.alternate!==null&&b.delete(x.key===null?g:x.key),v=i(x,v,g),V===null?M=x:V.sibling=x,V=x);return t&&b.forEach(function(k){return e(_,k)}),qe&&ma(_,g),M}function w(_,v,I,D){var M=Gi(I);if(typeof M!="function")throw Error(W(150));if(I=M.call(I),I==null)throw Error(W(151));for(var V=M=null,b=v,g=v=0,x=null,T=I.next();b!==null&&!T.done;g++,T=I.next()){b.index>g?(x=b,b=null):x=b.sibling;var k=y(_,b,T.value,D);if(k===null){b===null&&(b=x);break}t&&b&&k.alternate===null&&e(_,b),v=i(k,v,g),V===null?M=k:V.sibling=k,V=k,b=x}if(T.done)return n(_,b),qe&&ma(_,g),M;if(b===null){for(;!T.done;g++,T=I.next())T=p(_,T.value,D),T!==null&&(v=i(T,v,g),V===null?M=T:V.sibling=T,V=T);return qe&&ma(_,g),M}for(b=r(_,b);!T.done;g++,T=I.next())T=S(b,_,g,T.value,D),T!==null&&(t&&T.alternate!==null&&b.delete(T.key===null?g:T.key),v=i(T,v,g),V===null?M=T:V.sibling=T,V=T);return t&&b.forEach(function(R){return e(_,R)}),qe&&ma(_,g),M}function A(_,v,I,D){if(typeof I=="object"&&I!==null&&I.type===Xa&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case kl:e:{for(var M=I.key,V=v;V!==null;){if(V.key===M){if(M=I.type,M===Xa){if(V.tag===7){n(_,V.sibling),v=s(V,I.props.children),v.return=_,_=v;break e}}else if(V.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===fs&&Sg(M)===V.type){n(_,V.sibling),v=s(V,I.props),v.ref=Ji(_,V,I),v.return=_,_=v;break e}n(_,V);break}else e(_,V);V=V.sibling}I.type===Xa?(v=_a(I.props.children,_.mode,D,I.key),v.return=_,_=v):(D=dc(I.type,I.key,I.props,null,_.mode,D),D.ref=Ji(_,v,I),D.return=_,_=D)}return o(_);case Ya:e:{for(V=I.key;v!==null;){if(v.key===V)if(v.tag===4&&v.stateNode.containerInfo===I.containerInfo&&v.stateNode.implementation===I.implementation){n(_,v.sibling),v=s(v,I.children||[]),v.return=_,_=v;break e}else{n(_,v);break}else e(_,v);v=v.sibling}v=Ld(I,_.mode,D),v.return=_,_=v}return o(_);case fs:return V=I._init,A(_,v,V(I._payload),D)}if(ro(I))return P(_,v,I,D);if(Gi(I))return w(_,v,I,D);Bl(_,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,v!==null&&v.tag===6?(n(_,v.sibling),v=s(v,I),v.return=_,_=v):(n(_,v),v=Md(I,_.mode,D),v.return=_,_=v),o(_)):n(_,v)}return A}var xi=ZE(!0),e0=ZE(!1),Oc=Qs(null),Mc=null,ai=null,Gh=null;function Kh(){Gh=ai=Mc=null}function Qh(t){var e=Oc.current;Be(Oc),t._currentValue=e}function Cm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function hi(t,e){Mc=t,Gh=ai=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ln=!0),t.firstContext=null)}function jn(t){var e=t._currentValue;if(Gh!==t)if(t={context:t,memoizedValue:e,next:null},ai===null){if(Mc===null)throw Error(W(308));ai=t,Mc.dependencies={lanes:0,firstContext:t}}else ai=ai.next=t;return e}var ga=null;function Yh(t){ga===null?ga=[t]:ga.push(t)}function t0(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Yh(e)):(n.next=s.next,s.next=n),e.interleaved=n,Hr(t,r)}function Hr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ps=!1;function Xh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function n0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ur(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function As(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Te&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Hr(t,n)}return s=r.interleaved,s===null?(e.next=e,Yh(r)):(e.next=s.next,s.next=e),r.interleaved=e,Hr(t,n)}function ac(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Mh(t,n)}}function Cg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Lc(t,e,n,r){var s=t.updateQueue;ps=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var h=t.alternate;h!==null&&(h=h.updateQueue,c=h.lastBaseUpdate,c!==o&&(c===null?h.firstBaseUpdate=d:c.next=d,h.lastBaseUpdate=u))}if(i!==null){var p=s.baseState;o=0,h=d=u=null,c=i;do{var y=c.lane,S=c.eventTime;if((r&y)===y){h!==null&&(h=h.next={eventTime:S,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var P=t,w=c;switch(y=e,S=n,w.tag){case 1:if(P=w.payload,typeof P=="function"){p=P.call(S,p,y);break e}p=P;break e;case 3:P.flags=P.flags&-65537|128;case 0:if(P=w.payload,y=typeof P=="function"?P.call(S,p,y):P,y==null)break e;p=Ke({},p,y);break e;case 2:ps=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,y=s.effects,y===null?s.effects=[c]:y.push(c))}else S={eventTime:S,lane:y,tag:c.tag,payload:c.payload,callback:c.callback,next:null},h===null?(d=h=S,u=p):h=h.next=S,o|=y;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;y=c,c=y.next,y.next=null,s.lastBaseUpdate=y,s.shared.pending=null}}while(!0);if(h===null&&(u=p),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ca|=o,t.lanes=o,t.memoizedState=p}}function Ig(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(W(191,s));s.call(r)}}}var ll={},yr=Qs(ll),Uo=Qs(ll),jo=Qs(ll);function ya(t){if(t===ll)throw Error(W(174));return t}function Jh(t,e){switch(Le(jo,e),Le(Uo,t),Le(yr,ll),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:im(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=im(e,t)}Be(yr),Le(yr,e)}function Ni(){Be(yr),Be(Uo),Be(jo)}function r0(t){ya(jo.current);var e=ya(yr.current),n=im(e,t.type);e!==n&&(Le(Uo,t),Le(yr,n))}function Zh(t){Uo.current===t&&(Be(yr),Be(Uo))}var We=Qs(0);function Fc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var kd=[];function ef(){for(var t=0;t<kd.length;t++)kd[t]._workInProgressVersionPrimary=null;kd.length=0}var ic=Yr.ReactCurrentDispatcher,Pd=Yr.ReactCurrentBatchConfig,Sa=0,Ge=null,yt=null,Ct=null,Uc=!1,vo=!1,Bo=0,Pb=0;function Ft(){throw Error(W(321))}function tf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!tr(t[n],e[n]))return!1;return!0}function nf(t,e,n,r,s,i){if(Sa=i,Ge=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ic.current=t===null||t.memoizedState===null?Ob:Mb,t=n(r,s),vo){i=0;do{if(vo=!1,Bo=0,25<=i)throw Error(W(301));i+=1,Ct=yt=null,e.updateQueue=null,ic.current=Lb,t=n(r,s)}while(vo)}if(ic.current=jc,e=yt!==null&&yt.next!==null,Sa=0,Ct=yt=Ge=null,Uc=!1,e)throw Error(W(300));return t}function rf(){var t=Bo!==0;return Bo=0,t}function hr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ct===null?Ge.memoizedState=Ct=t:Ct=Ct.next=t,Ct}function Bn(){if(yt===null){var t=Ge.alternate;t=t!==null?t.memoizedState:null}else t=yt.next;var e=Ct===null?Ge.memoizedState:Ct.next;if(e!==null)Ct=e,yt=t;else{if(t===null)throw Error(W(310));yt=t,t={memoizedState:yt.memoizedState,baseState:yt.baseState,baseQueue:yt.baseQueue,queue:yt.queue,next:null},Ct===null?Ge.memoizedState=Ct=t:Ct=Ct.next=t}return Ct}function zo(t,e){return typeof e=="function"?e(t):e}function Rd(t){var e=Bn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=yt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var c=o=null,u=null,d=i;do{var h=d.lane;if((Sa&h)===h)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=p,o=r):u=u.next=p,Ge.lanes|=h,Ca|=h}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=c,tr(r,e.memoizedState)||(ln=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Ge.lanes|=i,Ca|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Dd(t){var e=Bn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);tr(i,e.memoizedState)||(ln=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function s0(){}function a0(t,e){var n=Ge,r=Bn(),s=e(),i=!tr(r.memoizedState,s);if(i&&(r.memoizedState=s,ln=!0),r=r.queue,sf(l0.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Ct!==null&&Ct.memoizedState.tag&1){if(n.flags|=2048,$o(9,o0.bind(null,n,r,s,e),void 0,null),It===null)throw Error(W(349));Sa&30||i0(n,e,s)}return s}function i0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function o0(t,e,n,r){e.value=n,e.getSnapshot=r,c0(e)&&u0(t)}function l0(t,e,n){return n(function(){c0(e)&&u0(t)})}function c0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!tr(t,n)}catch{return!0}}function u0(t){var e=Hr(t,1);e!==null&&er(e,t,1,-1)}function Tg(t){var e=hr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zo,lastRenderedState:t},e.queue=t,t=t.dispatch=Vb.bind(null,Ge,t),[e.memoizedState,t]}function $o(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function d0(){return Bn().memoizedState}function oc(t,e,n,r){var s=hr();Ge.flags|=t,s.memoizedState=$o(1|e,n,void 0,r===void 0?null:r)}function Nu(t,e,n,r){var s=Bn();r=r===void 0?null:r;var i=void 0;if(yt!==null){var o=yt.memoizedState;if(i=o.destroy,r!==null&&tf(r,o.deps)){s.memoizedState=$o(e,n,i,r);return}}Ge.flags|=t,s.memoizedState=$o(1|e,n,i,r)}function Ag(t,e){return oc(8390656,8,t,e)}function sf(t,e){return Nu(2048,8,t,e)}function m0(t,e){return Nu(4,2,t,e)}function h0(t,e){return Nu(4,4,t,e)}function f0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function p0(t,e,n){return n=n!=null?n.concat([t]):null,Nu(4,4,f0.bind(null,e,t),n)}function af(){}function g0(t,e){var n=Bn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&tf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function y0(t,e){var n=Bn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&tf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function v0(t,e,n){return Sa&21?(tr(n,e)||(n=NE(),Ge.lanes|=n,Ca|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ln=!0),t.memoizedState=n)}function Rb(t,e){var n=De;De=n!==0&&4>n?n:4,t(!0);var r=Pd.transition;Pd.transition={};try{t(!1),e()}finally{De=n,Pd.transition=r}}function E0(){return Bn().memoizedState}function Db(t,e,n){var r=Ps(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},_0(t))w0(e,n);else if(n=t0(t,e,n,r),n!==null){var s=Jt();er(n,t,r,s),x0(n,e,r)}}function Vb(t,e,n){var r=Ps(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(_0(t))w0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,c=i(o,n);if(s.hasEagerState=!0,s.eagerState=c,tr(c,o)){var u=e.interleaved;u===null?(s.next=s,Yh(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=t0(t,e,s,r),n!==null&&(s=Jt(),er(n,t,r,s),x0(n,e,r))}}function _0(t){var e=t.alternate;return t===Ge||e!==null&&e===Ge}function w0(t,e){vo=Uc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function x0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Mh(t,n)}}var jc={readContext:jn,useCallback:Ft,useContext:Ft,useEffect:Ft,useImperativeHandle:Ft,useInsertionEffect:Ft,useLayoutEffect:Ft,useMemo:Ft,useReducer:Ft,useRef:Ft,useState:Ft,useDebugValue:Ft,useDeferredValue:Ft,useTransition:Ft,useMutableSource:Ft,useSyncExternalStore:Ft,useId:Ft,unstable_isNewReconciler:!1},Ob={readContext:jn,useCallback:function(t,e){return hr().memoizedState=[t,e===void 0?null:e],t},useContext:jn,useEffect:Ag,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,oc(4194308,4,f0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return oc(4194308,4,t,e)},useInsertionEffect:function(t,e){return oc(4,2,t,e)},useMemo:function(t,e){var n=hr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=hr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Db.bind(null,Ge,t),[r.memoizedState,t]},useRef:function(t){var e=hr();return t={current:t},e.memoizedState=t},useState:Tg,useDebugValue:af,useDeferredValue:function(t){return hr().memoizedState=t},useTransition:function(){var t=Tg(!1),e=t[0];return t=Rb.bind(null,t[1]),hr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ge,s=hr();if(qe){if(n===void 0)throw Error(W(407));n=n()}else{if(n=e(),It===null)throw Error(W(349));Sa&30||i0(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Ag(l0.bind(null,r,i,t),[t]),r.flags|=2048,$o(9,o0.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=hr(),e=It.identifierPrefix;if(qe){var n=Mr,r=Or;n=(r&~(1<<32-Zn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Bo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Pb++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Mb={readContext:jn,useCallback:g0,useContext:jn,useEffect:sf,useImperativeHandle:p0,useInsertionEffect:m0,useLayoutEffect:h0,useMemo:y0,useReducer:Rd,useRef:d0,useState:function(){return Rd(zo)},useDebugValue:af,useDeferredValue:function(t){var e=Bn();return v0(e,yt.memoizedState,t)},useTransition:function(){var t=Rd(zo)[0],e=Bn().memoizedState;return[t,e]},useMutableSource:s0,useSyncExternalStore:a0,useId:E0,unstable_isNewReconciler:!1},Lb={readContext:jn,useCallback:g0,useContext:jn,useEffect:sf,useImperativeHandle:p0,useInsertionEffect:m0,useLayoutEffect:h0,useMemo:y0,useReducer:Dd,useRef:d0,useState:function(){return Dd(zo)},useDebugValue:af,useDeferredValue:function(t){var e=Bn();return yt===null?e.memoizedState=t:v0(e,yt.memoizedState,t)},useTransition:function(){var t=Dd(zo)[0],e=Bn().memoizedState;return[t,e]},useMutableSource:s0,useSyncExternalStore:a0,useId:E0,unstable_isNewReconciler:!1};function Kn(t,e){if(t&&t.defaultProps){e=Ke({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Im(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ke({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var bu={isMounted:function(t){return(t=t._reactInternals)?Oa(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Jt(),s=Ps(t),i=Ur(r,s);i.payload=e,n!=null&&(i.callback=n),e=As(t,i,s),e!==null&&(er(e,t,s,r),ac(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Jt(),s=Ps(t),i=Ur(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=As(t,i,s),e!==null&&(er(e,t,s,r),ac(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Jt(),r=Ps(t),s=Ur(n,r);s.tag=2,e!=null&&(s.callback=e),e=As(t,s,r),e!==null&&(er(e,t,r,n),ac(e,t,r))}};function kg(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Oo(n,r)||!Oo(s,i):!0}function N0(t,e,n){var r=!1,s=Fs,i=e.contextType;return typeof i=="object"&&i!==null?i=jn(i):(s=un(e)?Na:$t.current,r=e.contextTypes,i=(r=r!=null)?_i(t,s):Fs),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=bu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Pg(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&bu.enqueueReplaceState(e,e.state,null)}function Tm(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Xh(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=jn(i):(i=un(e)?Na:$t.current,s.context=_i(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Im(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&bu.enqueueReplaceState(s,s.state,null),Lc(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function bi(t,e){try{var n="",r=e;do n+=dN(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Vd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Am(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Fb=typeof WeakMap=="function"?WeakMap:Map;function b0(t,e,n){n=Ur(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){zc||(zc=!0,Um=r),Am(t,e)},n}function S0(t,e,n){n=Ur(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Am(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Am(t,e),typeof r!="function"&&(ks===null?ks=new Set([this]):ks.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Rg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Fb;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=Jb.bind(null,t,e,n),e.then(t,t))}function Dg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Vg(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ur(-1,1),e.tag=2,As(n,e,1))),n.lanes|=1),t)}var Ub=Yr.ReactCurrentOwner,ln=!1;function Xt(t,e,n,r){e.child=t===null?e0(e,null,n,r):xi(e,t.child,n,r)}function Og(t,e,n,r,s){n=n.render;var i=e.ref;return hi(e,s),r=nf(t,e,n,r,i,s),n=rf(),t!==null&&!ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,qr(t,e,s)):(qe&&n&&Hh(e),e.flags|=1,Xt(t,e,r,s),e.child)}function Mg(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!ff(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,C0(t,e,i,r,s)):(t=dc(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Oo,n(o,r)&&t.ref===e.ref)return qr(t,e,s)}return e.flags|=1,t=Rs(i,r),t.ref=e.ref,t.return=e,e.child=t}function C0(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Oo(i,r)&&t.ref===e.ref)if(ln=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(ln=!0);else return e.lanes=t.lanes,qr(t,e,s)}return km(t,e,n,r,s)}function I0(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Le(oi,vn),vn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Le(oi,vn),vn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Le(oi,vn),vn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Le(oi,vn),vn|=r;return Xt(t,e,s,n),e.child}function T0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function km(t,e,n,r,s){var i=un(n)?Na:$t.current;return i=_i(e,i),hi(e,s),n=nf(t,e,n,r,i,s),r=rf(),t!==null&&!ln?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,qr(t,e,s)):(qe&&r&&Hh(e),e.flags|=1,Xt(t,e,n,s),e.child)}function Lg(t,e,n,r,s){if(un(n)){var i=!0;Rc(e)}else i=!1;if(hi(e,s),e.stateNode===null)lc(t,e),N0(e,n,r),Tm(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=jn(d):(d=un(n)?Na:$t.current,d=_i(e,d));var h=n.getDerivedStateFromProps,p=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||u!==d)&&Pg(e,o,r,d),ps=!1;var y=e.memoizedState;o.state=y,Lc(e,r,o,s),u=e.memoizedState,c!==r||y!==u||cn.current||ps?(typeof h=="function"&&(Im(e,n,h,r),u=e.memoizedState),(c=ps||kg(e,n,c,r,y,u,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,n0(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:Kn(e.type,c),o.props=d,p=e.pendingProps,y=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=jn(u):(u=un(n)?Na:$t.current,u=_i(e,u));var S=n.getDerivedStateFromProps;(h=typeof S=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==p||y!==u)&&Pg(e,o,r,u),ps=!1,y=e.memoizedState,o.state=y,Lc(e,r,o,s);var P=e.memoizedState;c!==p||y!==P||cn.current||ps?(typeof S=="function"&&(Im(e,n,S,r),P=e.memoizedState),(d=ps||kg(e,n,d,r,y,P,u)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,P,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,P,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=P),o.props=r,o.state=P,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),r=!1)}return Pm(t,e,n,r,i,s)}function Pm(t,e,n,r,s,i){T0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&xg(e,n,!1),qr(t,e,i);r=e.stateNode,Ub.current=e;var c=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=xi(e,t.child,null,i),e.child=xi(e,null,c,i)):Xt(t,e,c,i),e.memoizedState=r.state,s&&xg(e,n,!0),e.child}function A0(t){var e=t.stateNode;e.pendingContext?wg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&wg(t,e.context,!1),Jh(t,e.containerInfo)}function Fg(t,e,n,r,s){return wi(),Wh(s),e.flags|=256,Xt(t,e,n,r),e.child}var Rm={dehydrated:null,treeContext:null,retryLane:0};function Dm(t){return{baseLanes:t,cachePool:null,transitions:null}}function k0(t,e,n){var r=e.pendingProps,s=We.current,i=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Le(We,s&1),t===null)return Sm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Iu(o,r,0,null),t=_a(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Dm(n),e.memoizedState=Rm,t):of(e,o));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return jb(t,e,o,r,c,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Rs(s,u),r.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Rs(c,i):(i=_a(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Dm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Rm,r}return i=t.child,t=i.sibling,r=Rs(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function of(t,e){return e=Iu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function zl(t,e,n,r){return r!==null&&Wh(r),xi(e,t.child,null,n),t=of(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function jb(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Vd(Error(W(422))),zl(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Iu({mode:"visible",children:r.children},s,0,null),i=_a(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&xi(e,t.child,null,o),e.child.memoizedState=Dm(o),e.memoizedState=Rm,i);if(!(e.mode&1))return zl(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(W(419)),r=Vd(i,r,void 0),zl(t,e,o,r)}if(c=(o&t.childLanes)!==0,ln||c){if(r=It,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Hr(t,s),er(r,t,s,-1))}return hf(),r=Vd(Error(W(421))),zl(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Zb.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,_n=Ts(s.nextSibling),xn=e,qe=!0,Yn=null,t!==null&&(On[Mn++]=Or,On[Mn++]=Mr,On[Mn++]=ba,Or=t.id,Mr=t.overflow,ba=e),e=of(e,r.children),e.flags|=4096,e)}function Ug(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Cm(t.return,e,n)}function Od(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function P0(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Xt(t,e,r.children,n),r=We.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ug(t,n,e);else if(t.tag===19)Ug(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Le(We,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Fc(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Od(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Fc(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Od(e,!0,n,null,i);break;case"together":Od(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function lc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function qr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ca|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(W(153));if(e.child!==null){for(t=e.child,n=Rs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Rs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Bb(t,e,n){switch(e.tag){case 3:A0(e),wi();break;case 5:r0(e);break;case 1:un(e.type)&&Rc(e);break;case 4:Jh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Le(Oc,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Le(We,We.current&1),e.flags|=128,null):n&e.child.childLanes?k0(t,e,n):(Le(We,We.current&1),t=qr(t,e,n),t!==null?t.sibling:null);Le(We,We.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return P0(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Le(We,We.current),r)break;return null;case 22:case 23:return e.lanes=0,I0(t,e,n)}return qr(t,e,n)}var R0,Vm,D0,V0;R0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Vm=function(){};D0=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ya(yr.current);var i=null;switch(n){case"input":s=nm(t,s),r=nm(t,r),i=[];break;case"select":s=Ke({},s,{value:void 0}),r=Ke({},r,{value:void 0}),i=[];break;case"textarea":s=am(t,s),r=am(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=kc)}om(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(To.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(c=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(o in c)!c.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&c[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(To.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Ue("scroll",t),i||c===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};V0=function(t,e,n,r){n!==r&&(e.flags|=4)};function Zi(t,e){if(!qe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ut(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function zb(t,e,n){var r=e.pendingProps;switch(qh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ut(e),null;case 1:return un(e.type)&&Pc(),Ut(e),null;case 3:return r=e.stateNode,Ni(),Be(cn),Be($t),ef(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(jl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Yn!==null&&(zm(Yn),Yn=null))),Vm(t,e),Ut(e),null;case 5:Zh(e);var s=ya(jo.current);if(n=e.type,t!==null&&e.stateNode!=null)D0(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(W(166));return Ut(e),null}if(t=ya(yr.current),jl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[pr]=e,r[Fo]=i,t=(e.mode&1)!==0,n){case"dialog":Ue("cancel",r),Ue("close",r);break;case"iframe":case"object":case"embed":Ue("load",r);break;case"video":case"audio":for(s=0;s<ao.length;s++)Ue(ao[s],r);break;case"source":Ue("error",r);break;case"img":case"image":case"link":Ue("error",r),Ue("load",r);break;case"details":Ue("toggle",r);break;case"input":Kp(r,i),Ue("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ue("invalid",r);break;case"textarea":Yp(r,i),Ue("invalid",r)}om(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var c=i[o];o==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&Ul(r.textContent,c,t),s=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&Ul(r.textContent,c,t),s=["children",""+c]):To.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&Ue("scroll",r)}switch(n){case"input":Pl(r),Qp(r,i,!0);break;case"textarea":Pl(r),Xp(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=kc)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=lE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[pr]=e,t[Fo]=r,R0(t,e,!1,!1),e.stateNode=t;e:{switch(o=lm(n,r),n){case"dialog":Ue("cancel",t),Ue("close",t),s=r;break;case"iframe":case"object":case"embed":Ue("load",t),s=r;break;case"video":case"audio":for(s=0;s<ao.length;s++)Ue(ao[s],t);s=r;break;case"source":Ue("error",t),s=r;break;case"img":case"image":case"link":Ue("error",t),Ue("load",t),s=r;break;case"details":Ue("toggle",t),s=r;break;case"input":Kp(t,r),s=nm(t,r),Ue("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ke({},r,{value:void 0}),Ue("invalid",t);break;case"textarea":Yp(t,r),s=am(t,r),Ue("invalid",t);break;default:s=r}om(n,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?dE(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&cE(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Ao(t,u):typeof u=="number"&&Ao(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(To.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ue("scroll",t):u!=null&&kh(t,i,u,o))}switch(n){case"input":Pl(t),Qp(t,r,!1);break;case"textarea":Pl(t),Xp(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ls(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ci(t,!!r.multiple,i,!1):r.defaultValue!=null&&ci(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=kc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ut(e),null;case 6:if(t&&e.stateNode!=null)V0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(W(166));if(n=ya(jo.current),ya(yr.current),jl(e)){if(r=e.stateNode,n=e.memoizedProps,r[pr]=e,(i=r.nodeValue!==n)&&(t=xn,t!==null))switch(t.tag){case 3:Ul(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ul(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[pr]=e,e.stateNode=r}return Ut(e),null;case 13:if(Be(We),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(qe&&_n!==null&&e.mode&1&&!(e.flags&128))JE(),wi(),e.flags|=98560,i=!1;else if(i=jl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(W(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[pr]=e}else wi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ut(e),i=!1}else Yn!==null&&(zm(Yn),Yn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||We.current&1?vt===0&&(vt=3):hf())),e.updateQueue!==null&&(e.flags|=4),Ut(e),null);case 4:return Ni(),Vm(t,e),t===null&&Mo(e.stateNode.containerInfo),Ut(e),null;case 10:return Qh(e.type._context),Ut(e),null;case 17:return un(e.type)&&Pc(),Ut(e),null;case 19:if(Be(We),i=e.memoizedState,i===null)return Ut(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Zi(i,!1);else{if(vt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Fc(t),o!==null){for(e.flags|=128,Zi(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Le(We,We.current&1|2),e.child}t=t.sibling}i.tail!==null&&rt()>Si&&(e.flags|=128,r=!0,Zi(i,!1),e.lanes=4194304)}else{if(!r)if(t=Fc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Zi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!qe)return Ut(e),null}else 2*rt()-i.renderingStartTime>Si&&n!==1073741824&&(e.flags|=128,r=!0,Zi(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=rt(),e.sibling=null,n=We.current,Le(We,r?n&1|2:n&1),e):(Ut(e),null);case 22:case 23:return mf(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?vn&1073741824&&(Ut(e),e.subtreeFlags&6&&(e.flags|=8192)):Ut(e),null;case 24:return null;case 25:return null}throw Error(W(156,e.tag))}function $b(t,e){switch(qh(e),e.tag){case 1:return un(e.type)&&Pc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ni(),Be(cn),Be($t),ef(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Zh(e),null;case 13:if(Be(We),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(W(340));wi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Be(We),null;case 4:return Ni(),null;case 10:return Qh(e.type._context),null;case 22:case 23:return mf(),null;case 24:return null;default:return null}}var $l=!1,Bt=!1,Hb=typeof WeakSet=="function"?WeakSet:Set,ne=null;function ii(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Xe(t,e,r)}else n.current=null}function Om(t,e,n){try{n()}catch(r){Xe(t,e,r)}}var jg=!1;function qb(t,e){if(vm=Ic,t=UE(),$h(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,c=-1,u=-1,d=0,h=0,p=t,y=null;t:for(;;){for(var S;p!==n||s!==0&&p.nodeType!==3||(c=o+s),p!==i||r!==0&&p.nodeType!==3||(u=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(S=p.firstChild)!==null;)y=p,p=S;for(;;){if(p===t)break t;if(y===n&&++d===s&&(c=o),y===i&&++h===r&&(u=o),(S=p.nextSibling)!==null)break;p=y,y=p.parentNode}p=S}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Em={focusedElem:t,selectionRange:n},Ic=!1,ne=e;ne!==null;)if(e=ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ne=t;else for(;ne!==null;){e=ne;try{var P=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(P!==null){var w=P.memoizedProps,A=P.memoizedState,_=e.stateNode,v=_.getSnapshotBeforeUpdate(e.elementType===e.type?w:Kn(e.type,w),A);_.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(D){Xe(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,ne=t;break}ne=e.return}return P=jg,jg=!1,P}function Eo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Om(e,n,i)}s=s.next}while(s!==r)}}function Su(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Mm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function O0(t){var e=t.alternate;e!==null&&(t.alternate=null,O0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[pr],delete e[Fo],delete e[xm],delete e[Ib],delete e[Tb])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function M0(t){return t.tag===5||t.tag===3||t.tag===4}function Bg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||M0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Lm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=kc));else if(r!==4&&(t=t.child,t!==null))for(Lm(t,e,n),t=t.sibling;t!==null;)Lm(t,e,n),t=t.sibling}function Fm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Fm(t,e,n),t=t.sibling;t!==null;)Fm(t,e,n),t=t.sibling}var kt=null,Qn=!1;function ms(t,e,n){for(n=n.child;n!==null;)L0(t,e,n),n=n.sibling}function L0(t,e,n){if(gr&&typeof gr.onCommitFiberUnmount=="function")try{gr.onCommitFiberUnmount(yu,n)}catch{}switch(n.tag){case 5:Bt||ii(n,e);case 6:var r=kt,s=Qn;kt=null,ms(t,e,n),kt=r,Qn=s,kt!==null&&(Qn?(t=kt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):kt.removeChild(n.stateNode));break;case 18:kt!==null&&(Qn?(t=kt,n=n.stateNode,t.nodeType===8?Td(t.parentNode,n):t.nodeType===1&&Td(t,n),Do(t)):Td(kt,n.stateNode));break;case 4:r=kt,s=Qn,kt=n.stateNode.containerInfo,Qn=!0,ms(t,e,n),kt=r,Qn=s;break;case 0:case 11:case 14:case 15:if(!Bt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Om(n,e,o),s=s.next}while(s!==r)}ms(t,e,n);break;case 1:if(!Bt&&(ii(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){Xe(n,e,c)}ms(t,e,n);break;case 21:ms(t,e,n);break;case 22:n.mode&1?(Bt=(r=Bt)||n.memoizedState!==null,ms(t,e,n),Bt=r):ms(t,e,n);break;default:ms(t,e,n)}}function zg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Hb),e.forEach(function(r){var s=e1.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Gn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:kt=c.stateNode,Qn=!1;break e;case 3:kt=c.stateNode.containerInfo,Qn=!0;break e;case 4:kt=c.stateNode.containerInfo,Qn=!0;break e}c=c.return}if(kt===null)throw Error(W(160));L0(i,o,s),kt=null,Qn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Xe(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)F0(e,t),e=e.sibling}function F0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Gn(e,t),mr(t),r&4){try{Eo(3,t,t.return),Su(3,t)}catch(w){Xe(t,t.return,w)}try{Eo(5,t,t.return)}catch(w){Xe(t,t.return,w)}}break;case 1:Gn(e,t),mr(t),r&512&&n!==null&&ii(n,n.return);break;case 5:if(Gn(e,t),mr(t),r&512&&n!==null&&ii(n,n.return),t.flags&32){var s=t.stateNode;try{Ao(s,"")}catch(w){Xe(t,t.return,w)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&iE(s,i),lm(c,o);var d=lm(c,i);for(o=0;o<u.length;o+=2){var h=u[o],p=u[o+1];h==="style"?dE(s,p):h==="dangerouslySetInnerHTML"?cE(s,p):h==="children"?Ao(s,p):kh(s,h,p,d)}switch(c){case"input":rm(s,i);break;case"textarea":oE(s,i);break;case"select":var y=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var S=i.value;S!=null?ci(s,!!i.multiple,S,!1):y!==!!i.multiple&&(i.defaultValue!=null?ci(s,!!i.multiple,i.defaultValue,!0):ci(s,!!i.multiple,i.multiple?[]:"",!1))}s[Fo]=i}catch(w){Xe(t,t.return,w)}}break;case 6:if(Gn(e,t),mr(t),r&4){if(t.stateNode===null)throw Error(W(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(w){Xe(t,t.return,w)}}break;case 3:if(Gn(e,t),mr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Do(e.containerInfo)}catch(w){Xe(t,t.return,w)}break;case 4:Gn(e,t),mr(t);break;case 13:Gn(e,t),mr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(uf=rt())),r&4&&zg(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Bt=(d=Bt)||h,Gn(e,t),Bt=d):Gn(e,t),mr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(ne=t,h=t.child;h!==null;){for(p=ne=h;ne!==null;){switch(y=ne,S=y.child,y.tag){case 0:case 11:case 14:case 15:Eo(4,y,y.return);break;case 1:ii(y,y.return);var P=y.stateNode;if(typeof P.componentWillUnmount=="function"){r=y,n=y.return;try{e=r,P.props=e.memoizedProps,P.state=e.memoizedState,P.componentWillUnmount()}catch(w){Xe(r,n,w)}}break;case 5:ii(y,y.return);break;case 22:if(y.memoizedState!==null){Hg(p);continue}}S!==null?(S.return=y,ne=S):Hg(p)}h=h.sibling}e:for(h=null,p=t;;){if(p.tag===5){if(h===null){h=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=p.stateNode,u=p.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=uE("display",o))}catch(w){Xe(t,t.return,w)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(w){Xe(t,t.return,w)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Gn(e,t),mr(t),r&4&&zg(t);break;case 21:break;default:Gn(e,t),mr(t)}}function mr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(M0(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Ao(s,""),r.flags&=-33);var i=Bg(t);Fm(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,c=Bg(t);Lm(t,c,o);break;default:throw Error(W(161))}}catch(u){Xe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Wb(t,e,n){ne=t,U0(t)}function U0(t,e,n){for(var r=(t.mode&1)!==0;ne!==null;){var s=ne,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||$l;if(!o){var c=s.alternate,u=c!==null&&c.memoizedState!==null||Bt;c=$l;var d=Bt;if($l=o,(Bt=u)&&!d)for(ne=s;ne!==null;)o=ne,u=o.child,o.tag===22&&o.memoizedState!==null?qg(s):u!==null?(u.return=o,ne=u):qg(s);for(;i!==null;)ne=i,U0(i),i=i.sibling;ne=s,$l=c,Bt=d}$g(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ne=i):$g(t)}}function $g(t){for(;ne!==null;){var e=ne;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Bt||Su(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Bt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Kn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Ig(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Ig(e,o,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&Do(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}Bt||e.flags&512&&Mm(e)}catch(y){Xe(e,e.return,y)}}if(e===t){ne=null;break}if(n=e.sibling,n!==null){n.return=e.return,ne=n;break}ne=e.return}}function Hg(t){for(;ne!==null;){var e=ne;if(e===t){ne=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ne=n;break}ne=e.return}}function qg(t){for(;ne!==null;){var e=ne;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Su(4,e)}catch(u){Xe(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Xe(e,s,u)}}var i=e.return;try{Mm(e)}catch(u){Xe(e,i,u)}break;case 5:var o=e.return;try{Mm(e)}catch(u){Xe(e,o,u)}}}catch(u){Xe(e,e.return,u)}if(e===t){ne=null;break}var c=e.sibling;if(c!==null){c.return=e.return,ne=c;break}ne=e.return}}var Gb=Math.ceil,Bc=Yr.ReactCurrentDispatcher,lf=Yr.ReactCurrentOwner,Un=Yr.ReactCurrentBatchConfig,Te=0,It=null,ut=null,Dt=0,vn=0,oi=Qs(0),vt=0,Ho=null,Ca=0,Cu=0,cf=0,_o=null,an=null,uf=0,Si=1/0,Dr=null,zc=!1,Um=null,ks=null,Hl=!1,Ns=null,$c=0,wo=0,jm=null,cc=-1,uc=0;function Jt(){return Te&6?rt():cc!==-1?cc:cc=rt()}function Ps(t){return t.mode&1?Te&2&&Dt!==0?Dt&-Dt:kb.transition!==null?(uc===0&&(uc=NE()),uc):(t=De,t!==0||(t=window.event,t=t===void 0?16:kE(t.type)),t):1}function er(t,e,n,r){if(50<wo)throw wo=0,jm=null,Error(W(185));al(t,n,r),(!(Te&2)||t!==It)&&(t===It&&(!(Te&2)&&(Cu|=n),vt===4&&ys(t,Dt)),dn(t,r),n===1&&Te===0&&!(e.mode&1)&&(Si=rt()+500,xu&&Ys()))}function dn(t,e){var n=t.callbackNode;kN(t,e);var r=Cc(t,t===It?Dt:0);if(r===0)n!==null&&eg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&eg(n),e===1)t.tag===0?Ab(Wg.bind(null,t)):QE(Wg.bind(null,t)),Sb(function(){!(Te&6)&&Ys()}),n=null;else{switch(bE(r)){case 1:n=Oh;break;case 4:n=wE;break;case 16:n=Sc;break;case 536870912:n=xE;break;default:n=Sc}n=G0(n,j0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function j0(t,e){if(cc=-1,uc=0,Te&6)throw Error(W(327));var n=t.callbackNode;if(fi()&&t.callbackNode!==n)return null;var r=Cc(t,t===It?Dt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Hc(t,r);else{e=r;var s=Te;Te|=2;var i=z0();(It!==t||Dt!==e)&&(Dr=null,Si=rt()+500,Ea(t,e));do try{Yb();break}catch(c){B0(t,c)}while(!0);Kh(),Bc.current=i,Te=s,ut!==null?e=0:(It=null,Dt=0,e=vt)}if(e!==0){if(e===2&&(s=hm(t),s!==0&&(r=s,e=Bm(t,s))),e===1)throw n=Ho,Ea(t,0),ys(t,r),dn(t,rt()),n;if(e===6)ys(t,r);else{if(s=t.current.alternate,!(r&30)&&!Kb(s)&&(e=Hc(t,r),e===2&&(i=hm(t),i!==0&&(r=i,e=Bm(t,i))),e===1))throw n=Ho,Ea(t,0),ys(t,r),dn(t,rt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(W(345));case 2:ha(t,an,Dr);break;case 3:if(ys(t,r),(r&130023424)===r&&(e=uf+500-rt(),10<e)){if(Cc(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Jt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=wm(ha.bind(null,t,an,Dr),e);break}ha(t,an,Dr);break;case 4:if(ys(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Zn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=rt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Gb(r/1960))-r,10<r){t.timeoutHandle=wm(ha.bind(null,t,an,Dr),r);break}ha(t,an,Dr);break;case 5:ha(t,an,Dr);break;default:throw Error(W(329))}}}return dn(t,rt()),t.callbackNode===n?j0.bind(null,t):null}function Bm(t,e){var n=_o;return t.current.memoizedState.isDehydrated&&(Ea(t,e).flags|=256),t=Hc(t,e),t!==2&&(e=an,an=n,e!==null&&zm(e)),t}function zm(t){an===null?an=t:an.push.apply(an,t)}function Kb(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!tr(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ys(t,e){for(e&=~cf,e&=~Cu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Zn(e),r=1<<n;t[n]=-1,e&=~r}}function Wg(t){if(Te&6)throw Error(W(327));fi();var e=Cc(t,0);if(!(e&1))return dn(t,rt()),null;var n=Hc(t,e);if(t.tag!==0&&n===2){var r=hm(t);r!==0&&(e=r,n=Bm(t,r))}if(n===1)throw n=Ho,Ea(t,0),ys(t,e),dn(t,rt()),n;if(n===6)throw Error(W(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ha(t,an,Dr),dn(t,rt()),null}function df(t,e){var n=Te;Te|=1;try{return t(e)}finally{Te=n,Te===0&&(Si=rt()+500,xu&&Ys())}}function Ia(t){Ns!==null&&Ns.tag===0&&!(Te&6)&&fi();var e=Te;Te|=1;var n=Un.transition,r=De;try{if(Un.transition=null,De=1,t)return t()}finally{De=r,Un.transition=n,Te=e,!(Te&6)&&Ys()}}function mf(){vn=oi.current,Be(oi)}function Ea(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,bb(n)),ut!==null)for(n=ut.return;n!==null;){var r=n;switch(qh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Pc();break;case 3:Ni(),Be(cn),Be($t),ef();break;case 5:Zh(r);break;case 4:Ni();break;case 13:Be(We);break;case 19:Be(We);break;case 10:Qh(r.type._context);break;case 22:case 23:mf()}n=n.return}if(It=t,ut=t=Rs(t.current,null),Dt=vn=e,vt=0,Ho=null,cf=Cu=Ca=0,an=_o=null,ga!==null){for(e=0;e<ga.length;e++)if(n=ga[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}ga=null}return t}function B0(t,e){do{var n=ut;try{if(Kh(),ic.current=jc,Uc){for(var r=Ge.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Uc=!1}if(Sa=0,Ct=yt=Ge=null,vo=!1,Bo=0,lf.current=null,n===null||n.return===null){vt=1,Ho=e,ut=null;break}e:{var i=t,o=n.return,c=n,u=e;if(e=Dt,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,h=c,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var y=h.alternate;y?(h.updateQueue=y.updateQueue,h.memoizedState=y.memoizedState,h.lanes=y.lanes):(h.updateQueue=null,h.memoizedState=null)}var S=Dg(o);if(S!==null){S.flags&=-257,Vg(S,o,c,i,e),S.mode&1&&Rg(i,d,e),e=S,u=d;var P=e.updateQueue;if(P===null){var w=new Set;w.add(u),e.updateQueue=w}else P.add(u);break e}else{if(!(e&1)){Rg(i,d,e),hf();break e}u=Error(W(426))}}else if(qe&&c.mode&1){var A=Dg(o);if(A!==null){!(A.flags&65536)&&(A.flags|=256),Vg(A,o,c,i,e),Wh(bi(u,c));break e}}i=u=bi(u,c),vt!==4&&(vt=2),_o===null?_o=[i]:_o.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var _=b0(i,u,e);Cg(i,_);break e;case 1:c=u;var v=i.type,I=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(ks===null||!ks.has(I)))){i.flags|=65536,e&=-e,i.lanes|=e;var D=S0(i,c,e);Cg(i,D);break e}}i=i.return}while(i!==null)}H0(n)}catch(M){e=M,ut===n&&n!==null&&(ut=n=n.return);continue}break}while(!0)}function z0(){var t=Bc.current;return Bc.current=jc,t===null?jc:t}function hf(){(vt===0||vt===3||vt===2)&&(vt=4),It===null||!(Ca&268435455)&&!(Cu&268435455)||ys(It,Dt)}function Hc(t,e){var n=Te;Te|=2;var r=z0();(It!==t||Dt!==e)&&(Dr=null,Ea(t,e));do try{Qb();break}catch(s){B0(t,s)}while(!0);if(Kh(),Te=n,Bc.current=r,ut!==null)throw Error(W(261));return It=null,Dt=0,vt}function Qb(){for(;ut!==null;)$0(ut)}function Yb(){for(;ut!==null&&!wN();)$0(ut)}function $0(t){var e=W0(t.alternate,t,vn);t.memoizedProps=t.pendingProps,e===null?H0(t):ut=e,lf.current=null}function H0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=$b(n,e),n!==null){n.flags&=32767,ut=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{vt=6,ut=null;return}}else if(n=zb(n,e,vn),n!==null){ut=n;return}if(e=e.sibling,e!==null){ut=e;return}ut=e=t}while(e!==null);vt===0&&(vt=5)}function ha(t,e,n){var r=De,s=Un.transition;try{Un.transition=null,De=1,Xb(t,e,n,r)}finally{Un.transition=s,De=r}return null}function Xb(t,e,n,r){do fi();while(Ns!==null);if(Te&6)throw Error(W(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(W(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(PN(t,i),t===It&&(ut=It=null,Dt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Hl||(Hl=!0,G0(Sc,function(){return fi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Un.transition,Un.transition=null;var o=De;De=1;var c=Te;Te|=4,lf.current=null,qb(t,n),F0(n,t),yb(Em),Ic=!!vm,Em=vm=null,t.current=n,Wb(n),xN(),Te=c,De=o,Un.transition=i}else t.current=n;if(Hl&&(Hl=!1,Ns=t,$c=s),i=t.pendingLanes,i===0&&(ks=null),SN(n.stateNode),dn(t,rt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(zc)throw zc=!1,t=Um,Um=null,t;return $c&1&&t.tag!==0&&fi(),i=t.pendingLanes,i&1?t===jm?wo++:(wo=0,jm=t):wo=0,Ys(),null}function fi(){if(Ns!==null){var t=bE($c),e=Un.transition,n=De;try{if(Un.transition=null,De=16>t?16:t,Ns===null)var r=!1;else{if(t=Ns,Ns=null,$c=0,Te&6)throw Error(W(331));var s=Te;for(Te|=4,ne=t.current;ne!==null;){var i=ne,o=i.child;if(ne.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(ne=d;ne!==null;){var h=ne;switch(h.tag){case 0:case 11:case 15:Eo(8,h,i)}var p=h.child;if(p!==null)p.return=h,ne=p;else for(;ne!==null;){h=ne;var y=h.sibling,S=h.return;if(O0(h),h===d){ne=null;break}if(y!==null){y.return=S,ne=y;break}ne=S}}}var P=i.alternate;if(P!==null){var w=P.child;if(w!==null){P.child=null;do{var A=w.sibling;w.sibling=null,w=A}while(w!==null)}}ne=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ne=o;else e:for(;ne!==null;){if(i=ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Eo(9,i,i.return)}var _=i.sibling;if(_!==null){_.return=i.return,ne=_;break e}ne=i.return}}var v=t.current;for(ne=v;ne!==null;){o=ne;var I=o.child;if(o.subtreeFlags&2064&&I!==null)I.return=o,ne=I;else e:for(o=v;ne!==null;){if(c=ne,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:Su(9,c)}}catch(M){Xe(c,c.return,M)}if(c===o){ne=null;break e}var D=c.sibling;if(D!==null){D.return=c.return,ne=D;break e}ne=c.return}}if(Te=s,Ys(),gr&&typeof gr.onPostCommitFiberRoot=="function")try{gr.onPostCommitFiberRoot(yu,t)}catch{}r=!0}return r}finally{De=n,Un.transition=e}}return!1}function Gg(t,e,n){e=bi(n,e),e=b0(t,e,1),t=As(t,e,1),e=Jt(),t!==null&&(al(t,1,e),dn(t,e))}function Xe(t,e,n){if(t.tag===3)Gg(t,t,n);else for(;e!==null;){if(e.tag===3){Gg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ks===null||!ks.has(r))){t=bi(n,t),t=S0(e,t,1),e=As(e,t,1),t=Jt(),e!==null&&(al(e,1,t),dn(e,t));break}}e=e.return}}function Jb(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Jt(),t.pingedLanes|=t.suspendedLanes&n,It===t&&(Dt&n)===n&&(vt===4||vt===3&&(Dt&130023424)===Dt&&500>rt()-uf?Ea(t,0):cf|=n),dn(t,e)}function q0(t,e){e===0&&(t.mode&1?(e=Vl,Vl<<=1,!(Vl&130023424)&&(Vl=4194304)):e=1);var n=Jt();t=Hr(t,e),t!==null&&(al(t,e,n),dn(t,n))}function Zb(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),q0(t,n)}function e1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(e),q0(t,n)}var W0;W0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||cn.current)ln=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ln=!1,Bb(t,e,n);ln=!!(t.flags&131072)}else ln=!1,qe&&e.flags&1048576&&YE(e,Vc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;lc(t,e),t=e.pendingProps;var s=_i(e,$t.current);hi(e,n),s=nf(null,e,r,t,s,n);var i=rf();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,un(r)?(i=!0,Rc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Xh(e),s.updater=bu,e.stateNode=s,s._reactInternals=e,Tm(e,r,t,n),e=Pm(null,e,r,!0,i,n)):(e.tag=0,qe&&i&&Hh(e),Xt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(lc(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=n1(r),t=Kn(r,t),s){case 0:e=km(null,e,r,t,n);break e;case 1:e=Lg(null,e,r,t,n);break e;case 11:e=Og(null,e,r,t,n);break e;case 14:e=Mg(null,e,r,Kn(r.type,t),n);break e}throw Error(W(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Kn(r,s),km(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Kn(r,s),Lg(t,e,r,s,n);case 3:e:{if(A0(e),t===null)throw Error(W(387));r=e.pendingProps,i=e.memoizedState,s=i.element,n0(t,e),Lc(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=bi(Error(W(423)),e),e=Fg(t,e,r,n,s);break e}else if(r!==s){s=bi(Error(W(424)),e),e=Fg(t,e,r,n,s);break e}else for(_n=Ts(e.stateNode.containerInfo.firstChild),xn=e,qe=!0,Yn=null,n=e0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(wi(),r===s){e=qr(t,e,n);break e}Xt(t,e,r,n)}e=e.child}return e;case 5:return r0(e),t===null&&Sm(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,_m(r,s)?o=null:i!==null&&_m(r,i)&&(e.flags|=32),T0(t,e),Xt(t,e,o,n),e.child;case 6:return t===null&&Sm(e),null;case 13:return k0(t,e,n);case 4:return Jh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=xi(e,null,r,n):Xt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Kn(r,s),Og(t,e,r,s,n);case 7:return Xt(t,e,e.pendingProps,n),e.child;case 8:return Xt(t,e,e.pendingProps.children,n),e.child;case 12:return Xt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Le(Oc,r._currentValue),r._currentValue=o,i!==null)if(tr(i.value,o)){if(i.children===s.children&&!cn.current){e=qr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){o=i.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Ur(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?u.next=u:(u.next=h.next,h.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Cm(i.return,n,e),c.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(W(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),Cm(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Xt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,hi(e,n),s=jn(s),r=r(s),e.flags|=1,Xt(t,e,r,n),e.child;case 14:return r=e.type,s=Kn(r,e.pendingProps),s=Kn(r.type,s),Mg(t,e,r,s,n);case 15:return C0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Kn(r,s),lc(t,e),e.tag=1,un(r)?(t=!0,Rc(e)):t=!1,hi(e,n),N0(e,r,s),Tm(e,r,s,n),Pm(null,e,r,!0,t,n);case 19:return P0(t,e,n);case 22:return I0(t,e,n)}throw Error(W(156,e.tag))};function G0(t,e){return _E(t,e)}function t1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fn(t,e,n,r){return new t1(t,e,n,r)}function ff(t){return t=t.prototype,!(!t||!t.isReactComponent)}function n1(t){if(typeof t=="function")return ff(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Rh)return 11;if(t===Dh)return 14}return 2}function Rs(t,e){var n=t.alternate;return n===null?(n=Fn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function dc(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")ff(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Xa:return _a(n.children,s,i,e);case Ph:o=8,s|=8;break;case Jd:return t=Fn(12,n,e,s|2),t.elementType=Jd,t.lanes=i,t;case Zd:return t=Fn(13,n,e,s),t.elementType=Zd,t.lanes=i,t;case em:return t=Fn(19,n,e,s),t.elementType=em,t.lanes=i,t;case rE:return Iu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case tE:o=10;break e;case nE:o=9;break e;case Rh:o=11;break e;case Dh:o=14;break e;case fs:o=16,r=null;break e}throw Error(W(130,t==null?t:typeof t,""))}return e=Fn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function _a(t,e,n,r){return t=Fn(7,t,r,e),t.lanes=n,t}function Iu(t,e,n,r){return t=Fn(22,t,r,e),t.elementType=rE,t.lanes=n,t.stateNode={isHidden:!1},t}function Md(t,e,n){return t=Fn(6,t,null,e),t.lanes=n,t}function Ld(t,e,n){return e=Fn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function r1(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yd(0),this.expirationTimes=yd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yd(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function pf(t,e,n,r,s,i,o,c,u){return t=new r1(t,e,n,c,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Fn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xh(i),t}function s1(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ya,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function K0(t){if(!t)return Fs;t=t._reactInternals;e:{if(Oa(t)!==t||t.tag!==1)throw Error(W(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(un(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(W(171))}if(t.tag===1){var n=t.type;if(un(n))return KE(t,n,e)}return e}function Q0(t,e,n,r,s,i,o,c,u){return t=pf(n,r,!0,t,s,i,o,c,u),t.context=K0(null),n=t.current,r=Jt(),s=Ps(n),i=Ur(r,s),i.callback=e??null,As(n,i,s),t.current.lanes=s,al(t,s,r),dn(t,r),t}function Tu(t,e,n,r){var s=e.current,i=Jt(),o=Ps(s);return n=K0(n),e.context===null?e.context=n:e.pendingContext=n,e=Ur(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=As(s,e,o),t!==null&&(er(t,s,o,i),ac(t,s,o)),o}function qc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Kg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function gf(t,e){Kg(t,e),(t=t.alternate)&&Kg(t,e)}function a1(){return null}var Y0=typeof reportError=="function"?reportError:function(t){console.error(t)};function yf(t){this._internalRoot=t}Au.prototype.render=yf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(W(409));Tu(t,e,null,null)};Au.prototype.unmount=yf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ia(function(){Tu(null,t,null,null)}),e[$r]=null}};function Au(t){this._internalRoot=t}Au.prototype.unstable_scheduleHydration=function(t){if(t){var e=IE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<gs.length&&e!==0&&e<gs[n].priority;n++);gs.splice(n,0,t),n===0&&AE(t)}};function vf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ku(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Qg(){}function i1(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=qc(o);i.call(d)}}var o=Q0(e,r,t,0,null,!1,!1,"",Qg);return t._reactRootContainer=o,t[$r]=o.current,Mo(t.nodeType===8?t.parentNode:t),Ia(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var c=r;r=function(){var d=qc(u);c.call(d)}}var u=pf(t,0,!1,null,null,!1,!1,"",Qg);return t._reactRootContainer=u,t[$r]=u.current,Mo(t.nodeType===8?t.parentNode:t),Ia(function(){Tu(e,u,n,r)}),u}function Pu(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var c=s;s=function(){var u=qc(o);c.call(u)}}Tu(e,o,t,s)}else o=i1(n,e,t,s,r);return qc(o)}SE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=so(e.pendingLanes);n!==0&&(Mh(e,n|1),dn(e,rt()),!(Te&6)&&(Si=rt()+500,Ys()))}break;case 13:Ia(function(){var r=Hr(t,1);if(r!==null){var s=Jt();er(r,t,1,s)}}),gf(t,1)}};Lh=function(t){if(t.tag===13){var e=Hr(t,134217728);if(e!==null){var n=Jt();er(e,t,134217728,n)}gf(t,134217728)}};CE=function(t){if(t.tag===13){var e=Ps(t),n=Hr(t,e);if(n!==null){var r=Jt();er(n,t,e,r)}gf(t,e)}};IE=function(){return De};TE=function(t,e){var n=De;try{return De=t,e()}finally{De=n}};um=function(t,e,n){switch(e){case"input":if(rm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=wu(r);if(!s)throw Error(W(90));aE(r),rm(r,s)}}}break;case"textarea":oE(t,n);break;case"select":e=n.value,e!=null&&ci(t,!!n.multiple,e,!1)}};fE=df;pE=Ia;var o1={usingClientEntryPoint:!1,Events:[ol,ti,wu,mE,hE,df]},eo={findFiberByHostInstance:pa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},l1={bundleType:eo.bundleType,version:eo.version,rendererPackageName:eo.rendererPackageName,rendererConfig:eo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Yr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=vE(t),t===null?null:t.stateNode},findFiberByHostInstance:eo.findFiberByHostInstance||a1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ql=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ql.isDisabled&&ql.supportsFiber)try{yu=ql.inject(l1),gr=ql}catch{}}bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=o1;bn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vf(e))throw Error(W(200));return s1(t,e,null,n)};bn.createRoot=function(t,e){if(!vf(t))throw Error(W(299));var n=!1,r="",s=Y0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=pf(t,1,!1,null,null,n,!1,r,s),t[$r]=e.current,Mo(t.nodeType===8?t.parentNode:t),new yf(e)};bn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(W(188)):(t=Object.keys(t).join(","),Error(W(268,t)));return t=vE(e),t=t===null?null:t.stateNode,t};bn.flushSync=function(t){return Ia(t)};bn.hydrate=function(t,e,n){if(!ku(e))throw Error(W(200));return Pu(null,t,e,!0,n)};bn.hydrateRoot=function(t,e,n){if(!vf(t))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Y0;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Q0(e,null,t,1,n??null,s,!1,i,o),t[$r]=e.current,Mo(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Au(e)};bn.render=function(t,e,n){if(!ku(e))throw Error(W(200));return Pu(null,t,e,!1,n)};bn.unmountComponentAtNode=function(t){if(!ku(t))throw Error(W(40));return t._reactRootContainer?(Ia(function(){Pu(null,null,t,!1,function(){t._reactRootContainer=null,t[$r]=null})}),!0):!1};bn.unstable_batchedUpdates=df;bn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ku(n))throw Error(W(200));if(t==null||t._reactInternals===void 0)throw Error(W(38));return Pu(t,e,n,!1,r)};bn.version="18.3.1-next-f1338f8080-20240426";function X0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(X0)}catch(t){console.error(t)}}X0(),Xv.exports=bn;var c1=Xv.exports,J0,Yg=c1;J0=Yg.createRoot,Yg.hydrateRoot;function Z0(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=Z0(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function Wc(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=Z0(t))&&(r&&(r+=" "),r+=e);return r}const u1=[{key:"inicio",label:"Incio",icon:""},{key:"clientes",label:"Clientes",icon:""},{key:"produtos",label:"Produtos",icon:""},{key:"vendas",label:"Vendas",icon:""},{key:"caixa",label:"Caixa",icon:""},{key:"notas",label:"Notas fiscais",icon:""},{key:"os",label:"Ordem de Servio",icon:""},{key:"cpagar",label:"Contas a pagar",icon:""},{key:"creceber",label:"Contas a receber",icon:""},{key:"estatisticas",label:"Estatsticas",icon:""}];function d1({onNavigate:t,active:e,onLogout:n,mobileOpen:r=!1,onMobileClose:s}){const i=()=>{s&&s()};return a.createElement("aside",{className:Wc("bg-white border-r z-40 dark:bg-[#0f1724] dark:border-gray-800","md:static md:w-64 md:min-h-screen md:overflow-y-auto","fixed inset-y-0 left-0 w-72 md:w-64 md:block h-screen overflow-y-auto","transform transition-transform duration-200 ease-out mobile-sidebar",r?"translate-x-0":"-translate-x-full md:translate-x-0"),"aria-hidden":!r&&typeof window<"u"&&window.innerWidth<768,role:"navigation"},a.createElement("div",{className:"p-4 md:p-6"},a.createElement("div",{className:"flex items-center gap-3"},a.createElement("div",{className:"rounded-full bg-green-100 p-2 text-green-700"},""),a.createElement("div",null,a.createElement("div",{className:"font-bold text-lg text-gray-900 dark:text-white"},"Siste",a.createElement("span",{className:"text-green-600"},"Mix")))),a.createElement("button",{className:"mt-4 md:mt-6 w-full bg-green-600 text-white py-2 rounded hover:opacity-95"},"Vender"),a.createElement("nav",{className:"mt-6"},u1.map(o=>a.createElement("div",{key:o.key,onClick:()=>{t(o.key),i()},className:Wc("mt-2 p-2 rounded cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center gap-3",e===o.key&&"bg-gray-100 dark:bg-gray-800")},a.createElement("span",{className:"w-6 text-gray-900 dark:text-white"},o.icon),a.createElement("span",{className:"text-sm text-gray-900 dark:text-white"},o.label)))),a.createElement("div",{className:"mt-8 border-t pt-4 text-sm text-gray-600 dark:text-gray-300 dark:border-gray-800"},a.createElement("div",{className:"p-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 rounded"},"Suporte"),a.createElement("div",{className:"p-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 rounded",onClick:()=>{t("configuracoes"),i()}},"Configuraes"),a.createElement("div",{className:"p-2 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-800 rounded",onClick:()=>{n&&n(),i()}},"Sair"))))}function m1({user:t,title:e,onUserClick:n,mobileControls:r,rightAction:s}){const i=((t==null?void 0:t.name)||"Usurio").trim(),o=(i==null?void 0:i[0])||"?",c=typeof n=="function"?n:()=>{};return a.createElement("header",{className:"flex items-center justify-between"},a.createElement("div",{className:"flex items-center gap-2 md:gap-4"},a.createElement("button",{className:"md:hidden h-9 w-9 rounded-full border border-slate-300 flex items-center justify-center bg-white shadow-sm active:scale-[0.98] text-slate-700","aria-label":r!=null&&r.isOpen?"Fechar menu":"Abrir menu","aria-expanded":r!=null&&r.isOpen?"true":"false",onClick:r==null?void 0:r.toggle,title:r!=null&&r.isOpen?"Fechar menu":"Abrir menu"},a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},a.createElement("path",{d:"M4 7h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),a.createElement("path",{d:"M4 12h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),a.createElement("path",{d:"M4 17h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}))),a.createElement("h1",{className:"text-2xl font-bold"},e??"Incio")),a.createElement("div",{className:"flex items-center gap-3"},s?a.createElement("div",{className:"flex items-center"},s):null,a.createElement("div",{className:"hidden md:flex items-center gap-4"},a.createElement("div",{className:"flex items-center gap-2 border p-2 rounded cursor-pointer hover:bg-gray-100",onClick:c,title:"Trocar de loja"},a.createElement("div",{className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center"},o),a.createElement("div",{className:"text-sm font-medium"},i)))))}const h1=()=>{};var Xg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},f1=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],c=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},t_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,c=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,h=i>>2,p=(i&3)<<4|c>>4;let y=(c&15)<<2|d>>6,S=d&63;u||(S=64,o||(y=64)),r.push(n[h],n[p],n[y],n[S])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(e_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):f1(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||c==null||d==null||p==null)throw new p1;const y=i<<2|c>>4;if(r.push(y),d!==64){const S=c<<4&240|d>>2;if(r.push(S),p!==64){const P=d<<6&192|p;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class p1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const g1=function(t){const e=e_(t);return t_.encodeByteArray(e,!0)},Gc=function(t){return g1(t).replace(/\./g,"")},n_=function(t){try{return t_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v1=()=>y1().__FIREBASE_DEFAULTS__,E1=()=>{if(typeof process>"u"||typeof Xg>"u")return;const t=Xg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},_1=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&n_(t[1]);return e&&JSON.parse(e)},Ru=()=>{try{return h1()||v1()||E1()||_1()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},r_=t=>{var e,n;return(n=(e=Ru())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},w1=t=>{const e=r_(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},s_=()=>{var t;return(t=Ru())==null?void 0:t.config},a_=t=>{var e;return(e=Ru())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ma(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ef(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N1(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Gc(JSON.stringify(n)),Gc(JSON.stringify(o)),""].join(".")}const xo={};function b1(){const t={prod:[],emulator:[]};for(const e of Object.keys(xo))xo[e]?t.emulator.push(e):t.prod.push(e);return t}function S1(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Jg=!1;function i_(t,e){if(typeof window>"u"||typeof document>"u"||!Ma(window.location.host)||xo[t]===e||xo[t]||Jg)return;xo[t]=e;function n(y){return`__firebase__banner__${y}`}const r="__firebase__banner",i=b1().prod.length>0;function o(){const y=document.getElementById(r);y&&y.remove()}function c(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function u(y,S){y.setAttribute("width","24"),y.setAttribute("id",S),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function d(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{Jg=!0,o()},y}function h(y,S){y.setAttribute("id",S),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function p(){const y=S1(r),S=n("text"),P=document.getElementById(S)||document.createElement("span"),w=n("learnmore"),A=document.getElementById(w)||document.createElement("a"),_=n("preprendIcon"),v=document.getElementById(_)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const I=y.element;c(I),h(A,w);const D=d();u(v,_),I.append(v,P,A,D),document.body.appendChild(I)}i?(P.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,P.innerText="Preview backend running in this workspace."),P.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function C1(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ht())}function I1(){var e;const t=(e=Ru())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function T1(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function A1(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function k1(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function P1(){const t=Ht();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function R1(){return!I1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function D1(){try{return typeof indexedDB=="object"}catch{return!1}}function V1(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O1="FirebaseError";class Ar extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=O1,Object.setPrototypeOf(this,Ar.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,cl.prototype.create)}}class cl{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?M1(i,r):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new Ar(s,c,r)}}function M1(t,e){return t.replace(L1,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const L1=/\{\$([^}]+)}/g;function F1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ta(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Zg(i)&&Zg(o)){if(!Ta(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Zg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ul(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function io(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function oo(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function U1(t,e){const n=new j1(t,e);return n.subscribe.bind(n)}class j1{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");B1(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Fd),s.error===void 0&&(s.error=Fd),s.complete===void 0&&(s.complete=Fd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function B1(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Fd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tt(t){return t&&t._delegate?t._delegate:t}class Us{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new x1;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(H1(e))try{this.getOrInitializeService({instanceIdentifier:fa})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=fa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=fa){return this.instances.has(e)}getOptions(e=fa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:$1(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=fa){return this.component?this.component.multipleInstances?e:fa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $1(t){return t===fa?void 0:t}function H1(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new z1(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(xe||(xe={}));const W1={debug:xe.DEBUG,verbose:xe.VERBOSE,info:xe.INFO,warn:xe.WARN,error:xe.ERROR,silent:xe.SILENT},G1=xe.INFO,K1={[xe.DEBUG]:"log",[xe.VERBOSE]:"log",[xe.INFO]:"info",[xe.WARN]:"warn",[xe.ERROR]:"error"},Q1=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=K1[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class _f{constructor(e){this.name=e,this._logLevel=G1,this._logHandler=Q1,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?W1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,xe.DEBUG,...e),this._logHandler(this,xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,xe.VERBOSE,...e),this._logHandler(this,xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,xe.INFO,...e),this._logHandler(this,xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,xe.WARN,...e),this._logHandler(this,xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,xe.ERROR,...e),this._logHandler(this,xe.ERROR,...e)}}const Y1=(t,e)=>e.some(n=>t instanceof n);let ey,ty;function X1(){return ey||(ey=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function J1(){return ty||(ty=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const o_=new WeakMap,$m=new WeakMap,l_=new WeakMap,Ud=new WeakMap,wf=new WeakMap;function Z1(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Ds(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&o_.set(n,t)}).catch(()=>{}),wf.set(e,t),e}function eS(t){if($m.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});$m.set(t,e)}let Hm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return $m.get(t);if(e==="objectStoreNames")return t.objectStoreNames||l_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ds(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function tS(t){Hm=t(Hm)}function nS(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(jd(this),e,...n);return l_.set(r,e.sort?e.sort():[e]),Ds(r)}:J1().includes(t)?function(...e){return t.apply(jd(this),e),Ds(o_.get(this))}:function(...e){return Ds(t.apply(jd(this),e))}}function rS(t){return typeof t=="function"?nS(t):(t instanceof IDBTransaction&&eS(t),Y1(t,X1())?new Proxy(t,Hm):t)}function Ds(t){if(t instanceof IDBRequest)return Z1(t);if(Ud.has(t))return Ud.get(t);const e=rS(t);return e!==t&&(Ud.set(t,e),wf.set(e,t)),e}const jd=t=>wf.get(t);function sS(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),c=Ds(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Ds(o.result),u.oldVersion,u.newVersion,Ds(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const aS=["get","getKey","getAll","getAllKeys","count"],iS=["put","add","delete","clear"],Bd=new Map;function ny(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Bd.get(e))return Bd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=iS.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||aS.includes(n)))return;const i=async function(o,...c){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(c.shift())),(await Promise.all([d[n](...c),s&&u.done]))[0]};return Bd.set(e,i),i}tS(t=>({...t,get:(e,n,r)=>ny(e,n)||t.get(e,n,r),has:(e,n)=>!!ny(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(lS(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function lS(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const qm="@firebase/app",ry="0.14.4";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wr=new _f("@firebase/app"),cS="@firebase/app-compat",uS="@firebase/analytics-compat",dS="@firebase/analytics",mS="@firebase/app-check-compat",hS="@firebase/app-check",fS="@firebase/auth",pS="@firebase/auth-compat",gS="@firebase/database",yS="@firebase/data-connect",vS="@firebase/database-compat",ES="@firebase/functions",_S="@firebase/functions-compat",wS="@firebase/installations",xS="@firebase/installations-compat",NS="@firebase/messaging",bS="@firebase/messaging-compat",SS="@firebase/performance",CS="@firebase/performance-compat",IS="@firebase/remote-config",TS="@firebase/remote-config-compat",AS="@firebase/storage",kS="@firebase/storage-compat",PS="@firebase/firestore",RS="@firebase/ai",DS="@firebase/firestore-compat",VS="firebase",OS="12.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wm="[DEFAULT]",MS={[qm]:"fire-core",[cS]:"fire-core-compat",[dS]:"fire-analytics",[uS]:"fire-analytics-compat",[hS]:"fire-app-check",[mS]:"fire-app-check-compat",[fS]:"fire-auth",[pS]:"fire-auth-compat",[gS]:"fire-rtdb",[yS]:"fire-data-connect",[vS]:"fire-rtdb-compat",[ES]:"fire-fn",[_S]:"fire-fn-compat",[wS]:"fire-iid",[xS]:"fire-iid-compat",[NS]:"fire-fcm",[bS]:"fire-fcm-compat",[SS]:"fire-perf",[CS]:"fire-perf-compat",[IS]:"fire-rc",[TS]:"fire-rc-compat",[AS]:"fire-gcs",[kS]:"fire-gcs-compat",[PS]:"fire-fst",[DS]:"fire-fst-compat",[RS]:"fire-vertex","fire-js":"fire-js",[VS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kc=new Map,LS=new Map,Gm=new Map;function sy(t,e){try{t.container.addComponent(e)}catch(n){Wr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Aa(t){const e=t.name;if(Gm.has(e))return Wr.debug(`There were multiple attempts to register component ${e}.`),!1;Gm.set(e,t);for(const n of Kc.values())sy(n,t);for(const n of LS.values())sy(n,t);return!0}function Du(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function En(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Vs=new cl("app","Firebase",FS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Us("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Vs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La=OS;function c_(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Wm,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw Vs.create("bad-app-name",{appName:String(s)});if(n||(n=s_()),!n)throw Vs.create("no-options");const i=Kc.get(s);if(i){if(Ta(n,i.options)&&Ta(r,i.config))return i;throw Vs.create("duplicate-app",{appName:s})}const o=new q1(s);for(const u of Gm.values())o.addComponent(u);const c=new US(n,r,o);return Kc.set(s,c),c}function u_(t=Wm){const e=Kc.get(t);if(!e&&t===Wm&&s_())return c_();if(!e)throw Vs.create("no-app",{appName:t});return e}function vr(t,e,n){let r=MS[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Wr.warn(o.join(" "));return}Aa(new Us(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jS="firebase-heartbeat-database",BS=1,qo="firebase-heartbeat-store";let zd=null;function d_(){return zd||(zd=sS(jS,BS,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(qo)}catch(n){console.warn(n)}}}}).catch(t=>{throw Vs.create("idb-open",{originalErrorMessage:t.message})})),zd}async function zS(t){try{const n=(await d_()).transaction(qo),r=await n.objectStore(qo).get(m_(t));return await n.done,r}catch(e){if(e instanceof Ar)Wr.warn(e.message);else{const n=Vs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Wr.warn(n.message)}}}async function ay(t,e){try{const r=(await d_()).transaction(qo,"readwrite");await r.objectStore(qo).put(e,m_(t)),await r.done}catch(n){if(n instanceof Ar)Wr.warn(n.message);else{const r=Vs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Wr.warn(r.message)}}}function m_(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S=1024,HS=30;class qS{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new GS(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=iy();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>HS){const o=KS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Wr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=iy(),{heartbeatsToSend:r,unsentEntries:s}=WS(this._heartbeatsCache.heartbeats),i=Gc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Wr.warn(n),""}}}function iy(){return new Date().toISOString().substring(0,10)}function WS(t,e=$S){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),oy(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),oy(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class GS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return D1()?V1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await zS(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return ay(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return ay(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function oy(t){return Gc(JSON.stringify({version:2,heartbeats:t})).length}function KS(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QS(t){Aa(new Us("platform-logger",e=>new oS(e),"PRIVATE")),Aa(new Us("heartbeat",e=>new qS(e),"PRIVATE")),vr(qm,ry,t),vr(qm,ry,"esm2020"),vr("fire-js","")}QS("");var ly=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Os,h_;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(b,g){function x(){}x.prototype=g.prototype,b.F=g.prototype,b.prototype=new x,b.prototype.constructor=b,b.D=function(T,k,R){for(var C=Array(arguments.length-2),te=2;te<arguments.length;te++)C[te-2]=arguments[te];return g.prototype[k].apply(T,C)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(b,g,x){x||(x=0);const T=Array(16);if(typeof g=="string")for(var k=0;k<16;++k)T[k]=g.charCodeAt(x++)|g.charCodeAt(x++)<<8|g.charCodeAt(x++)<<16|g.charCodeAt(x++)<<24;else for(k=0;k<16;++k)T[k]=g[x++]|g[x++]<<8|g[x++]<<16|g[x++]<<24;g=b.g[0],x=b.g[1],k=b.g[2];let R=b.g[3],C;C=g+(R^x&(k^R))+T[0]+3614090360&4294967295,g=x+(C<<7&4294967295|C>>>25),C=R+(k^g&(x^k))+T[1]+3905402710&4294967295,R=g+(C<<12&4294967295|C>>>20),C=k+(x^R&(g^x))+T[2]+606105819&4294967295,k=R+(C<<17&4294967295|C>>>15),C=x+(g^k&(R^g))+T[3]+3250441966&4294967295,x=k+(C<<22&4294967295|C>>>10),C=g+(R^x&(k^R))+T[4]+4118548399&4294967295,g=x+(C<<7&4294967295|C>>>25),C=R+(k^g&(x^k))+T[5]+1200080426&4294967295,R=g+(C<<12&4294967295|C>>>20),C=k+(x^R&(g^x))+T[6]+2821735955&4294967295,k=R+(C<<17&4294967295|C>>>15),C=x+(g^k&(R^g))+T[7]+4249261313&4294967295,x=k+(C<<22&4294967295|C>>>10),C=g+(R^x&(k^R))+T[8]+1770035416&4294967295,g=x+(C<<7&4294967295|C>>>25),C=R+(k^g&(x^k))+T[9]+2336552879&4294967295,R=g+(C<<12&4294967295|C>>>20),C=k+(x^R&(g^x))+T[10]+4294925233&4294967295,k=R+(C<<17&4294967295|C>>>15),C=x+(g^k&(R^g))+T[11]+2304563134&4294967295,x=k+(C<<22&4294967295|C>>>10),C=g+(R^x&(k^R))+T[12]+1804603682&4294967295,g=x+(C<<7&4294967295|C>>>25),C=R+(k^g&(x^k))+T[13]+4254626195&4294967295,R=g+(C<<12&4294967295|C>>>20),C=k+(x^R&(g^x))+T[14]+2792965006&4294967295,k=R+(C<<17&4294967295|C>>>15),C=x+(g^k&(R^g))+T[15]+1236535329&4294967295,x=k+(C<<22&4294967295|C>>>10),C=g+(k^R&(x^k))+T[1]+4129170786&4294967295,g=x+(C<<5&4294967295|C>>>27),C=R+(x^k&(g^x))+T[6]+3225465664&4294967295,R=g+(C<<9&4294967295|C>>>23),C=k+(g^x&(R^g))+T[11]+643717713&4294967295,k=R+(C<<14&4294967295|C>>>18),C=x+(R^g&(k^R))+T[0]+3921069994&4294967295,x=k+(C<<20&4294967295|C>>>12),C=g+(k^R&(x^k))+T[5]+3593408605&4294967295,g=x+(C<<5&4294967295|C>>>27),C=R+(x^k&(g^x))+T[10]+38016083&4294967295,R=g+(C<<9&4294967295|C>>>23),C=k+(g^x&(R^g))+T[15]+3634488961&4294967295,k=R+(C<<14&4294967295|C>>>18),C=x+(R^g&(k^R))+T[4]+3889429448&4294967295,x=k+(C<<20&4294967295|C>>>12),C=g+(k^R&(x^k))+T[9]+568446438&4294967295,g=x+(C<<5&4294967295|C>>>27),C=R+(x^k&(g^x))+T[14]+3275163606&4294967295,R=g+(C<<9&4294967295|C>>>23),C=k+(g^x&(R^g))+T[3]+4107603335&4294967295,k=R+(C<<14&4294967295|C>>>18),C=x+(R^g&(k^R))+T[8]+1163531501&4294967295,x=k+(C<<20&4294967295|C>>>12),C=g+(k^R&(x^k))+T[13]+2850285829&4294967295,g=x+(C<<5&4294967295|C>>>27),C=R+(x^k&(g^x))+T[2]+4243563512&4294967295,R=g+(C<<9&4294967295|C>>>23),C=k+(g^x&(R^g))+T[7]+1735328473&4294967295,k=R+(C<<14&4294967295|C>>>18),C=x+(R^g&(k^R))+T[12]+2368359562&4294967295,x=k+(C<<20&4294967295|C>>>12),C=g+(x^k^R)+T[5]+4294588738&4294967295,g=x+(C<<4&4294967295|C>>>28),C=R+(g^x^k)+T[8]+2272392833&4294967295,R=g+(C<<11&4294967295|C>>>21),C=k+(R^g^x)+T[11]+1839030562&4294967295,k=R+(C<<16&4294967295|C>>>16),C=x+(k^R^g)+T[14]+4259657740&4294967295,x=k+(C<<23&4294967295|C>>>9),C=g+(x^k^R)+T[1]+2763975236&4294967295,g=x+(C<<4&4294967295|C>>>28),C=R+(g^x^k)+T[4]+1272893353&4294967295,R=g+(C<<11&4294967295|C>>>21),C=k+(R^g^x)+T[7]+4139469664&4294967295,k=R+(C<<16&4294967295|C>>>16),C=x+(k^R^g)+T[10]+3200236656&4294967295,x=k+(C<<23&4294967295|C>>>9),C=g+(x^k^R)+T[13]+681279174&4294967295,g=x+(C<<4&4294967295|C>>>28),C=R+(g^x^k)+T[0]+3936430074&4294967295,R=g+(C<<11&4294967295|C>>>21),C=k+(R^g^x)+T[3]+3572445317&4294967295,k=R+(C<<16&4294967295|C>>>16),C=x+(k^R^g)+T[6]+76029189&4294967295,x=k+(C<<23&4294967295|C>>>9),C=g+(x^k^R)+T[9]+3654602809&4294967295,g=x+(C<<4&4294967295|C>>>28),C=R+(g^x^k)+T[12]+3873151461&4294967295,R=g+(C<<11&4294967295|C>>>21),C=k+(R^g^x)+T[15]+530742520&4294967295,k=R+(C<<16&4294967295|C>>>16),C=x+(k^R^g)+T[2]+3299628645&4294967295,x=k+(C<<23&4294967295|C>>>9),C=g+(k^(x|~R))+T[0]+4096336452&4294967295,g=x+(C<<6&4294967295|C>>>26),C=R+(x^(g|~k))+T[7]+1126891415&4294967295,R=g+(C<<10&4294967295|C>>>22),C=k+(g^(R|~x))+T[14]+2878612391&4294967295,k=R+(C<<15&4294967295|C>>>17),C=x+(R^(k|~g))+T[5]+4237533241&4294967295,x=k+(C<<21&4294967295|C>>>11),C=g+(k^(x|~R))+T[12]+1700485571&4294967295,g=x+(C<<6&4294967295|C>>>26),C=R+(x^(g|~k))+T[3]+2399980690&4294967295,R=g+(C<<10&4294967295|C>>>22),C=k+(g^(R|~x))+T[10]+4293915773&4294967295,k=R+(C<<15&4294967295|C>>>17),C=x+(R^(k|~g))+T[1]+2240044497&4294967295,x=k+(C<<21&4294967295|C>>>11),C=g+(k^(x|~R))+T[8]+1873313359&4294967295,g=x+(C<<6&4294967295|C>>>26),C=R+(x^(g|~k))+T[15]+4264355552&4294967295,R=g+(C<<10&4294967295|C>>>22),C=k+(g^(R|~x))+T[6]+2734768916&4294967295,k=R+(C<<15&4294967295|C>>>17),C=x+(R^(k|~g))+T[13]+1309151649&4294967295,x=k+(C<<21&4294967295|C>>>11),C=g+(k^(x|~R))+T[4]+4149444226&4294967295,g=x+(C<<6&4294967295|C>>>26),C=R+(x^(g|~k))+T[11]+3174756917&4294967295,R=g+(C<<10&4294967295|C>>>22),C=k+(g^(R|~x))+T[2]+718787259&4294967295,k=R+(C<<15&4294967295|C>>>17),C=x+(R^(k|~g))+T[9]+3951481745&4294967295,b.g[0]=b.g[0]+g&4294967295,b.g[1]=b.g[1]+(k+(C<<21&4294967295|C>>>11))&4294967295,b.g[2]=b.g[2]+k&4294967295,b.g[3]=b.g[3]+R&4294967295}r.prototype.v=function(b,g){g===void 0&&(g=b.length);const x=g-this.blockSize,T=this.C;let k=this.h,R=0;for(;R<g;){if(k==0)for(;R<=x;)s(this,b,R),R+=this.blockSize;if(typeof b=="string"){for(;R<g;)if(T[k++]=b.charCodeAt(R++),k==this.blockSize){s(this,T),k=0;break}}else for(;R<g;)if(T[k++]=b[R++],k==this.blockSize){s(this,T),k=0;break}}this.h=k,this.o+=g},r.prototype.A=function(){var b=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);b[0]=128;for(var g=1;g<b.length-8;++g)b[g]=0;g=this.o*8;for(var x=b.length-8;x<b.length;++x)b[x]=g&255,g/=256;for(this.v(b),b=Array(16),g=0,x=0;x<4;++x)for(let T=0;T<32;T+=8)b[g++]=this.g[x]>>>T&255;return b};function i(b,g){var x=c;return Object.prototype.hasOwnProperty.call(x,b)?x[b]:x[b]=g(b)}function o(b,g){this.h=g;const x=[];let T=!0;for(let k=b.length-1;k>=0;k--){const R=b[k]|0;T&&R==g||(x[k]=R,T=!1)}this.g=x}var c={};function u(b){return-128<=b&&b<128?i(b,function(g){return new o([g|0],g<0?-1:0)}):new o([b|0],b<0?-1:0)}function d(b){if(isNaN(b)||!isFinite(b))return p;if(b<0)return A(d(-b));const g=[];let x=1;for(let T=0;b>=x;T++)g[T]=b/x|0,x*=4294967296;return new o(g,0)}function h(b,g){if(b.length==0)throw Error("number format error: empty string");if(g=g||10,g<2||36<g)throw Error("radix out of range: "+g);if(b.charAt(0)=="-")return A(h(b.substring(1),g));if(b.indexOf("-")>=0)throw Error('number format error: interior "-" character');const x=d(Math.pow(g,8));let T=p;for(let R=0;R<b.length;R+=8){var k=Math.min(8,b.length-R);const C=parseInt(b.substring(R,R+k),g);k<8?(k=d(Math.pow(g,k)),T=T.j(k).add(d(C))):(T=T.j(x),T=T.add(d(C)))}return T}var p=u(0),y=u(1),S=u(16777216);t=o.prototype,t.m=function(){if(w(this))return-A(this).m();let b=0,g=1;for(let x=0;x<this.g.length;x++){const T=this.i(x);b+=(T>=0?T:4294967296+T)*g,g*=4294967296}return b},t.toString=function(b){if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(P(this))return"0";if(w(this))return"-"+A(this).toString(b);const g=d(Math.pow(b,6));var x=this;let T="";for(;;){const k=D(x,g).g;x=_(x,k.j(g));let R=((x.g.length>0?x.g[0]:x.h)>>>0).toString(b);if(x=k,P(x))return R+T;for(;R.length<6;)R="0"+R;T=R+T}},t.i=function(b){return b<0?0:b<this.g.length?this.g[b]:this.h};function P(b){if(b.h!=0)return!1;for(let g=0;g<b.g.length;g++)if(b.g[g]!=0)return!1;return!0}function w(b){return b.h==-1}t.l=function(b){return b=_(this,b),w(b)?-1:P(b)?0:1};function A(b){const g=b.g.length,x=[];for(let T=0;T<g;T++)x[T]=~b.g[T];return new o(x,~b.h).add(y)}t.abs=function(){return w(this)?A(this):this},t.add=function(b){const g=Math.max(this.g.length,b.g.length),x=[];let T=0;for(let k=0;k<=g;k++){let R=T+(this.i(k)&65535)+(b.i(k)&65535),C=(R>>>16)+(this.i(k)>>>16)+(b.i(k)>>>16);T=C>>>16,R&=65535,C&=65535,x[k]=C<<16|R}return new o(x,x[x.length-1]&-2147483648?-1:0)};function _(b,g){return b.add(A(g))}t.j=function(b){if(P(this)||P(b))return p;if(w(this))return w(b)?A(this).j(A(b)):A(A(this).j(b));if(w(b))return A(this.j(A(b)));if(this.l(S)<0&&b.l(S)<0)return d(this.m()*b.m());const g=this.g.length+b.g.length,x=[];for(var T=0;T<2*g;T++)x[T]=0;for(T=0;T<this.g.length;T++)for(let k=0;k<b.g.length;k++){const R=this.i(T)>>>16,C=this.i(T)&65535,te=b.i(k)>>>16,Se=b.i(k)&65535;x[2*T+2*k]+=C*Se,v(x,2*T+2*k),x[2*T+2*k+1]+=R*Se,v(x,2*T+2*k+1),x[2*T+2*k+1]+=C*te,v(x,2*T+2*k+1),x[2*T+2*k+2]+=R*te,v(x,2*T+2*k+2)}for(b=0;b<g;b++)x[b]=x[2*b+1]<<16|x[2*b];for(b=g;b<2*g;b++)x[b]=0;return new o(x,0)};function v(b,g){for(;(b[g]&65535)!=b[g];)b[g+1]+=b[g]>>>16,b[g]&=65535,g++}function I(b,g){this.g=b,this.h=g}function D(b,g){if(P(g))throw Error("division by zero");if(P(b))return new I(p,p);if(w(b))return g=D(A(b),g),new I(A(g.g),A(g.h));if(w(g))return g=D(b,A(g)),new I(A(g.g),g.h);if(b.g.length>30){if(w(b)||w(g))throw Error("slowDivide_ only works with positive integers.");for(var x=y,T=g;T.l(b)<=0;)x=M(x),T=M(T);var k=V(x,1),R=V(T,1);for(T=V(T,2),x=V(x,2);!P(T);){var C=R.add(T);C.l(b)<=0&&(k=k.add(x),R=C),T=V(T,1),x=V(x,1)}return g=_(b,k.j(g)),new I(k,g)}for(k=p;b.l(g)>=0;){for(x=Math.max(1,Math.floor(b.m()/g.m())),T=Math.ceil(Math.log(x)/Math.LN2),T=T<=48?1:Math.pow(2,T-48),R=d(x),C=R.j(g);w(C)||C.l(b)>0;)x-=T,R=d(x),C=R.j(g);P(R)&&(R=y),k=k.add(R),b=_(b,C)}return new I(k,b)}t.B=function(b){return D(this,b).h},t.and=function(b){const g=Math.max(this.g.length,b.g.length),x=[];for(let T=0;T<g;T++)x[T]=this.i(T)&b.i(T);return new o(x,this.h&b.h)},t.or=function(b){const g=Math.max(this.g.length,b.g.length),x=[];for(let T=0;T<g;T++)x[T]=this.i(T)|b.i(T);return new o(x,this.h|b.h)},t.xor=function(b){const g=Math.max(this.g.length,b.g.length),x=[];for(let T=0;T<g;T++)x[T]=this.i(T)^b.i(T);return new o(x,this.h^b.h)};function M(b){const g=b.g.length+1,x=[];for(let T=0;T<g;T++)x[T]=b.i(T)<<1|b.i(T-1)>>>31;return new o(x,b.h)}function V(b,g){const x=g>>5;g%=32;const T=b.g.length-x,k=[];for(let R=0;R<T;R++)k[R]=g>0?b.i(R+x)>>>g|b.i(R+x+1)<<32-g:b.i(R+x);return new o(k,b.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,h_=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Os=o}).apply(typeof ly<"u"?ly:typeof self<"u"?self:typeof window<"u"?window:{});var Wl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var f_,lo,p_,mc,Km,g_,y_,v_;(function(){var t,e=Object.defineProperty;function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Wl=="object"&&Wl];for(var m=0;m<l.length;++m){var f=l[m];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function s(l,m){if(m)e:{var f=r;l=l.split(".");for(var N=0;N<l.length-1;N++){var L=l[N];if(!(L in f))break e;f=f[L]}l=l[l.length-1],N=f[l],m=m(N),m!=N&&m!=null&&e(f,l,{configurable:!0,writable:!0,value:m})}}s("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(l){return l||function(m){var f=[],N;for(N in m)Object.prototype.hasOwnProperty.call(m,N)&&f.push([N,m[N]]);return f}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function c(l){var m=typeof l;return m=="object"&&l!=null||m=="function"}function u(l,m,f){return l.call.apply(l.bind,arguments)}function d(l,m,f){return d=u,d.apply(null,arguments)}function h(l,m){var f=Array.prototype.slice.call(arguments,1);return function(){var N=f.slice();return N.push.apply(N,arguments),l.apply(this,N)}}function p(l,m){function f(){}f.prototype=m.prototype,l.Z=m.prototype,l.prototype=new f,l.prototype.constructor=l,l.Ob=function(N,L,F){for(var Q=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)Q[ve-2]=arguments[ve];return m.prototype[L].apply(N,Q)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function S(l){const m=l.length;if(m>0){const f=Array(m);for(let N=0;N<m;N++)f[N]=l[N];return f}return[]}function P(l,m){for(let N=1;N<arguments.length;N++){const L=arguments[N];var f=typeof L;if(f=f!="object"?f:L?Array.isArray(L)?"array":f:"null",f=="array"||f=="object"&&typeof L.length=="number"){f=l.length||0;const F=L.length||0;l.length=f+F;for(let Q=0;Q<F;Q++)l[f+Q]=L[Q]}else l.push(L)}}class w{constructor(m,f){this.i=m,this.j=f,this.h=0,this.g=null}get(){let m;return this.h>0?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function A(l){o.setTimeout(()=>{throw l},0)}function _(){var l=b;let m=null;return l.g&&(m=l.g,l.g=l.g.next,l.g||(l.h=null),m.next=null),m}class v{constructor(){this.h=this.g=null}add(m,f){const N=I.get();N.set(m,f),this.h?this.h.next=N:this.g=N,this.h=N}}var I=new w(()=>new D,l=>l.reset());class D{constructor(){this.next=this.g=this.h=null}set(m,f){this.h=m,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let M,V=!1,b=new v,g=()=>{const l=Promise.resolve(void 0);M=()=>{l.then(x)}};function x(){for(var l;l=_();){try{l.h.call(l.g)}catch(f){A(f)}var m=I;m.j(l),m.h<100&&(m.h++,l.next=m.g,m.g=l)}V=!1}function T(){this.u=this.u,this.C=this.C}T.prototype.u=!1,T.prototype.dispose=function(){this.u||(this.u=!0,this.N())},T.prototype[Symbol.dispose]=function(){this.dispose()},T.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(l,m){this.type=l,this.g=this.target=m,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var R=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var l=!1,m=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const f=()=>{};o.addEventListener("test",f,m),o.removeEventListener("test",f,m)}catch{}return l}();function C(l){return/^[\s\xa0]*$/.test(l)}function te(l,m){k.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,m)}p(te,k),te.prototype.init=function(l,m){const f=this.type=l.type,N=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=m,m=l.relatedTarget,m||(f=="mouseover"?m=l.fromElement:f=="mouseout"&&(m=l.toElement)),this.relatedTarget=m,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&te.Z.h.call(this)},te.prototype.h=function(){te.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Se="closure_listenable_"+(Math.random()*1e6|0),we=0;function Ae(l,m,f,N,L){this.listener=l,this.proxy=null,this.src=m,this.type=f,this.capture=!!N,this.ha=L,this.key=++we,this.da=this.fa=!1}function H(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function q(l,m,f){for(const N in l)m.call(f,l[N],N,l)}function Z(l,m){for(const f in l)m.call(void 0,l[f],f,l)}function K(l){const m={};for(const f in l)m[f]=l[f];return m}const se="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U(l,m){let f,N;for(let L=1;L<arguments.length;L++){N=arguments[L];for(f in N)l[f]=N[f];for(let F=0;F<se.length;F++)f=se[F],Object.prototype.hasOwnProperty.call(N,f)&&(l[f]=N[f])}}function G(l){this.src=l,this.g={},this.h=0}G.prototype.add=function(l,m,f,N,L){const F=l.toString();l=this.g[F],l||(l=this.g[F]=[],this.h++);const Q=fe(l,m,N,L);return Q>-1?(m=l[Q],f||(m.fa=!1)):(m=new Ae(m,this.src,F,!!N,L),m.fa=f,l.push(m)),m};function re(l,m){const f=m.type;if(f in l.g){var N=l.g[f],L=Array.prototype.indexOf.call(N,m,void 0),F;(F=L>=0)&&Array.prototype.splice.call(N,L,1),F&&(H(m),l.g[f].length==0&&(delete l.g[f],l.h--))}}function fe(l,m,f,N){for(let L=0;L<l.length;++L){const F=l[L];if(!F.da&&F.listener==m&&F.capture==!!f&&F.ha==N)return L}return-1}var Ee="closure_lm_"+(Math.random()*1e6|0),ke={};function Y(l,m,f,N,L){if(Array.isArray(m)){for(let F=0;F<m.length;F++)Y(l,m[F],f,N,L);return null}return f=sr(f),l&&l[Se]?l.J(m,f,c(N)?!!N.capture:!1,L):ae(l,m,f,!1,N,L)}function ae(l,m,f,N,L,F){if(!m)throw Error("Invalid event type");const Q=c(L)?!!L.capture:!!L;let ve=ce(l);if(ve||(l[Ee]=ve=new G(l)),f=ve.add(m,f,N,Q,F),f.proxy)return f;if(N=it(),f.proxy=N,N.src=l,N.listener=f,l.addEventListener)R||(L=Q),L===void 0&&(L=!1),l.addEventListener(m.toString(),N,L);else if(l.attachEvent)l.attachEvent(Je(m.toString()),N);else if(l.addListener&&l.removeListener)l.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return f}function it(){function l(f){return m.call(l.src,l.listener,f)}const m=tn;return l}function ot(l,m,f,N,L){if(Array.isArray(m))for(var F=0;F<m.length;F++)ot(l,m[F],f,N,L);else N=c(N)?!!N.capture:!!N,f=sr(f),l&&l[Se]?(l=l.i,F=String(m).toString(),F in l.g&&(m=l.g[F],f=fe(m,f,N,L),f>-1&&(H(m[f]),Array.prototype.splice.call(m,f,1),m.length==0&&(delete l.g[F],l.h--)))):l&&(l=ce(l))&&(m=l.g[m.toString()],l=-1,m&&(l=fe(m,f,N,L)),(f=l>-1?m[l]:null)&&oe(f))}function oe(l){if(typeof l!="number"&&l&&!l.da){var m=l.src;if(m&&m[Se])re(m.i,l);else{var f=l.type,N=l.proxy;m.removeEventListener?m.removeEventListener(f,N,l.capture):m.detachEvent?m.detachEvent(Je(f),N):m.addListener&&m.removeListener&&m.removeListener(N),(f=ce(m))?(re(f,l),f.h==0&&(f.src=null,m[Ee]=null)):H(l)}}}function Je(l){return l in ke?ke[l]:ke[l]="on"+l}function tn(l,m){if(l.da)l=!0;else{m=new te(m,this);const f=l.listener,N=l.ha||l.src;l.fa&&oe(l),l=f.call(N,m)}return l}function ce(l){return l=l[Ee],l instanceof G?l:null}var _t="__closure_events_fn_"+(Math.random()*1e9>>>0);function sr(l){return typeof l=="function"?l:(l[_t]||(l[_t]=function(m){return l.handleEvent(m)}),l[_t])}function ze(){T.call(this),this.i=new G(this),this.M=this,this.G=null}p(ze,T),ze.prototype[Se]=!0,ze.prototype.removeEventListener=function(l,m,f,N){ot(this,l,m,f,N)};function $(l,m){var f,N=l.G;if(N)for(f=[];N;N=N.G)f.push(N);if(l=l.M,N=m.type||m,typeof m=="string")m=new k(m,l);else if(m instanceof k)m.target=m.target||l;else{var L=m;m=new k(N,l),U(m,L)}L=!0;let F,Q;if(f)for(Q=f.length-1;Q>=0;Q--)F=m.g=f[Q],L=Ce(F,N,!0,m)&&L;if(F=m.g=l,L=Ce(F,N,!0,m)&&L,L=Ce(F,N,!1,m)&&L,f)for(Q=0;Q<f.length;Q++)F=m.g=f[Q],L=Ce(F,N,!1,m)&&L}ze.prototype.N=function(){if(ze.Z.N.call(this),this.i){var l=this.i;for(const m in l.g){const f=l.g[m];for(let N=0;N<f.length;N++)H(f[N]);delete l.g[m],l.h--}}this.G=null},ze.prototype.J=function(l,m,f,N){return this.i.add(String(l),m,!1,f,N)},ze.prototype.K=function(l,m,f,N){return this.i.add(String(l),m,!0,f,N)};function Ce(l,m,f,N){if(m=l.i.g[String(m)],!m)return!0;m=m.concat();let L=!0;for(let F=0;F<m.length;++F){const Q=m[F];if(Q&&!Q.da&&Q.capture==f){const ve=Q.listener,pt=Q.ha||Q.src;Q.fa&&re(l.i,Q),L=ve.call(pt,N)!==!1&&L}}return L&&!N.defaultPrevented}function qt(l,m){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=d(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(m)>2147483647?-1:o.setTimeout(l,m||0)}function Pe(l){l.g=qt(()=>{l.g=null,l.i&&(l.i=!1,Pe(l))},l.l);const m=l.h;l.h=null,l.m.apply(null,m)}class In extends T{constructor(m,f){super(),this.m=m,this.l=f,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:Pe(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function J(l){T.call(this),this.h=l,this.g={}}p(J,T);var Ze=[];function wt(l){q(l.g,function(m,f){this.g.hasOwnProperty(f)&&oe(m)},l),l.g={}}J.prototype.N=function(){J.Z.N.call(this),wt(this)},J.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var lt=o.JSON.stringify,xt=o.JSON.parse,Wt=class{stringify(l){return o.JSON.stringify(l,void 0)}parse(l){return o.JSON.parse(l,void 0)}};function hn(){}function Hn(){}var Tn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function $e(){k.call(this,"d")}p($e,k);function ar(){k.call(this,"c")}p(ar,k);var fn={},Zr=null;function qn(){return Zr=Zr||new ze}fn.Ia="serverreachability";function es(l){k.call(this,fn.Ia,l)}p(es,k);function nn(l){const m=qn();$(m,new es(m))}fn.STAT_EVENT="statevent";function ra(l,m){k.call(this,fn.STAT_EVENT,l),this.stat=m}p(ra,k);function et(l){const m=qn();$(m,new ra(m,l))}fn.Ja="timingevent";function sa(l,m){k.call(this,fn.Ja,l),this.size=m}p(sa,k);function An(l,m){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){l()},m)}function kn(){this.g=!0}kn.prototype.ua=function(){this.g=!1};function ir(l,m,f,N,L,F){l.info(function(){if(l.g)if(F){var Q="",ve=F.split("&");for(let Oe=0;Oe<ve.length;Oe++){var pt=ve[Oe].split("=");if(pt.length>1){const bt=pt[0];pt=pt[1];const dr=bt.split("_");Q=dr.length>=2&&dr[1]=="type"?Q+(bt+"="+pt+"&"):Q+(bt+"=redacted&")}}}else Q=null;else Q=F;return"XMLHTTP REQ ("+N+") [attempt "+L+"]: "+m+`
`+f+`
`+Q})}function Pn(l,m,f,N,L,F,Q){l.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+L+"]: "+m+`
`+f+`
`+F+" "+Q})}function Nt(l,m,f,N){l.info(function(){return"XMLHTTP TEXT ("+m+"): "+ts(l,f)+(N?" "+N:"")})}function Pr(l,m){l.info(function(){return"TIMEOUT: "+m})}kn.prototype.info=function(){};function ts(l,m){if(!l.g)return m;if(!m)return null;try{const F=JSON.parse(m);if(F){for(l=0;l<F.length;l++)if(Array.isArray(F[l])){var f=F[l];if(!(f.length<2)){var N=f[1];if(Array.isArray(N)&&!(N.length<1)){var L=N[0];if(L!="noop"&&L!="stop"&&L!="close")for(let Q=1;Q<N.length;Q++)N[Q]=""}}}}return lt(F)}catch{return m}}var or={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},aa={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ns;function Gt(){}p(Gt,hn),Gt.prototype.g=function(){return new XMLHttpRequest},ns=new Gt;function Kt(l){return encodeURIComponent(String(l))}function Rn(l){var m=1;l=l.split(":");const f=[];for(;m>0&&l.length;)f.push(l.shift()),m--;return l.length&&f.push(l.join(":")),f}function Mt(l,m,f,N){this.j=l,this.i=m,this.l=f,this.S=N||1,this.V=new J(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new pn}function pn(){this.i=null,this.g="",this.h=!1}var Wn={},Lt={};function tt(l,m,f){l.M=1,l.A=He(Vn(m)),l.u=f,l.R=!0,rs(l,null)}function rs(l,m){l.F=Date.now(),ye(l),l.B=Vn(l.A);var f=l.B,N=l.S;Array.isArray(N)||(N=[String(N)]),_p(f.i,"t",N),l.C=0,f=l.j.L,l.h=new pn,l.g=Fp(l.j,f?m:null,!l.u),l.P>0&&(l.O=new In(d(l.Y,l,l.g),l.P)),m=l.V,f=l.g,N=l.ba;var L="readystatechange";Array.isArray(L)||(L&&(Ze[0]=L.toString()),L=Ze);for(let F=0;F<L.length;F++){const Q=Y(f,L[F],N||m.handleEvent,!1,m.h||m);if(!Q)break;m.g[Q.key]=Q}m=l.J?K(l.J):{},l.u?(l.v||(l.v="POST"),m["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,m)):(l.v="GET",l.g.ea(l.B,l.v,null,m)),nn(),ir(l.i,l.v,l.B,l.l,l.S,l.u)}Mt.prototype.ba=function(l){l=l.target;const m=this.O;m&&cs(l)==3?m.j():this.Y(l)},Mt.prototype.Y=function(l){try{if(l==this.g)e:{const ve=cs(this.g),pt=this.g.ya(),Oe=this.g.ca();if(!(ve<3)&&(ve!=3||this.g&&(this.h.h||this.g.la()||Ip(this.g)))){this.K||ve!=4||pt==7||(pt==8||Oe<=0?nn(3):nn(2)),ht(this);var m=this.g.ca();this.X=m;var f=ss(this);if(this.o=m==200,Pn(this.i,this.v,this.B,this.l,this.S,ve,m),this.o){if(this.U&&!this.L){t:{if(this.g){var N,L=this.g;if((N=L.g?L.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(N)){var F=N;break t}}F=null}if(l=F)Nt(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,is(this,l);else{this.o=!1,this.m=3,et(12),Dn(this),lr(this);break e}}if(this.R){l=!0;let bt;for(;!this.K&&this.C<f.length;)if(bt=B(this,f),bt==Lt){ve==4&&(this.m=4,et(14),l=!1),Nt(this.i,this.l,null,"[Incomplete Response]");break}else if(bt==Wn){this.m=4,et(15),Nt(this.i,this.l,f,"[Invalid Chunk]"),l=!1;break}else Nt(this.i,this.l,bt,null),is(this,bt);if(as(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ve!=4||f.length!=0||this.h.h||(this.m=1,et(16),l=!1),this.o=this.o&&l,!l)Nt(this.i,this.l,f,"[Invalid Chunked Response]"),Dn(this),lr(this);else if(f.length>0&&!this.W){this.W=!0;var Q=this.j;Q.g==this&&Q.aa&&!Q.P&&(Q.j.info("Great, no buffering proxy detected. Bytes received: "+f.length),ud(Q),Q.P=!0,et(11))}}else Nt(this.i,this.l,f,null),is(this,f);ve==4&&Dn(this),this.o&&!this.K&&(ve==4?Vp(this.j,this):(this.o=!1,ye(this)))}else Bx(this.g),m==400&&f.indexOf("Unknown SID")>0?(this.m=3,et(12)):(this.m=0,et(13)),Dn(this),lr(this)}}}catch{}finally{}};function ss(l){if(!as(l))return l.g.la();const m=Ip(l.g);if(m==="")return"";let f="";const N=m.length,L=cs(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return Dn(l),lr(l),"";l.h.i=new o.TextDecoder}for(let F=0;F<N;F++)l.h.h=!0,f+=l.h.i.decode(m[F],{stream:!(L&&F==N-1)});return m.length=0,l.h.g+=f,l.C=0,l.h.g}function as(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function B(l,m){var f=l.C,N=m.indexOf(`
`,f);return N==-1?Lt:(f=Number(m.substring(f,N)),isNaN(f)?Wn:(N+=1,N+f>m.length?Lt:(m=m.slice(N,N+f),l.C=N+f,m)))}Mt.prototype.cancel=function(){this.K=!0,Dn(this)};function ye(l){l.T=Date.now()+l.H,Qt(l,l.H)}function Qt(l,m){if(l.D!=null)throw Error("WatchDog timer not null");l.D=An(d(l.aa,l),m)}function ht(l){l.D&&(o.clearTimeout(l.D),l.D=null)}Mt.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?(Pr(this.i,this.B),this.M!=2&&(nn(),et(17)),Dn(this),this.m=2,lr(this)):Qt(this,this.T-l)};function lr(l){l.j.I==0||l.K||Vp(l.j,l)}function Dn(l){ht(l);var m=l.O;m&&typeof m.dispose=="function"&&m.dispose(),l.O=null,wt(l.V),l.g&&(m=l.g,l.g=null,m.abort(),m.dispose())}function is(l,m){try{var f=l.j;if(f.I!=0&&(f.g==l||ft(f.h,l))){if(!l.L&&ft(f.h,l)&&f.I==3){try{var N=f.Ba.g.parse(m)}catch{N=null}if(Array.isArray(N)&&N.length==3){var L=N;if(L[0]==0){e:if(!f.v){if(f.g)if(f.g.F+3e3<l.F)Cl(f),bl(f);else break e;cd(f),et(18)}}else f.xa=L[1],0<f.xa-f.K&&L[2]<37500&&f.F&&f.A==0&&!f.C&&(f.C=An(d(f.Va,f),6e3));oa(f.h)<=1&&f.ta&&(f.ta=void 0)}else ua(f,11)}else if((l.L||f.g==l)&&Cl(f),!C(m))for(L=f.Ba.g.parse(m),m=0;m<L.length;m++){let Oe=L[m];const bt=Oe[0];if(!(bt<=f.K))if(f.K=bt,Oe=Oe[1],f.I==2)if(Oe[0]=="c"){f.M=Oe[1],f.ba=Oe[2];const dr=Oe[3];dr!=null&&(f.ka=dr,f.j.info("VER="+f.ka));const da=Oe[4];da!=null&&(f.za=da,f.j.info("SVER="+f.za));const us=Oe[5];us!=null&&typeof us=="number"&&us>0&&(N=1.5*us,f.O=N,f.j.info("backChannelRequestTimeoutMs_="+N)),N=f;const ds=l.g;if(ds){const Tl=ds.g?ds.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Tl){var F=N.h;F.g||Tl.indexOf("spdy")==-1&&Tl.indexOf("quic")==-1&&Tl.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(Yt(F,F.h),F.h=null))}if(N.G){const dd=ds.g?ds.g.getResponseHeader("X-HTTP-Session-Id"):null;dd&&(N.wa=dd,de(N.J,N.G,dd))}}f.I=3,f.l&&f.l.ra(),f.aa&&(f.T=Date.now()-l.F,f.j.info("Handshake RTT: "+f.T+"ms")),N=f;var Q=l;if(N.na=Lp(N,N.L?N.ba:null,N.W),Q.L){Rr(N.h,Q);var ve=Q,pt=N.O;pt&&(ve.H=pt),ve.D&&(ht(ve),ye(ve)),N.g=Q}else Rp(N);f.i.length>0&&Sl(f)}else Oe[0]!="stop"&&Oe[0]!="close"||ua(f,7);else f.I==3&&(Oe[0]=="stop"||Oe[0]=="close"?Oe[0]=="stop"?ua(f,7):ld(f):Oe[0]!="noop"&&f.l&&f.l.qa(Oe),f.A=0)}}nn(4)}catch{}}var cr=class{constructor(l,m){this.g=l,this.map=m}};function ia(l){this.l=l||10,o.PerformanceNavigationTiming?(l=o.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function os(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function oa(l){return l.h?1:l.g?l.g.size:0}function ft(l,m){return l.h?l.h==m:l.g?l.g.has(m):!1}function Yt(l,m){l.g?l.g.add(m):l.h=m}function Rr(l,m){l.h&&l.h==m?l.h=null:l.g&&l.g.has(m)&&l.g.delete(m)}ia.prototype.cancel=function(){if(this.i=Ba(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Ba(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let m=l.i;for(const f of l.g.values())m=m.concat(f.G);return m}return S(l.i)}var ji=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function sd(l,m){if(l){l=l.split("&");for(let f=0;f<l.length;f++){const N=l[f].indexOf("=");let L,F=null;N>=0?(L=l[f].substring(0,N),F=l[f].substring(N+1)):L=l[f],m(L,F?decodeURIComponent(F.replace(/\+/g," ")):"")}}}function ur(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let m;l instanceof ur?(this.l=l.l,la(this,l.j),this.o=l.o,this.g=l.g,O(this,l.u),this.h=l.h,ie(this,wp(l.i)),this.m=l.m):l&&(m=String(l).match(ji))?(this.l=!1,la(this,m[1]||"",!0),this.o=gn(m[2]||""),this.g=gn(m[3]||"",!0),O(this,m[4]),this.h=gn(m[5]||"",!0),ie(this,m[6]||"",!0),this.m=gn(m[7]||"")):(this.l=!1,this.i=new zi(null,this.l))}ur.prototype.toString=function(){const l=[];var m=this.j;m&&l.push(At(m,wl,!0),":");var f=this.g;return(f||m=="file")&&(l.push("//"),(m=this.o)&&l.push(At(m,wl,!0),"@"),l.push(Kt(f).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.u,f!=null&&l.push(":",String(f))),(f=this.h)&&(this.g&&f.charAt(0)!="/"&&l.push("/"),l.push(At(f,f.charAt(0)=="/"?Rx:ad,!0))),(f=this.i.toString())&&l.push("?",f),(f=this.m)&&l.push("#",At(f,Vx)),l.join("")},ur.prototype.resolve=function(l){const m=Vn(this);let f=!!l.j;f?la(m,l.j):f=!!l.o,f?m.o=l.o:f=!!l.g,f?m.g=l.g:f=l.u!=null;var N=l.h;if(f)O(m,l.u);else if(f=!!l.h){if(N.charAt(0)!="/")if(this.g&&!this.h)N="/"+N;else{var L=m.h.lastIndexOf("/");L!=-1&&(N=m.h.slice(0,L+1)+N)}if(L=N,L==".."||L==".")N="";else if(L.indexOf("./")!=-1||L.indexOf("/.")!=-1){N=L.lastIndexOf("/",0)==0,L=L.split("/");const F=[];for(let Q=0;Q<L.length;){const ve=L[Q++];ve=="."?N&&Q==L.length&&F.push(""):ve==".."?((F.length>1||F.length==1&&F[0]!="")&&F.pop(),N&&Q==L.length&&F.push("")):(F.push(ve),N=!0)}N=F.join("/")}else N=L}return f?m.h=N:f=l.i.toString()!=="",f?ie(m,wp(l.i)):f=!!l.m,f&&(m.m=l.m),m};function Vn(l){return new ur(l)}function la(l,m,f){l.j=f?gn(m,!0):m,l.j&&(l.j=l.j.replace(/:$/,""))}function O(l,m){if(m){if(m=Number(m),isNaN(m)||m<0)throw Error("Bad port number "+m);l.u=m}else l.u=null}function ie(l,m,f){m instanceof zi?(l.i=m,Ox(l.i,l.l)):(f||(m=At(m,Dx)),l.i=new zi(m,l.l))}function de(l,m,f){l.i.set(m,f)}function He(l){return de(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function gn(l,m){return l?m?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function At(l,m,f){return typeof l=="string"?(l=encodeURI(l).replace(m,Bi),f&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function Bi(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var wl=/[#\/\?@]/g,ad=/[#\?:]/g,Rx=/[#\?]/g,Dx=/[#\?@]/g,Vx=/#/g;function zi(l,m){this.h=this.g=null,this.i=l||null,this.j=!!m}function ca(l){l.g||(l.g=new Map,l.h=0,l.i&&sd(l.i,function(m,f){l.add(decodeURIComponent(m.replace(/\+/g," ")),f)}))}t=zi.prototype,t.add=function(l,m){ca(this),this.i=null,l=za(this,l);let f=this.g.get(l);return f||this.g.set(l,f=[]),f.push(m),this.h+=1,this};function yp(l,m){ca(l),m=za(l,m),l.g.has(m)&&(l.i=null,l.h-=l.g.get(m).length,l.g.delete(m))}function vp(l,m){return ca(l),m=za(l,m),l.g.has(m)}t.forEach=function(l,m){ca(this),this.g.forEach(function(f,N){f.forEach(function(L){l.call(m,L,N,this)},this)},this)};function Ep(l,m){ca(l);let f=[];if(typeof m=="string")vp(l,m)&&(f=f.concat(l.g.get(za(l,m))));else for(l=Array.from(l.g.values()),m=0;m<l.length;m++)f=f.concat(l[m]);return f}t.set=function(l,m){return ca(this),this.i=null,l=za(this,l),vp(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[m]),this.h+=1,this},t.get=function(l,m){return l?(l=Ep(this,l),l.length>0?String(l[0]):m):m};function _p(l,m,f){yp(l,m),f.length>0&&(l.i=null,l.g.set(za(l,m),S(f)),l.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],m=Array.from(this.g.keys());for(let N=0;N<m.length;N++){var f=m[N];const L=Kt(f);f=Ep(this,f);for(let F=0;F<f.length;F++){let Q=L;f[F]!==""&&(Q+="="+Kt(f[F])),l.push(Q)}}return this.i=l.join("&")};function wp(l){const m=new zi;return m.i=l.i,l.g&&(m.g=new Map(l.g),m.h=l.h),m}function za(l,m){return m=String(m),l.j&&(m=m.toLowerCase()),m}function Ox(l,m){m&&!l.j&&(ca(l),l.i=null,l.g.forEach(function(f,N){const L=N.toLowerCase();N!=L&&(yp(this,N),_p(this,L,f))},l)),l.j=m}function Mx(l,m){const f=new kn;if(o.Image){const N=new Image;N.onload=h(ls,f,"TestLoadImage: loaded",!0,m,N),N.onerror=h(ls,f,"TestLoadImage: error",!1,m,N),N.onabort=h(ls,f,"TestLoadImage: abort",!1,m,N),N.ontimeout=h(ls,f,"TestLoadImage: timeout",!1,m,N),o.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=l}else m(!1)}function Lx(l,m){const f=new kn,N=new AbortController,L=setTimeout(()=>{N.abort(),ls(f,"TestPingServer: timeout",!1,m)},1e4);fetch(l,{signal:N.signal}).then(F=>{clearTimeout(L),F.ok?ls(f,"TestPingServer: ok",!0,m):ls(f,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(L),ls(f,"TestPingServer: error",!1,m)})}function ls(l,m,f,N,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),N(f)}catch{}}function Fx(){this.g=new Wt}function id(l){this.i=l.Sb||null,this.h=l.ab||!1}p(id,hn),id.prototype.g=function(){return new xl(this.i,this.h)};function xl(l,m){ze.call(this),this.H=l,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(xl,ze),t=xl.prototype,t.open=function(l,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=m,this.readyState=1,Hi(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const m={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(m.body=l),(this.H||o).fetch(new Request(this.D,m)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,$i(this)),this.readyState=0},t.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Hi(this)),this.g&&(this.readyState=3,Hi(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;xp(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function xp(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}t.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var m=l.value?l.value:new Uint8Array(0);(m=this.B.decode(m,{stream:!l.done}))&&(this.response=this.responseText+=m)}l.done?$i(this):Hi(this),this.readyState==3&&xp(this)}},t.Oa=function(l){this.g&&(this.response=this.responseText=l,$i(this))},t.Na=function(l){this.g&&(this.response=l,$i(this))},t.ga=function(){this.g&&$i(this)};function $i(l){l.readyState=4,l.l=null,l.j=null,l.B=null,Hi(l)}t.setRequestHeader=function(l,m){this.A.append(l,m)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],m=this.h.entries();for(var f=m.next();!f.done;)f=f.value,l.push(f[0]+": "+f[1]),f=m.next();return l.join(`\r
`)};function Hi(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(xl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Np(l){let m="";return q(l,function(f,N){m+=N,m+=":",m+=f,m+=`\r
`}),m}function od(l,m,f){e:{for(N in f){var N=!1;break e}N=!0}N||(f=Np(f),typeof l=="string"?f!=null&&Kt(f):de(l,m,f))}function Ye(l){ze.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(Ye,ze);var Ux=/^https?$/i,jx=["POST","PUT"];t=Ye.prototype,t.Fa=function(l){this.H=l},t.ea=function(l,m,f,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);m=m?m.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ns.g(),this.g.onreadystatechange=y(d(this.Ca,this));try{this.B=!0,this.g.open(m,String(l),!0),this.B=!1}catch(F){bp(this,F);return}if(l=f||"",f=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var L in N)f.set(L,N[L]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const F of N.keys())f.set(F,N.get(F));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(f.keys()).find(F=>F.toLowerCase()=="content-type"),L=o.FormData&&l instanceof o.FormData,!(Array.prototype.indexOf.call(jx,m,void 0)>=0)||N||L||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,Q]of f)this.g.setRequestHeader(F,Q);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(F){bp(this,F)}};function bp(l,m){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=m,l.o=5,Sp(l),Nl(l)}function Sp(l){l.A||(l.A=!0,$(l,"complete"),$(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,$(this,"complete"),$(this,"abort"),Nl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Nl(this,!0)),Ye.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Cp(this):this.Xa())},t.Xa=function(){Cp(this)};function Cp(l){if(l.h&&typeof i<"u"){if(l.v&&cs(l)==4)setTimeout(l.Ca.bind(l),0);else if($(l,"readystatechange"),cs(l)==4){l.h=!1;try{const F=l.ca();e:switch(F){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var f;if(!(f=m)){var N;if(N=F===0){let Q=String(l.D).match(ji)[1]||null;!Q&&o.self&&o.self.location&&(Q=o.self.location.protocol.slice(0,-1)),N=!Ux.test(Q?Q.toLowerCase():"")}f=N}if(f)$(l,"complete"),$(l,"success");else{l.o=6;try{var L=cs(l)>2?l.g.statusText:""}catch{L=""}l.l=L+" ["+l.ca()+"]",Sp(l)}}finally{Nl(l)}}}}function Nl(l,m){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const f=l.g;l.g=null,m||$(l,"ready");try{f.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function cs(l){return l.g?l.g.readyState:0}t.ca=function(){try{return cs(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(l){if(this.g){var m=this.g.responseText;return l&&m.indexOf(l)==0&&(m=m.substring(l.length)),xt(m)}};function Ip(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function Bx(l){const m={};l=(l.g&&cs(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<l.length;N++){if(C(l[N]))continue;var f=Rn(l[N]);const L=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const F=m[L]||[];m[L]=F,F.push(f)}Z(m,function(N){return N.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function qi(l,m,f){return f&&f.internalChannelParams&&f.internalChannelParams[l]||m}function Tp(l){this.za=0,this.i=[],this.j=new kn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=qi("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=qi("baseRetryDelayMs",5e3,l),this.Za=qi("retryDelaySeedMs",1e4,l),this.Ta=qi("forwardChannelMaxRetries",2,l),this.va=qi("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new ia(l&&l.concurrentRequestLimit),this.Ba=new Fx,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Tp.prototype,t.ka=8,t.I=1,t.connect=function(l,m,f,N){et(0),this.W=l,this.H=m||{},f&&N!==void 0&&(this.H.OSID=f,this.H.OAID=N),this.F=this.X,this.J=Lp(this,null,this.W),Sl(this)};function ld(l){if(Ap(l),l.I==3){var m=l.V++,f=Vn(l.J);if(de(f,"SID",l.M),de(f,"RID",m),de(f,"TYPE","terminate"),Wi(l,f),m=new Mt(l,l.j,m),m.M=2,m.A=He(Vn(f)),f=!1,o.navigator&&o.navigator.sendBeacon)try{f=o.navigator.sendBeacon(m.A.toString(),"")}catch{}!f&&o.Image&&(new Image().src=m.A,f=!0),f||(m.g=Fp(m.j,null),m.g.ea(m.A)),m.F=Date.now(),ye(m)}Mp(l)}function bl(l){l.g&&(ud(l),l.g.cancel(),l.g=null)}function Ap(l){bl(l),l.v&&(o.clearTimeout(l.v),l.v=null),Cl(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&o.clearTimeout(l.m),l.m=null)}function Sl(l){if(!os(l.h)&&!l.m){l.m=!0;var m=l.Ea;M||g(),V||(M(),V=!0),b.add(m,l),l.D=0}}function zx(l,m){return oa(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=m.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=An(d(l.Ea,l,m),Op(l,l.D)),l.D++,!0)}t.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const L=new Mt(this,this.j,l);let F=this.o;if(this.U&&(F?(F=K(F),U(F,this.U)):F=this.U),this.u!==null||this.R||(L.J=F,F=null),this.S)e:{for(var m=0,f=0;f<this.i.length;f++){t:{var N=this.i[f];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(m+=N,m>4096){m=f;break e}if(m===4096||f===this.i.length-1){m=f+1;break e}}m=1e3}else m=1e3;m=Pp(this,L,m),f=Vn(this.J),de(f,"RID",l),de(f,"CVER",22),this.G&&de(f,"X-HTTP-Session-Id",this.G),Wi(this,f),F&&(this.R?m="headers="+Kt(Np(F))+"&"+m:this.u&&od(f,this.u,F)),Yt(this.h,L),this.Ra&&de(f,"TYPE","init"),this.S?(de(f,"$req",m),de(f,"SID","null"),L.U=!0,tt(L,f,null)):tt(L,f,m),this.I=2}}else this.I==3&&(l?kp(this,l):this.i.length==0||os(this.h)||kp(this))};function kp(l,m){var f;m?f=m.l:f=l.V++;const N=Vn(l.J);de(N,"SID",l.M),de(N,"RID",f),de(N,"AID",l.K),Wi(l,N),l.u&&l.o&&od(N,l.u,l.o),f=new Mt(l,l.j,f,l.D+1),l.u===null&&(f.J=l.o),m&&(l.i=m.G.concat(l.i)),m=Pp(l,f,1e3),f.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),Yt(l.h,f),tt(f,N,m)}function Wi(l,m){l.H&&q(l.H,function(f,N){de(m,N,f)}),l.l&&q({},function(f,N){de(m,N,f)})}function Pp(l,m,f){f=Math.min(l.i.length,f);const N=l.l?d(l.l.Ka,l.l,l):null;e:{var L=l.i;let ve=-1;for(;;){const pt=["count="+f];ve==-1?f>0?(ve=L[0].g,pt.push("ofs="+ve)):ve=0:pt.push("ofs="+ve);let Oe=!0;for(let bt=0;bt<f;bt++){var F=L[bt].g;const dr=L[bt].map;if(F-=ve,F<0)ve=Math.max(0,L[bt].g-100),Oe=!1;else try{F="req"+F+"_"||"";try{var Q=dr instanceof Map?dr:Object.entries(dr);for(const[da,us]of Q){let ds=us;c(us)&&(ds=lt(us)),pt.push(F+da+"="+encodeURIComponent(ds))}}catch(da){throw pt.push(F+"type="+encodeURIComponent("_badmap")),da}}catch{N&&N(dr)}}if(Oe){Q=pt.join("&");break e}}Q=void 0}return l=l.i.splice(0,f),m.G=l,Q}function Rp(l){if(!l.g&&!l.v){l.Y=1;var m=l.Da;M||g(),V||(M(),V=!0),b.add(m,l),l.A=0}}function cd(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=An(d(l.Da,l),Op(l,l.A)),l.A++,!0)}t.Da=function(){if(this.v=null,Dp(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=An(d(this.Wa,this),l)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,et(10),bl(this),Dp(this))};function ud(l){l.B!=null&&(o.clearTimeout(l.B),l.B=null)}function Dp(l){l.g=new Mt(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var m=Vn(l.na);de(m,"RID","rpc"),de(m,"SID",l.M),de(m,"AID",l.K),de(m,"CI",l.F?"0":"1"),!l.F&&l.ia&&de(m,"TO",l.ia),de(m,"TYPE","xmlhttp"),Wi(l,m),l.u&&l.o&&od(m,l.u,l.o),l.O&&(l.g.H=l.O);var f=l.g;l=l.ba,f.M=1,f.A=He(Vn(m)),f.u=null,f.R=!0,rs(f,l)}t.Va=function(){this.C!=null&&(this.C=null,bl(this),cd(this),et(19))};function Cl(l){l.C!=null&&(o.clearTimeout(l.C),l.C=null)}function Vp(l,m){var f=null;if(l.g==m){Cl(l),ud(l),l.g=null;var N=2}else if(ft(l.h,m))f=m.G,Rr(l.h,m),N=1;else return;if(l.I!=0){if(m.o)if(N==1){f=m.u?m.u.length:0,m=Date.now()-m.F;var L=l.D;N=qn(),$(N,new sa(N,f)),Sl(l)}else Rp(l);else if(L=m.m,L==3||L==0&&m.X>0||!(N==1&&zx(l,m)||N==2&&cd(l)))switch(f&&f.length>0&&(m=l.h,m.i=m.i.concat(f)),L){case 1:ua(l,5);break;case 4:ua(l,10);break;case 3:ua(l,6);break;default:ua(l,2)}}}function Op(l,m){let f=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(f*=2),f*m}function ua(l,m){if(l.j.info("Error code "+m),m==2){var f=d(l.bb,l),N=l.Ua;const L=!N;N=new ur(N||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||la(N,"https"),He(N),L?Mx(N.toString(),f):Lx(N.toString(),f)}else et(2);l.I=0,l.l&&l.l.pa(m),Mp(l),Ap(l)}t.bb=function(l){l?(this.j.info("Successfully pinged google.com"),et(2)):(this.j.info("Failed to ping google.com"),et(1))};function Mp(l){if(l.I=0,l.ja=[],l.l){const m=Ba(l.h);(m.length!=0||l.i.length!=0)&&(P(l.ja,m),P(l.ja,l.i),l.h.i.length=0,S(l.i),l.i.length=0),l.l.oa()}}function Lp(l,m,f){var N=f instanceof ur?Vn(f):new ur(f);if(N.g!="")m&&(N.g=m+"."+N.g),O(N,N.u);else{var L=o.location;N=L.protocol,m=m?m+"."+L.hostname:L.hostname,L=+L.port;const F=new ur(null);N&&la(F,N),m&&(F.g=m),L&&O(F,L),f&&(F.h=f),N=F}return f=l.G,m=l.wa,f&&m&&de(N,f,m),de(N,"VER",l.ka),Wi(l,N),N}function Fp(l,m,f){if(m&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return m=l.Aa&&!l.ma?new Ye(new id({ab:f})):new Ye(l.ma),m.Fa(l.L),m}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Up(){}t=Up.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Il(){}Il.prototype.g=function(l,m){return new yn(l,m)};function yn(l,m){ze.call(this),this.g=new Tp(m),this.l=l,this.h=m&&m.messageUrlParams||null,l=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(l?l["X-WebChannel-Content-Type"]=m.messageContentType:l={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.sa&&(l?l["X-WebChannel-Client-Profile"]=m.sa:l={"X-WebChannel-Client-Profile":m.sa}),this.g.U=l,(l=m&&m.Qb)&&!C(l)&&(this.g.u=l),this.A=m&&m.supportsCrossDomainXhr||!1,this.v=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!C(m)&&(this.g.G=m,l=this.h,l!==null&&m in l&&(l=this.h,m in l&&delete l[m])),this.j=new $a(this)}p(yn,ze),yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){ld(this.g)},yn.prototype.o=function(l){var m=this.g;if(typeof l=="string"){var f={};f.__data__=l,l=f}else this.v&&(f={},f.__data__=lt(l),l=f);m.i.push(new cr(m.Ya++,l)),m.I==3&&Sl(m)},yn.prototype.N=function(){this.g.l=null,delete this.j,ld(this.g),delete this.g,yn.Z.N.call(this)};function jp(l){$e.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var m=l.__sm__;if(m){e:{for(const f in m){l=f;break e}l=void 0}(this.i=l)&&(l=this.i,m=m!==null&&l in m?m[l]:void 0),this.data=m}else this.data=l}p(jp,$e);function Bp(){ar.call(this),this.status=1}p(Bp,ar);function $a(l){this.g=l}p($a,Up),$a.prototype.ra=function(){$(this.g,"a")},$a.prototype.qa=function(l){$(this.g,new jp(l))},$a.prototype.pa=function(l){$(this.g,new Bp)},$a.prototype.oa=function(){$(this.g,"b")},Il.prototype.createWebChannel=Il.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,v_=function(){return new Il},y_=function(){return qn()},g_=fn,Km={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},or.NO_ERROR=0,or.TIMEOUT=8,or.HTTP_ERROR=6,mc=or,aa.COMPLETE="complete",p_=aa,Hn.EventType=Tn,Tn.OPEN="a",Tn.CLOSE="b",Tn.ERROR="c",Tn.MESSAGE="d",ze.prototype.listen=ze.prototype.J,lo=Hn,Ye.prototype.listenOnce=Ye.prototype.K,Ye.prototype.getLastError=Ye.prototype.Ha,Ye.prototype.getLastErrorCode=Ye.prototype.ya,Ye.prototype.getStatus=Ye.prototype.ca,Ye.prototype.getResponseJson=Ye.prototype.La,Ye.prototype.getResponseText=Ye.prototype.la,Ye.prototype.send=Ye.prototype.ea,Ye.prototype.setWithCredentials=Ye.prototype.Fa,f_=Ye}).apply(typeof Wl<"u"?Wl:typeof self<"u"?self:typeof window<"u"?window:{});const cy="@firebase/firestore",uy="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}rn.UNAUTHENTICATED=new rn(null),rn.GOOGLE_CREDENTIALS=new rn("google-credentials-uid"),rn.FIRST_PARTY=new rn("first-party-uid"),rn.MOCK_USER=new rn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vi="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ka=new _f("@firebase/firestore");function qa(){return ka.logLevel}function ee(t,...e){if(ka.logLevel<=xe.DEBUG){const n=e.map(xf);ka.debug(`Firestore (${Vi}): ${t}`,...n)}}function Gr(t,...e){if(ka.logLevel<=xe.ERROR){const n=e.map(xf);ka.error(`Firestore (${Vi}): ${t}`,...n)}}function Wo(t,...e){if(ka.logLevel<=xe.WARN){const n=e.map(xf);ka.warn(`Firestore (${Vi}): ${t}`,...n)}}function xf(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function me(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,E_(t,r,n)}function E_(t,e,n){let r=`FIRESTORE (${Vi}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Gr(r),new Error(r)}function Re(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||E_(e,s,r)}function ge(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class X extends Ar{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class XS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(rn.UNAUTHENTICATED))}shutdown(){}}class JS{constructor(e){this.t=e,this.currentUser=rn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Re(this.o===void 0,42304);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new jr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new jr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{ee("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(ee("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new jr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ee("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Re(typeof r.accessToken=="string",31837,{l:r}),new YS(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Re(e===null||typeof e=="string",2055,{h:e}),new rn(e)}}class ZS{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=rn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class eC{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new ZS(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(rn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class dy{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class tC{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,En(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Re(this.o===void 0,3512);const r=i=>{i.error!=null&&ee("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,ee("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ee("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):ee("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new dy(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Re(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new dy(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nC(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=nC(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function Ne(t,e){return t<e?-1:t>e?1:0}function Qm(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return $d(s)===$d(i)?Ne(s,i):$d(s)?1:-1}return Ne(t.length,e.length)}const rC=55296,sC=57343;function $d(t){const e=t.charCodeAt(0);return e>=rC&&e<=sC}function Ci(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const my="__name__";class fr{constructor(e,n,r){n===void 0?n=0:n>e.length&&me(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&me(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return fr.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof fr?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=fr.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return Ne(e.length,n.length)}static compareSegments(e,n){const r=fr.isNumericId(e),s=fr.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?fr.extractNumericId(e).compare(fr.extractNumericId(n)):Qm(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Os.fromString(e.substring(4,e.length-2))}}class Me extends fr{construct(e,n,r){return new Me(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new X(j.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Me(n)}static emptyPath(){return new Me([])}}const aC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Rt extends fr{construct(e,n,r){return new Rt(e,n,r)}static isValidIdentifier(e){return aC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Rt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===my}static keyField(){return new Rt([my])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new X(j.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new X(j.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new X(j.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new X(j.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Rt(n)}static emptyPath(){return new Rt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.path=e}static fromPath(e){return new ue(Me.fromString(e))}static fromName(e){return new ue(Me.fromString(e).popFirst(5))}static empty(){return new ue(Me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Me.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ue(new Me(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __(t,e,n){if(!n)throw new X(j.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function iC(t,e,n,r){if(e===!0&&r===!0)throw new X(j.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function hy(t){if(!ue.isDocumentKey(t))throw new X(j.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function fy(t){if(ue.isDocumentKey(t))throw new X(j.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function w_(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Vu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":me(12329,{type:typeof t})}function Er(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new X(j.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Vu(t);throw new X(j.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(t,e){const n={typeString:t};return e&&(n.value=e),n}function dl(t,e){if(!w_(t))throw new X(j.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new X(j.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const py=-62135596800,gy=1e6;class je{static now(){return je.fromMillis(Date.now())}static fromDate(e){return je.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*gy);return new je(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new X(j.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new X(j.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<py)throw new X(j.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new X(j.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/gy}_compareTo(e){return this.seconds===e.seconds?Ne(this.nanoseconds,e.nanoseconds):Ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:je._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(dl(e,je._jsonSchema))return new je(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-py;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}je._jsonSchemaVersion="firestore/timestamp/1.0",je._jsonSchema={type:mt("string",je._jsonSchemaVersion),seconds:mt("number"),nanoseconds:mt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{static fromTimestamp(e){return new pe(e)}static min(){return new pe(new je(0,0))}static max(){return new pe(new je(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Go=-1;function oC(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=pe.fromTimestamp(r===1e9?new je(n+1,0):new je(n,r));return new js(s,ue.empty(),e)}function lC(t){return new js(t.readTime,t.key,Go)}class js{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new js(pe.min(),ue.empty(),Go)}static max(){return new js(pe.max(),ue.empty(),Go)}}function cC(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ue.comparator(t.documentKey,e.documentKey),n!==0?n:Ne(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class dC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oi(t){if(t.code!==j.FAILED_PRECONDITION||t.message!==uC)throw t;ee("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&me(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new z((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof z?n:z.resolve(n)}catch(n){return z.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):z.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):z.reject(n)}static resolve(e){return new z((n,r)=>{n(e)})}static reject(e){return new z((n,r)=>{r(e)})}static waitFor(e){return new z((n,r)=>{let s=0,i=0,o=!1;e.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=z.resolve(!1);for(const r of e)n=n.next(s=>s?z.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new z((r,s)=>{const i=e.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(h=>{o[d]=h,++c,c===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new z((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function mC(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Mi(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ou.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bf=-1;function Mu(t){return t==null}function Qc(t){return t===0&&1/t==-1/0}function hC(t){return typeof t=="number"&&Number.isInteger(t)&&!Qc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x_="";function fC(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=yy(e)),e=pC(t.get(n),e);return yy(e)}function pC(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case x_:n+="";break;default:n+=i}}return n}function yy(t){return t+x_+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vy(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Xs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function N_(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e,n){this.comparator=e,this.root=n||Pt.EMPTY}insert(e,n){return new Qe(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Pt.BLACK,null,null))}remove(e){return new Qe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Pt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Gl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Gl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Gl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Gl(this.root,e,this.comparator,!0)}}class Gl{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Pt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Pt.RED,this.left=s??Pt.EMPTY,this.right=i??Pt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Pt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Pt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Pt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Pt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Pt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw me(43730,{key:this.key,value:this.value});if(this.right.isRed())throw me(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw me(27949);return e+(this.isRed()?0:1)}}Pt.EMPTY=null,Pt.RED=!0,Pt.BLACK=!1;Pt.EMPTY=new class{constructor(){this.size=0}get key(){throw me(57766)}get value(){throw me(16141)}get color(){throw me(16727)}get left(){throw me(29726)}get right(){throw me(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Pt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.comparator=e,this.data=new Qe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ey(this.data.getIterator())}getIteratorFrom(e){return new Ey(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Et)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Et(this.comparator);return n.data=e,n}}class Ey{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e){this.fields=e,e.sort(Rt.comparator)}static empty(){return new wn([])}unionWith(e){let n=new Et(Rt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new wn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ci(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b_ extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new b_("Invalid base64 string: "+i):i}}(e);return new Ot(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Ot(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ot.EMPTY_BYTE_STRING=new Ot("");const gC=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bs(t){if(Re(!!t,39018),typeof t=="string"){let e=0;const n=gC.exec(t);if(Re(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:nt(t.seconds),nanos:nt(t.nanos)}}function nt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function zs(t){return typeof t=="string"?Ot.fromBase64String(t):Ot.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S_="server_timestamp",C_="__type__",I_="__previous_value__",T_="__local_write_time__";function Sf(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[C_])==null?void 0:r.stringValue)===S_}function Lu(t){const e=t.mapValue.fields[I_];return Sf(e)?Lu(e):e}function Ko(t){const e=Bs(t.mapValue.fields[T_].timestampValue);return new je(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e,n,r,s,i,o,c,u,d,h){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d,this.isUsingEmulator=h}}const Yc="(default)";class Qo{constructor(e,n){this.projectId=e,this.database=n||Yc}static empty(){return new Qo("","")}get isDefaultDatabase(){return this.database===Yc}isEqual(e){return e instanceof Qo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_="__type__",vC="__max__",Kl={mapValue:{}},k_="__vector__",Xc="value";function $s(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Sf(t)?4:_C(t)?9007199254740991:EC(t)?10:11:me(28295,{value:t})}function Ir(t,e){if(t===e)return!0;const n=$s(t);if(n!==$s(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ko(t).isEqual(Ko(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Bs(s.timestampValue),c=Bs(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return zs(s.bytesValue).isEqual(zs(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return nt(s.geoPointValue.latitude)===nt(i.geoPointValue.latitude)&&nt(s.geoPointValue.longitude)===nt(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return nt(s.integerValue)===nt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=nt(s.doubleValue),c=nt(i.doubleValue);return o===c?Qc(o)===Qc(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return Ci(t.arrayValue.values||[],e.arrayValue.values||[],Ir);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},c=i.mapValue.fields||{};if(vy(o)!==vy(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!Ir(o[u],c[u])))return!1;return!0}(t,e);default:return me(52216,{left:t})}}function Yo(t,e){return(t.values||[]).find(n=>Ir(n,e))!==void 0}function Ii(t,e){if(t===e)return 0;const n=$s(t),r=$s(e);if(n!==r)return Ne(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ne(t.booleanValue,e.booleanValue);case 2:return function(i,o){const c=nt(i.integerValue||i.doubleValue),u=nt(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return _y(t.timestampValue,e.timestampValue);case 4:return _y(Ko(t),Ko(e));case 5:return Qm(t.stringValue,e.stringValue);case 6:return function(i,o){const c=zs(i),u=zs(o);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const c=i.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const h=Ne(c[d],u[d]);if(h!==0)return h}return Ne(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const c=Ne(nt(i.latitude),nt(o.latitude));return c!==0?c:Ne(nt(i.longitude),nt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return wy(t.arrayValue,e.arrayValue);case 10:return function(i,o){var y,S,P,w;const c=i.fields||{},u=o.fields||{},d=(y=c[Xc])==null?void 0:y.arrayValue,h=(S=u[Xc])==null?void 0:S.arrayValue,p=Ne(((P=d==null?void 0:d.values)==null?void 0:P.length)||0,((w=h==null?void 0:h.values)==null?void 0:w.length)||0);return p!==0?p:wy(d,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Kl.mapValue&&o===Kl.mapValue)return 0;if(i===Kl.mapValue)return 1;if(o===Kl.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){const y=Qm(u[p],h[p]);if(y!==0)return y;const S=Ii(c[u[p]],d[h[p]]);if(S!==0)return S}return Ne(u.length,h.length)}(t.mapValue,e.mapValue);default:throw me(23264,{he:n})}}function _y(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ne(t,e);const n=Bs(t),r=Bs(e),s=Ne(n.seconds,r.seconds);return s!==0?s:Ne(n.nanos,r.nanos)}function wy(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ii(n[s],r[s]);if(i)return i}return Ne(n.length,r.length)}function Ti(t){return Ym(t)}function Ym(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Bs(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return zs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ue.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Ym(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Ym(n.fields[o])}`;return s+"}"}(t.mapValue):me(61005,{value:t})}function hc(t){switch($s(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Lu(t);return e?16+hc(e):16;case 5:return 2*t.stringValue.length;case 6:return zs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+hc(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Xs(r.fields,(i,o)=>{s+=i.length+hc(o)}),s}(t.mapValue);default:throw me(13486,{value:t})}}function xy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Xm(t){return!!t&&"integerValue"in t}function Cf(t){return!!t&&"arrayValue"in t}function Ny(t){return!!t&&"nullValue"in t}function by(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function fc(t){return!!t&&"mapValue"in t}function EC(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[A_])==null?void 0:r.stringValue)===k_}function No(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Xs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=No(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=No(t.arrayValue.values[n]);return e}return{...t}}function _C(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===vC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.value=e}static empty(){return new on({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!fc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=No(n)}setAll(e){let n=Rt.emptyPath(),r={},s=[];e.forEach((o,c)=>{if(!n.isImmediateParentOf(c)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=c.popLast()}o?r[c.lastSegment()]=No(o):s.push(c.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());fc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ir(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];fc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Xs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new on(No(this.value))}}function P_(t){const e=[];return Xs(t.fields,(n,r)=>{const s=new Rt([n]);if(fc(r)){const i=P_(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new wn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e,n,r,s,i,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(e){return new zt(e,0,pe.min(),pe.min(),pe.min(),on.empty(),0)}static newFoundDocument(e,n,r,s){return new zt(e,1,n,pe.min(),r,s,0)}static newNoDocument(e,n){return new zt(e,2,n,pe.min(),pe.min(),on.empty(),0)}static newUnknownDocument(e,n){return new zt(e,3,n,pe.min(),pe.min(),on.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=on.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=on.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof zt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new zt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,n){this.position=e,this.inclusive=n}}function Sy(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ue.comparator(ue.fromName(o.referenceValue),n.key):r=Ii(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Cy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ir(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e,n="asc"){this.field=e,this.dir=n}}function wC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{}class dt extends R_{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new NC(e,n,r):n==="array-contains"?new CC(e,r):n==="in"?new IC(e,r):n==="not-in"?new TC(e,r):n==="array-contains-any"?new AC(e,r):new dt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new bC(e,r):new SC(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ii(n,this.value)):n!==null&&$s(this.value)===$s(n)&&this.matchesComparison(Ii(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return me(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class nr extends R_{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new nr(e,n)}matches(e){return D_(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function D_(t){return t.op==="and"}function V_(t){return xC(t)&&D_(t)}function xC(t){for(const e of t.filters)if(e instanceof nr)return!1;return!0}function Jm(t){if(t instanceof dt)return t.field.canonicalString()+t.op.toString()+Ti(t.value);if(V_(t))return t.filters.map(e=>Jm(e)).join(",");{const e=t.filters.map(n=>Jm(n)).join(",");return`${t.op}(${e})`}}function O_(t,e){return t instanceof dt?function(r,s){return s instanceof dt&&r.op===s.op&&r.field.isEqual(s.field)&&Ir(r.value,s.value)}(t,e):t instanceof nr?function(r,s){return s instanceof nr&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,c)=>i&&O_(o,s.filters[c]),!0):!1}(t,e):void me(19439)}function M_(t){return t instanceof dt?function(n){return`${n.field.canonicalString()} ${n.op} ${Ti(n.value)}`}(t):t instanceof nr?function(n){return n.op.toString()+" {"+n.getFilters().map(M_).join(" ,")+"}"}(t):"Filter"}class NC extends dt{constructor(e,n,r){super(e,n,r),this.key=ue.fromName(r.referenceValue)}matches(e){const n=ue.comparator(e.key,this.key);return this.matchesComparison(n)}}class bC extends dt{constructor(e,n){super(e,"in",n),this.keys=L_("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class SC extends dt{constructor(e,n){super(e,"not-in",n),this.keys=L_("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function L_(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>ue.fromName(r.referenceValue))}class CC extends dt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Cf(n)&&Yo(n.arrayValue,this.value)}}class IC extends dt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Yo(this.value.arrayValue,n)}}class TC extends dt{constructor(e,n){super(e,"not-in",n)}matches(e){if(Yo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Yo(this.value.arrayValue,n)}}class AC extends dt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Cf(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Yo(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kC{constructor(e,n=null,r=[],s=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.Te=null}}function Iy(t,e=null,n=[],r=[],s=null,i=null,o=null){return new kC(t,e,n,r,s,i,o)}function If(t){const e=ge(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Jm(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Mu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ti(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ti(r)).join(",")),e.Te=n}return e.Te}function Tf(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!wC(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!O_(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Cy(t.startAt,e.startAt)&&Cy(t.endAt,e.endAt)}function Zm(t){return ue.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e,n=null,r=[],s=[],i=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function PC(t,e,n,r,s,i,o,c){return new Li(t,e,n,r,s,i,o,c)}function Fu(t){return new Li(t)}function Ty(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function F_(t){return t.collectionGroup!==null}function bo(t){const e=ge(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Et(Rt.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Xo(i,r))}),n.has(Rt.keyField().canonicalString())||e.Ie.push(new Xo(Rt.keyField(),r))}return e.Ie}function _r(t){const e=ge(t);return e.Ee||(e.Ee=RC(e,bo(t))),e.Ee}function RC(t,e){if(t.limitType==="F")return Iy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Xo(s.field,i)});const n=t.endAt?new Jc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Jc(t.startAt.position,t.startAt.inclusive):null;return Iy(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function eh(t,e){const n=t.filters.concat([e]);return new Li(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function th(t,e,n){return new Li(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Uu(t,e){return Tf(_r(t),_r(e))&&t.limitType===e.limitType}function U_(t){return`${If(_r(t))}|lt:${t.limitType}`}function Wa(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>M_(s)).join(", ")}]`),Mu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Ti(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Ti(s)).join(",")),`Target(${r})`}(_r(t))}; limitType=${t.limitType})`}function ju(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ue.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of bo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,c,u){const d=Sy(o,c,u);return o.inclusive?d<=0:d<0}(r.startAt,bo(r),s)||r.endAt&&!function(o,c,u){const d=Sy(o,c,u);return o.inclusive?d>=0:d>0}(r.endAt,bo(r),s))}(t,e)}function DC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function j_(t){return(e,n)=>{let r=!1;for(const s of bo(t)){const i=VC(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function VC(t,e,n){const r=t.field.isKeyField()?ue.comparator(e.key,n.key):function(i,o,c){const u=o.data.field(i),d=c.data.field(i);return u!==null&&d!==null?Ii(u,d):me(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return me(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Xs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return N_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OC=new Qe(ue.comparator);function Kr(){return OC}const B_=new Qe(ue.comparator);function co(...t){let e=B_;for(const n of t)e=e.insert(n.key,n);return e}function z_(t){let e=B_;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function va(){return So()}function $_(){return So()}function So(){return new Fa(t=>t.toString(),(t,e)=>t.isEqual(e))}const MC=new Qe(ue.comparator),LC=new Et(ue.comparator);function be(...t){let e=LC;for(const n of t)e=e.add(n);return e}const FC=new Et(Ne);function UC(){return FC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Af(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qc(e)?"-0":e}}function H_(t){return{integerValue:""+t}}function jC(t,e){return hC(e)?H_(e):Af(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(){this._=void 0}}function BC(t,e,n){return t instanceof Jo?function(s,i){const o={fields:{[C_]:{stringValue:S_},[T_]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Sf(i)&&(i=Lu(i)),i&&(o.fields[I_]=i),{mapValue:o}}(n,e):t instanceof Zo?W_(t,e):t instanceof el?G_(t,e):function(s,i){const o=q_(s,i),c=Ay(o)+Ay(s.Ae);return Xm(o)&&Xm(s.Ae)?H_(c):Af(s.serializer,c)}(t,e)}function zC(t,e,n){return t instanceof Zo?W_(t,e):t instanceof el?G_(t,e):n}function q_(t,e){return t instanceof Zc?function(r){return Xm(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Jo extends Bu{}class Zo extends Bu{constructor(e){super(),this.elements=e}}function W_(t,e){const n=K_(e);for(const r of t.elements)n.some(s=>Ir(s,r))||n.push(r);return{arrayValue:{values:n}}}class el extends Bu{constructor(e){super(),this.elements=e}}function G_(t,e){let n=K_(e);for(const r of t.elements)n=n.filter(s=>!Ir(s,r));return{arrayValue:{values:n}}}class Zc extends Bu{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Ay(t){return nt(t.integerValue||t.doubleValue)}function K_(t){return Cf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $C{constructor(e,n){this.field=e,this.transform=n}}function HC(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Zo&&s instanceof Zo||r instanceof el&&s instanceof el?Ci(r.elements,s.elements,Ir):r instanceof Zc&&s instanceof Zc?Ir(r.Ae,s.Ae):r instanceof Jo&&s instanceof Jo}(t.transform,e.transform)}class qC{constructor(e,n){this.version=e,this.transformResults=n}}class wr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new wr}static exists(e){return new wr(void 0,e)}static updateTime(e){return new wr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function pc(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class zu{}function Q_(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new X_(t.key,wr.none()):new ml(t.key,t.data,wr.none());{const n=t.data,r=on.empty();let s=new Et(Rt.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Js(t.key,r,new wn(s.toArray()),wr.none())}}function WC(t,e,n){t instanceof ml?function(s,i,o){const c=s.value.clone(),u=Py(s.fieldTransforms,i,o.transformResults);c.setAll(u),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):t instanceof Js?function(s,i,o){if(!pc(s.precondition,i))return void i.convertToUnknownDocument(o.version);const c=Py(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(Y_(s)),u.setAll(c),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Co(t,e,n,r){return t instanceof ml?function(i,o,c,u){if(!pc(i.precondition,o))return c;const d=i.value.clone(),h=Ry(i.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Js?function(i,o,c,u){if(!pc(i.precondition,o))return c;const d=Ry(i.fieldTransforms,u,o),h=o.data;return h.setAll(Y_(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(i,o,c){return pc(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,n)}function GC(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=q_(r.transform,s||null);i!=null&&(n===null&&(n=on.empty()),n.set(r.field,i))}return n||null}function ky(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ci(r,s,(i,o)=>HC(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ml extends zu{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Js extends zu{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Y_(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Py(t,e,n){const r=new Map;Re(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,c=e.data.field(i.field);r.set(i.field,zC(o,c,n[s]))}return r}function Ry(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,BC(i,o,e))}return r}class X_ extends zu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class KC extends zu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&WC(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Co(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Co(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=$_();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=n.has(s.key)?null:c;const u=Q_(o,c);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(pe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),be())}isEqual(e){return this.batchId===e.batchId&&Ci(this.mutations,e.mutations,(n,r)=>ky(n,r))&&Ci(this.baseMutations,e.baseMutations,(n,r)=>ky(n,r))}}class kf{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Re(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return MC}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new kf(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ct,Ie;function JC(t){switch(t){case j.OK:return me(64938);case j.CANCELLED:case j.UNKNOWN:case j.DEADLINE_EXCEEDED:case j.RESOURCE_EXHAUSTED:case j.INTERNAL:case j.UNAVAILABLE:case j.UNAUTHENTICATED:return!1;case j.INVALID_ARGUMENT:case j.NOT_FOUND:case j.ALREADY_EXISTS:case j.PERMISSION_DENIED:case j.FAILED_PRECONDITION:case j.ABORTED:case j.OUT_OF_RANGE:case j.UNIMPLEMENTED:case j.DATA_LOSS:return!0;default:return me(15467,{code:t})}}function J_(t){if(t===void 0)return Gr("GRPC error has no .code"),j.UNKNOWN;switch(t){case ct.OK:return j.OK;case ct.CANCELLED:return j.CANCELLED;case ct.UNKNOWN:return j.UNKNOWN;case ct.DEADLINE_EXCEEDED:return j.DEADLINE_EXCEEDED;case ct.RESOURCE_EXHAUSTED:return j.RESOURCE_EXHAUSTED;case ct.INTERNAL:return j.INTERNAL;case ct.UNAVAILABLE:return j.UNAVAILABLE;case ct.UNAUTHENTICATED:return j.UNAUTHENTICATED;case ct.INVALID_ARGUMENT:return j.INVALID_ARGUMENT;case ct.NOT_FOUND:return j.NOT_FOUND;case ct.ALREADY_EXISTS:return j.ALREADY_EXISTS;case ct.PERMISSION_DENIED:return j.PERMISSION_DENIED;case ct.FAILED_PRECONDITION:return j.FAILED_PRECONDITION;case ct.ABORTED:return j.ABORTED;case ct.OUT_OF_RANGE:return j.OUT_OF_RANGE;case ct.UNIMPLEMENTED:return j.UNIMPLEMENTED;case ct.DATA_LOSS:return j.DATA_LOSS;default:return me(39323,{code:t})}}(Ie=ct||(ct={}))[Ie.OK=0]="OK",Ie[Ie.CANCELLED=1]="CANCELLED",Ie[Ie.UNKNOWN=2]="UNKNOWN",Ie[Ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ie[Ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ie[Ie.NOT_FOUND=5]="NOT_FOUND",Ie[Ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ie[Ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ie[Ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ie[Ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ie[Ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ie[Ie.ABORTED=10]="ABORTED",Ie[Ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ie[Ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ie[Ie.INTERNAL=13]="INTERNAL",Ie[Ie.UNAVAILABLE=14]="UNAVAILABLE",Ie[Ie.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZC(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI=new Os([4294967295,4294967295],0);function Dy(t){const e=ZC().encode(t),n=new h_;return n.update(e),new Uint8Array(n.digest())}function Vy(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Os([n,r],0),new Os([s,i],0)]}class Pf{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new uo(`Invalid padding: ${n}`);if(r<0)throw new uo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new uo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new uo(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Os.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Os.fromNumber(r)));return s.compare(eI)===1&&(s=new Os([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=Dy(e),[r,s]=Vy(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Pf(i,s,n);return r.forEach(c=>o.insert(c)),o}insert(e){if(this.ge===0)return;const n=Dy(e),[r,s]=Vy(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class uo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,hl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new $u(pe.min(),s,new Qe(Ne),Kr(),be())}}class hl{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new hl(r,n,be(),be(),be())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc{constructor(e,n,r,s){this.be=e,this.removedTargetIds=n,this.key=r,this.De=s}}class Z_{constructor(e,n){this.targetId=e,this.Ce=n}}class ew{constructor(e,n,r=Ot.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Oy{constructor(){this.ve=0,this.Fe=My(),this.Me=Ot.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=be(),n=be(),r=be();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:me(38017,{changeType:i})}}),new hl(this.Me,this.xe,e,n,r)}qe(){this.Oe=!1,this.Fe=My()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Re(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class tI{constructor(e){this.Ge=e,this.ze=new Map,this.je=Kr(),this.Je=Ql(),this.He=Ql(),this.Ye=new Qe(Ne)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:me(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(Zm(i))if(r===0){const o=new ue(i.path);this.et(n,o,zt.newNoDocument(o,pe.min()))}else Re(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,c;try{o=zs(r).toUint8Array()}catch(u){if(u instanceof b_)return Wo("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new Pf(o,s,i)}catch(u){return Wo(u instanceof uo?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const c=this.ot(o);if(c){if(i.current&&Zm(c.target)){const u=new ue(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,zt.newNoDocument(u,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let r=be();this.He.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const d=this.ot(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new $u(e,n,this.Ye,this.je,r);return this.je=Kr(),this.Je=Ql(),this.He=Ql(),this.Ye=new Qe(Ne),s}Xe(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,r),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.Qe(n,1):s.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Oy,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Et(Ne),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Et(Ne),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||ee("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Oy),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Ql(){return new Qe(ue.comparator)}function My(){return new Qe(ue.comparator)}const nI={asc:"ASCENDING",desc:"DESCENDING"},rI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},sI={and:"AND",or:"OR"};class aI{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function nh(t,e){return t.useProto3Json||Mu(e)?e:{value:e}}function eu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function tw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function iI(t,e){return eu(t,e.toTimestamp())}function xr(t){return Re(!!t,49232),pe.fromTimestamp(function(n){const r=Bs(n);return new je(r.seconds,r.nanos)}(t))}function Rf(t,e){return rh(t,e).canonicalString()}function rh(t,e){const n=function(s){return new Me(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function nw(t){const e=Me.fromString(t);return Re(ow(e),10190,{key:e.toString()}),e}function sh(t,e){return Rf(t.databaseId,e.path)}function Hd(t,e){const n=nw(e);if(n.get(1)!==t.databaseId.projectId)throw new X(j.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new X(j.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ue(sw(n))}function rw(t,e){return Rf(t.databaseId,e)}function oI(t){const e=nw(t);return e.length===4?Me.emptyPath():sw(e)}function ah(t){return new Me(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function sw(t){return Re(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Ly(t,e,n){return{name:sh(t,e),fields:n.value.mapValue.fields}}function lI(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:me(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(Re(h===void 0||typeof h=="string",58123),Ot.fromBase64String(h||"")):(Re(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Ot.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(d){const h=d.code===void 0?j.UNKNOWN:J_(d.code);return new X(h,d.message||"")}(o);n=new ew(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Hd(t,r.document.name),i=xr(r.document.updateTime),o=r.document.createTime?xr(r.document.createTime):pe.min(),c=new on({mapValue:{fields:r.document.fields}}),u=zt.newFoundDocument(s,i,o,c),d=r.targetIds||[],h=r.removedTargetIds||[];n=new gc(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Hd(t,r.document),i=r.readTime?xr(r.readTime):pe.min(),o=zt.newNoDocument(s,i),c=r.removedTargetIds||[];n=new gc([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Hd(t,r.document),i=r.removedTargetIds||[];n=new gc([],i,s,null)}else{if(!("filter"in e))return me(11601,{Rt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new XC(s,i),c=r.targetId;n=new Z_(c,o)}}return n}function cI(t,e){let n;if(e instanceof ml)n={update:Ly(t,e.key,e.value)};else if(e instanceof X_)n={delete:sh(t,e.key)};else if(e instanceof Js)n={update:Ly(t,e.key,e.data),updateMask:vI(e.fieldMask)};else{if(!(e instanceof KC))return me(16599,{Vt:e.type});n={verify:sh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const c=o.transform;if(c instanceof Jo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Zo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof el)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Zc)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw me(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:iI(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:me(27497)}(t,e.precondition)),n}function uI(t,e){return t&&t.length>0?(Re(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?xr(s.updateTime):xr(i);return o.isEqual(pe.min())&&(o=xr(i)),new qC(o,s.transformResults||[])}(n,e))):[]}function dI(t,e){return{documents:[rw(t,e.path)]}}function mI(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=rw(t,s);const i=function(d){if(d.length!==0)return iw(nr.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(y){return{field:Ga(y.field),direction:pI(y.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=nh(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function hI(t){let e=oI(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Re(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(p){const y=aw(p);return y instanceof nr&&V_(y)?y.getFilters():[y]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(y=>function(P){return new Xo(Ka(P.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(P.direction))}(y))}(n.orderBy));let c=null;n.limit&&(c=function(p){let y;return y=typeof p=="object"?p.value:p,Mu(y)?null:y}(n.limit));let u=null;n.startAt&&(u=function(p){const y=!!p.before,S=p.values||[];return new Jc(S,y)}(n.startAt));let d=null;return n.endAt&&(d=function(p){const y=!p.before,S=p.values||[];return new Jc(S,y)}(n.endAt)),PC(e,s,o,i,c,"F",u,d)}function fI(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return me(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function aw(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ka(n.unaryFilter.field);return dt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ka(n.unaryFilter.field);return dt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ka(n.unaryFilter.field);return dt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ka(n.unaryFilter.field);return dt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return me(61313);default:return me(60726)}}(t):t.fieldFilter!==void 0?function(n){return dt.create(Ka(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return me(58110);default:return me(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return nr.create(n.compositeFilter.filters.map(r=>aw(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return me(1026)}}(n.compositeFilter.op))}(t):me(30097,{filter:t})}function pI(t){return nI[t]}function gI(t){return rI[t]}function yI(t){return sI[t]}function Ga(t){return{fieldPath:t.canonicalString()}}function Ka(t){return Rt.fromServerFormat(t.fieldPath)}function iw(t){return t instanceof dt?function(n){if(n.op==="=="){if(by(n.value))return{unaryFilter:{field:Ga(n.field),op:"IS_NAN"}};if(Ny(n.value))return{unaryFilter:{field:Ga(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(by(n.value))return{unaryFilter:{field:Ga(n.field),op:"IS_NOT_NAN"}};if(Ny(n.value))return{unaryFilter:{field:Ga(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ga(n.field),op:gI(n.op),value:n.value}}}(t):t instanceof nr?function(n){const r=n.getFilters().map(s=>iw(s));return r.length===1?r[0]:{compositeFilter:{op:yI(n.op),filters:r}}}(t):me(54877,{filter:t})}function vI(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function ow(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e,n,r,s,i=pe.min(),o=pe.min(),c=Ot.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new bs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new bs(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new bs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new bs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EI{constructor(e){this.yt=e}}function _I(t){const e=hI({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?th(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{constructor(){this.Cn=new xI}addToCollectionParentIndex(e,n){return this.Cn.add(n),z.resolve()}getCollectionParents(e,n){return z.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return z.resolve()}deleteFieldIndex(e,n){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,n){return z.resolve()}getDocumentsMatchingTarget(e,n){return z.resolve(null)}getIndexType(e,n){return z.resolve(0)}getFieldIndexes(e,n){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,n){return z.resolve(js.min())}getMinOffsetFromCollectionGroup(e,n){return z.resolve(js.min())}updateCollectionGroup(e,n,r){return z.resolve()}updateIndexEntries(e,n){return z.resolve()}}class xI{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Et(Me.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Et(Me.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fy={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},lw=41943040;class sn{static withCacheSize(e){return new sn(e,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sn.DEFAULT_COLLECTION_PERCENTILE=10,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,sn.DEFAULT=new sn(lw,sn.DEFAULT_COLLECTION_PERCENTILE,sn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),sn.DISABLED=new sn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ai(0)}static cr(){return new Ai(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uy="LruGarbageCollector",cw=1048576;function jy([t,e],[n,r]){const s=Ne(t,n);return s===0?Ne(e,r):s}class NI{constructor(e){this.Ir=e,this.buffer=new Et(jy),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();jy(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class bI{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ee(Uy,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Mi(n)?ee(Uy,"Ignoring IndexedDB error during garbage collection: ",n):await Oi(n)}await this.Vr(3e5)})}}class SI{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return z.resolve(Ou.ce);const r=new NI(n);return this.mr.forEachTarget(e,s=>r.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>r.Ar(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.mr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ee("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(Fy)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ee("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Fy):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let r,s,i,o,c,u,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(ee("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),s=this.params.maximumSequenceNumbersToCollect):s=p,o=Date.now(),this.nthSequenceNumber(e,s))).next(p=>(r=p,c=Date.now(),this.removeTargets(e,r,n))).next(p=>(i=p,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(d=Date.now(),qa()<=xe.DEBUG&&ee("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(c-o)+`ms
	Removed ${i} targets in `+(u-c)+`ms
	Removed ${p} documents in `+(d-u)+`ms
Total Duration: ${d-h}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:p})))}}function CI(t,e){return new SI(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(){this.changes=new Fa(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,zt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?z.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TI{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AI{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Co(r.mutation,s,wn.empty(),je.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,be()).next(()=>r))}getLocalViewOfDocuments(e,n,r=be()){const s=va();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=co();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=va();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,be()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,c)=>{n.set(o,c)})})}computeViews(e,n,r,s){let i=Kr();const o=So(),c=function(){return So()}();return n.forEach((u,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof Js)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Co(h.mutation,d,h.mutation.getFieldMask(),je.now())):o.set(d.key,wn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>c.set(d,new TI(h,o.get(d)??null))),c))}recalculateAndSaveOverlays(e,n){const r=So();let s=new Qe((o,c)=>o-c),i=be();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const c of o)c.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let h=r.get(u)||wn.empty();h=c.applyToLocalView(d,h),r.set(u,h);const p=(s.get(c.batchId)||be()).add(u);s=s.insert(c.batchId,p)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,h=u.value,p=$_();h.forEach(y=>{if(!i.has(y)){const S=Q_(n.get(y),r.get(y));S!==null&&p.set(y,S),i=i.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return z.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return ue.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):F_(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):z.resolve(va());let c=Go,u=i;return o.next(d=>z.forEach(d,(h,p)=>(c<p.largestBatchId&&(c=p.largestBatchId),i.get(h)?z.resolve():this.remoteDocumentCache.getEntry(e,h).next(y=>{u=u.insert(h,y)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,be())).next(h=>({batchId:c,changes:z_(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ue(n)).next(r=>{let s=co();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=co();return this.indexManager.getCollectionParents(e,i).next(c=>z.forEach(c,u=>{const d=function(p,y){return new Li(y,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((p,y)=>{o=o.insert(p,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,zt.newInvalidDocument(h)))});let c=co();return o.forEach((u,d)=>{const h=i.get(u);h!==void 0&&Co(h.mutation,d,wn.empty(),je.now()),ju(n,d)&&(c=c.insert(u,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return z.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:xr(s.createTime)}}(n)),z.resolve()}getNamedQuery(e,n){return z.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(s){return{name:s.name,query:_I(s.bundledQuery),readTime:xr(s.readTime)}}(n)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(){this.overlays=new Qe(ue.comparator),this.qr=new Map}getOverlay(e,n){return z.resolve(this.overlays.get(n))}getOverlays(e,n){const r=va();return z.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.St(e,n,i)}),z.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(r)),z.resolve()}getOverlaysForCollection(e,n,r){const s=va(),i=n.length+1,o=new ue(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return z.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Qe((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=va(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const c=va(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,h)=>c.set(d,h)),!(c.size()>=s)););return z.resolve(c)}St(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(r.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new YC(n,r));let i=this.qr.get(n);i===void 0&&(i=be(),this.qr.set(n,i)),this.qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(){this.sessionToken=Ot.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(){this.Qr=new Et(St.$r),this.Ur=new Et(St.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const r=new St(e,n);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Gr(new St(e,n))}zr(e,n){e.forEach(r=>this.removeReference(r,n))}jr(e){const n=new ue(new Me([])),r=new St(n,e),s=new St(n,e+1),i=[];return this.Ur.forEachInRange([r,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new ue(new Me([])),r=new St(n,e),s=new St(n,e+1);let i=be();return this.Ur.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new St(e,0),r=this.Qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class St{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return ue.comparator(e.key,n.key)||Ne(e.Yr,n.Yr)}static Kr(e,n){return Ne(e.Yr,n.Yr)||ue.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Et(St.$r)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new QC(i,n,r,s);this.mutationQueue.push(o);for(const c of s)this.Zr=this.Zr.add(new St(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return z.resolve(o)}lookupMutationBatch(e,n){return z.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ei(r),i=s<0?0:s;return z.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?bf:this.tr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new St(n,0),s=new St(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([r,s],o=>{const c=this.Xr(o.Yr);i.push(c)}),z.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Et(Ne);return n.forEach(s=>{const i=new St(s,0),o=new St(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],c=>{r=r.add(c.Yr)})}),z.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ue.isDocumentKey(i)||(i=i.child(""));const o=new St(new ue(i),0);let c=new Et(Ne);return this.Zr.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(c=c.add(u.Yr)),!0)},o),z.resolve(this.ti(c))}ti(e){const n=[];return e.forEach(r=>{const s=this.Xr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Re(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return z.forEach(n.mutations,s=>{const i=new St(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,n){const r=new St(n,0),s=this.Zr.firstAfterOrEqual(r);return z.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e){this.ri=e,this.docs=function(){return new Qe(ue.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ri(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return z.resolve(r?r.document.mutableCopy():zt.newInvalidDocument(n))}getEntries(e,n){let r=Kr();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():zt.newInvalidDocument(s))}),z.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Kr();const o=n.path,c=new ue(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||cC(lC(h),r)<=0||(s.has(h.key)||ju(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return z.resolve(i)}getAllFromCollectionGroup(e,n,r,s){me(9500)}ii(e,n){return z.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new OI(this)}getSize(e){return z.resolve(this.size)}}class OI extends II{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(r)}),z.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MI{constructor(e){this.persistence=e,this.si=new Fa(n=>If(n),Tf),this.lastRemoteSnapshotVersion=pe.min(),this.highestTargetId=0,this.oi=0,this._i=new Df,this.targetCount=0,this.ai=Ai.ur()}forEachTarget(e,n){return this.si.forEach((r,s)=>n(s)),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.oi&&(this.oi=n),z.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Ai(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,z.resolve()}updateTargetData(e,n){return this.Pr(n),z.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.si.forEach((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),z.waitFor(i).next(()=>s)}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,n){const r=this.si.get(n)||null;return z.resolve(r)}addMatchingKeys(e,n,r){return this._i.Wr(n,r),z.resolve()}removeMatchingKeys(e,n,r){this._i.zr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),z.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),z.resolve()}getMatchingKeysForTargetId(e,n){const r=this._i.Hr(n);return z.resolve(r)}containsKey(e,n){return z.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{constructor(e,n){this.ui={},this.overlays={},this.ci=new Ou(0),this.li=!1,this.li=!0,this.hi=new RI,this.referenceDelegate=e(this),this.Pi=new MI(this),this.indexManager=new wI,this.remoteDocumentCache=function(s){return new VI(s)}(r=>this.referenceDelegate.Ti(r)),this.serializer=new EI(n),this.Ii=new kI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new PI,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ui[e.toKey()];return r||(r=new DI(n,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,r){ee("MemoryPersistence","Starting transaction:",e);const s=new LI(this.ci.next());return this.referenceDelegate.Ei(),r(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,n){return z.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,n)))}}class LI extends dC{constructor(e){super(),this.currentSequenceNumber=e}}class Vf{constructor(e){this.persistence=e,this.Ri=new Df,this.Vi=null}static mi(e){return new Vf(e)}get fi(){if(this.Vi)return this.Vi;throw me(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.fi.delete(r.toString()),z.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.fi.add(r.toString()),z.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),z.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(s=>this.fi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.fi,r=>{const s=ue.fromPath(r);return this.gi(e,s).next(i=>{i||n.removeEntry(s,pe.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(r=>{r?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return z.or([()=>z.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class tu{constructor(e,n){this.persistence=e,this.pi=new Fa(r=>fC(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=CI(this,n)}static mi(e,n){return new tu(e,n)}Ei(){}di(e){return z.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}wr(e){let n=0;return this.pr(e,r=>{n++}).next(()=>n)}pr(e,n){return z.forEach(this.pi,(r,s)=>this.br(e,r,s).next(i=>i?z.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,n).next(c=>{c||(r++,i.removeEntry(o,pe.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),z.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),z.resolve()}removeReference(e,n,r){return this.pi.set(r,e.currentSequenceNumber),z.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),z.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=hc(e.data.value)),n}br(e,n,r){return z.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.pi.get(n);return z.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Es=r,this.ds=s}static As(e,n){let r=be(),s=be();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Of(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FI{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UI{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return R1()?8:mC(Ht())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new FI;return this.Ss(e,n,o).next(c=>{if(i.result=c,this.Vs)return this.bs(e,n,o,c.size)})}).next(()=>i.result)}bs(e,n,r,s){return r.documentReadCount<this.fs?(qa()<=xe.DEBUG&&ee("QueryEngine","SDK will not create cache indexes for query:",Wa(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),z.resolve()):(qa()<=xe.DEBUG&&ee("QueryEngine","Query:",Wa(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.gs*s?(qa()<=xe.DEBUG&&ee("QueryEngine","The SDK decides to create cache indexes for query:",Wa(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,_r(n))):z.resolve())}ys(e,n){if(Ty(n))return z.resolve(null);let r=_r(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=th(n,null,"F"),r=_r(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=be(...i);return this.ps.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.Ds(n,c);return this.Cs(n,d,o,u.readTime)?this.ys(e,th(n,null,"F")):this.vs(e,d,n,u)}))})))}ws(e,n,r,s){return Ty(n)||s.isEqual(pe.min())?z.resolve(null):this.ps.getDocuments(e,r).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,r,s)?z.resolve(null):(qa()<=xe.DEBUG&&ee("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Wa(n)),this.vs(e,o,n,oC(s,Go)).next(c=>c))})}Ds(e,n){let r=new Et(j_(e));return n.forEach((s,i)=>{ju(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,n,r){return qa()<=xe.DEBUG&&ee("QueryEngine","Using full collection scan to execute query:",Wa(n)),this.ps.getDocumentsMatchingQuery(e,n,js.min(),r)}vs(e,n,r,s){return this.ps.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mf="LocalStore",jI=3e8;class BI{constructor(e,n,r,s){this.persistence=e,this.Fs=n,this.serializer=s,this.Ms=new Qe(Ne),this.xs=new Fa(i=>If(i),Tf),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new AI(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function zI(t,e,n,r){return new BI(t,e,n,r)}async function dw(t,e){const n=ge(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],c=[];let u=be();for(const d of s){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of i){c.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return n.localDocuments.getDocuments(r,u).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:c}))})})}function $I(t,e){const n=ge(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(c,u,d,h){const p=d.batch,y=p.keys();let S=z.resolve();return y.forEach(P=>{S=S.next(()=>h.getEntry(u,P)).next(w=>{const A=d.docVersions.get(P);Re(A!==null,48541),w.version.compareTo(A)<0&&(p.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),h.addEntry(w)))})}),S.next(()=>c.mutationQueue.removeMutationBatch(u,p))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=be();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function mw(t){const e=ge(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function HI(t,e){const n=ge(t),r=e.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const c=[];e.targetChanges.forEach((h,p)=>{const y=s.get(p);if(!y)return;c.push(n.Pi.removeMatchingKeys(i,h.removedDocuments,p).next(()=>n.Pi.addMatchingKeys(i,h.addedDocuments,p)));let S=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(p)!==null?S=S.withResumeToken(Ot.EMPTY_BYTE_STRING,pe.min()).withLastLimboFreeSnapshotVersion(pe.min()):h.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(h.resumeToken,r)),s=s.insert(p,S),function(w,A,_){return w.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=jI?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(y,S,h)&&c.push(n.Pi.updateTargetData(i,S))});let u=Kr(),d=be();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),c.push(qI(i,o,e.documentUpdates).next(h=>{u=h.ks,d=h.qs})),!r.isEqual(pe.min())){const h=n.Pi.getLastRemoteSnapshotVersion(i).next(p=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,r));c.push(h)}return z.waitFor(c).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.Ms=s,i))}function qI(t,e,n){let r=be(),s=be();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Kr();return n.forEach((c,u)=>{const d=i.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(pe.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):ee(Mf,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{ks:o,qs:s}})}function WI(t,e){const n=ge(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=bf),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function GI(t,e){const n=ge(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Pi.getTargetData(r,e).next(i=>i?(s=i,z.resolve(s)):n.Pi.allocateTargetId(r).next(o=>(s=new bs(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Pi.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ms.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(r.targetId,r),n.xs.set(e,r.targetId)),r})}async function ih(t,e,n){const r=ge(t),s=r.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Mi(o))throw o;ee(Mf,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(s.target)}function By(t,e,n){const r=ge(t);let s=pe.min(),i=be();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,h){const p=ge(u),y=p.xs.get(h);return y!==void 0?z.resolve(p.Ms.get(y)):p.Pi.getTargetData(d,h)}(r,o,_r(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,n?s:pe.min(),n?i:be())).next(c=>(KI(r,DC(e),c),{documents:c,Qs:i})))}function KI(t,e,n){let r=t.Os.get(e)||pe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Os.set(e,r)}class zy{constructor(){this.activeTargetIds=UC()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class QI{constructor(){this.Mo=new zy,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,r){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new zy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $y="ConnectivityMonitor";class Hy{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ee($y,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ee($y,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yl=null;function oh(){return Yl===null?Yl=function(){return 268435456+Math.round(2147483648*Math.random())}():Yl++,"0x"+Yl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qd="RestConnection",XI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class JI{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${r}/databases/${s}`,this.Wo=this.databaseId.database===Yc?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Go(e,n,r,s,i){const o=oh(),c=this.zo(e,n.toUriEncodedString());ee(qd,`Sending RPC '${e}' ${o}:`,c,r);const u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,s,i);const{host:d}=new URL(c),h=Ma(d);return this.Jo(e,c,u,r,h).then(p=>(ee(qd,`Received RPC '${e}' ${o}: `,p),p),p=>{throw Wo(qd,`RPC '${e}' ${o} failed with error: `,p,"url: ",c,"request:",r),p})}Ho(e,n,r,s,i,o){return this.Go(e,n,r,s,i)}jo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Vi}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}zo(e,n){const r=XI[e];return`${this.Uo}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jt="WebChannelConnection";class eT extends JI{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=oh();return new Promise((c,u)=>{const d=new f_;d.setWithCredentials(!0),d.listenOnce(p_.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case mc.NO_ERROR:const p=d.getResponseJson();ee(jt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),c(p);break;case mc.TIMEOUT:ee(jt,`RPC '${e}' ${o} timed out`),u(new X(j.DEADLINE_EXCEEDED,"Request time out"));break;case mc.HTTP_ERROR:const y=d.getStatus();if(ee(jt,`RPC '${e}' ${o} failed with status:`,y,"response text:",d.getResponseText()),y>0){let S=d.getResponseJson();Array.isArray(S)&&(S=S[0]);const P=S==null?void 0:S.error;if(P&&P.status&&P.message){const w=function(_){const v=_.toLowerCase().replace(/_/g,"-");return Object.values(j).indexOf(v)>=0?v:j.UNKNOWN}(P.status);u(new X(w,P.message))}else u(new X(j.UNKNOWN,"Server responded with status "+d.getStatus()))}else u(new X(j.UNAVAILABLE,"Connection failed."));break;default:me(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{ee(jt,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);ee(jt,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}T_(e,n,r){const s=oh(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=v_(),c=y_(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const h=i.join("");ee(jt,`Creating RPC '${e}' stream ${s}: ${h}`,u);const p=o.createWebChannel(h,u);this.I_(p);let y=!1,S=!1;const P=new ZI({Yo:A=>{S?ee(jt,`Not sending because RPC '${e}' stream ${s} is closed:`,A):(y||(ee(jt,`Opening RPC '${e}' stream ${s} transport.`),p.open(),y=!0),ee(jt,`RPC '${e}' stream ${s} sending:`,A),p.send(A))},Zo:()=>p.close()}),w=(A,_,v)=>{A.listen(_,I=>{try{v(I)}catch(D){setTimeout(()=>{throw D},0)}})};return w(p,lo.EventType.OPEN,()=>{S||(ee(jt,`RPC '${e}' stream ${s} transport opened.`),P.o_())}),w(p,lo.EventType.CLOSE,()=>{S||(S=!0,ee(jt,`RPC '${e}' stream ${s} transport closed`),P.a_(),this.E_(p))}),w(p,lo.EventType.ERROR,A=>{S||(S=!0,Wo(jt,`RPC '${e}' stream ${s} transport errored. Name:`,A.name,"Message:",A.message),P.a_(new X(j.UNAVAILABLE,"The operation could not be completed")))}),w(p,lo.EventType.MESSAGE,A=>{var _;if(!S){const v=A.data[0];Re(!!v,16349);const I=v,D=(I==null?void 0:I.error)||((_=I[0])==null?void 0:_.error);if(D){ee(jt,`RPC '${e}' stream ${s} received error:`,D);const M=D.status;let V=function(x){const T=ct[x];if(T!==void 0)return J_(T)}(M),b=D.message;V===void 0&&(V=j.INTERNAL,b="Unknown error status: "+M+" with message "+D.message),S=!0,P.a_(new X(V,b)),p.close()}else ee(jt,`RPC '${e}' stream ${s} received:`,v),P.u_(v)}}),w(c,g_.STAT_EVENT,A=>{A.stat===Km.PROXY?ee(jt,`RPC '${e}' stream ${s} detected buffering proxy`):A.stat===Km.NOPROXY&&ee(jt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{P.__()},0),P}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function Wd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(t){return new aI(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=r,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&ee("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qy="PersistentStream";class fw{constructor(e,n,r,s,i,o,c,u){this.Mi=e,this.S_=r,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new hw(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===j.RESOURCE_EXHAUSTED?(Gr(n.toString()),Gr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===j.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new X(j.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ee(qy,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(ee(qy,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class tT extends fw{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=lI(this.serializer,e),r=function(i){if(!("targetChange"in i))return pe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?pe.min():o.readTime?xr(o.readTime):pe.min()}(e);return this.listener.H_(n,r)}Y_(e){const n={};n.database=ah(this.serializer),n.addTarget=function(i,o){let c;const u=o.target;if(c=Zm(u)?{documents:dI(i,u)}:{query:mI(i,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=tw(i,o.resumeToken);const d=nh(i,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(pe.min())>0){c.readTime=eu(i,o.snapshotVersion.toTimestamp());const d=nh(i,o.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const r=fI(this.serializer,e);r&&(n.labels=r),this.q_(n)}Z_(e){const n={};n.database=ah(this.serializer),n.removeTarget=e,this.q_(n)}}class nT extends fw{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return Re(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Re(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Re(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=uI(e.writeResults,e.commitTime),r=xr(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=ah(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>cI(this.serializer,r))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{}class sT extends rT{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new X(j.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,rh(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===j.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new X(j.UNKNOWN,i.toString())})}Ho(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Ho(e,rh(n,r),s,o,c,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===j.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new X(j.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class aT{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Gr(n),this.aa=!1):ee("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pa="RemoteStore";class iT{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{Ua(this)&&(ee(Pa,"Restarting streams for network reachability change."),await async function(u){const d=ge(u);d.Ea.add(4),await fl(d),d.Ra.set("Unknown"),d.Ea.delete(4),await qu(d)}(this))})}),this.Ra=new aT(r,s)}}async function qu(t){if(Ua(t))for(const e of t.da)await e(!0)}async function fl(t){for(const e of t.da)await e(!1)}function pw(t,e){const n=ge(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),jf(n)?Uf(n):Fi(n).O_()&&Ff(n,e))}function Lf(t,e){const n=ge(t),r=Fi(n);n.Ia.delete(e),r.O_()&&gw(n,e),n.Ia.size===0&&(r.O_()?r.L_():Ua(n)&&n.Ra.set("Unknown"))}function Ff(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Fi(t).Y_(e)}function gw(t,e){t.Va.Ue(e),Fi(t).Z_(e)}function Uf(t){t.Va=new tI({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Fi(t).start(),t.Ra.ua()}function jf(t){return Ua(t)&&!Fi(t).x_()&&t.Ia.size>0}function Ua(t){return ge(t).Ea.size===0}function yw(t){t.Va=void 0}async function oT(t){t.Ra.set("Online")}async function lT(t){t.Ia.forEach((e,n)=>{Ff(t,e)})}async function cT(t,e){yw(t),jf(t)?(t.Ra.ha(e),Uf(t)):t.Ra.set("Unknown")}async function uT(t,e,n){if(t.Ra.set("Online"),e instanceof ew&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.Ia.delete(c),s.Va.removeTarget(c))}(t,e)}catch(r){ee(Pa,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await nu(t,r)}else if(e instanceof gc?t.Va.Ze(e):e instanceof Z_?t.Va.st(e):t.Va.tt(e),!n.isEqual(pe.min()))try{const r=await mw(t.localStore);n.compareTo(r)>=0&&await function(i,o){const c=i.Va.Tt(o);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=i.Ia.get(d);h&&i.Ia.set(d,h.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,d)=>{const h=i.Ia.get(u);if(!h)return;i.Ia.set(u,h.withResumeToken(Ot.EMPTY_BYTE_STRING,h.snapshotVersion)),gw(i,u);const p=new bs(h.target,u,d,h.sequenceNumber);Ff(i,p)}),i.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(r){ee(Pa,"Failed to raise snapshot:",r),await nu(t,r)}}async function nu(t,e,n){if(!Mi(e))throw e;t.Ea.add(1),await fl(t),t.Ra.set("Offline"),n||(n=()=>mw(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ee(Pa,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await qu(t)})}function vw(t,e){return e().catch(n=>nu(t,n,e))}async function Wu(t){const e=ge(t),n=Hs(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:bf;for(;dT(e);)try{const s=await WI(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,mT(e,s)}catch(s){await nu(e,s)}Ew(e)&&_w(e)}function dT(t){return Ua(t)&&t.Ta.length<10}function mT(t,e){t.Ta.push(e);const n=Hs(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Ew(t){return Ua(t)&&!Hs(t).x_()&&t.Ta.length>0}function _w(t){Hs(t).start()}async function hT(t){Hs(t).ra()}async function fT(t){const e=Hs(t);for(const n of t.Ta)e.ea(n.mutations)}async function pT(t,e,n){const r=t.Ta.shift(),s=kf.from(r,e,n);await vw(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Wu(t)}async function gT(t,e){e&&Hs(t).X_&&await async function(r,s){if(function(o){return JC(o)&&o!==j.ABORTED}(s.code)){const i=r.Ta.shift();Hs(r).B_(),await vw(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Wu(r)}}(t,e),Ew(t)&&_w(t)}async function Wy(t,e){const n=ge(t);n.asyncQueue.verifyOperationInProgress(),ee(Pa,"RemoteStore received new credentials");const r=Ua(n);n.Ea.add(3),await fl(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await qu(n)}async function yT(t,e){const n=ge(t);e?(n.Ea.delete(2),await qu(n)):e||(n.Ea.add(2),await fl(n),n.Ra.set("Unknown"))}function Fi(t){return t.ma||(t.ma=function(n,r,s){const i=ge(n);return i.sa(),new tT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:oT.bind(null,t),t_:lT.bind(null,t),r_:cT.bind(null,t),H_:uT.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),jf(t)?Uf(t):t.Ra.set("Unknown")):(await t.ma.stop(),yw(t))})),t.ma}function Hs(t){return t.fa||(t.fa=function(n,r,s){const i=ge(n);return i.sa(),new nT(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:hT.bind(null,t),r_:gT.bind(null,t),ta:fT.bind(null,t),na:pT.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await Wu(t)):(await t.fa.stop(),t.Ta.length>0&&(ee(Pa,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new jr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,c=new Bf(e,n,o,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new X(j.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zf(t,e){if(Gr("AsyncQueue",`${e}: ${t}`),Mi(t))return new X(j.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{static emptySet(e){return new pi(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ue.comparator(n.key,r.key):(n,r)=>ue.comparator(n.key,r.key),this.keyedMap=co(),this.sortedSet=new Qe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof pi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new pi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy{constructor(){this.ga=new Qe(ue.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):me(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class ki{constructor(e,n,r,s,i,o,c,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(c=>{o.push({type:0,doc:c})}),new ki(e,n,pi.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Uu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class ET{constructor(){this.queries=Ky(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=ge(n),i=s.queries;s.queries=Ky(),i.forEach((o,c)=>{for(const u of c.Sa)u.onError(r)})})(this,new X(j.ABORTED,"Firestore shutting down"))}}function Ky(){return new Fa(t=>U_(t),Uu)}async function $f(t,e){const n=ge(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.ba()&&e.Da()&&(r=2):(i=new vT,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const c=zf(o,`Initialization of query '${Wa(e.query)}' failed`);return void e.onError(c)}n.queries.set(s,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&qf(n)}async function Hf(t,e){const n=ge(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function _T(t,e){const n=ge(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const c of o.Sa)c.Fa(s)&&(r=!0);o.wa=s}}r&&qf(n)}function wT(t,e,n){const r=ge(t),s=r.queries.get(e);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(e)}function qf(t){t.Ca.forEach(e=>{e.next()})}var lh,Qy;(Qy=lh||(lh={})).Ma="default",Qy.Cache="cache";class Wf{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new ki(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=ki.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==lh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(e){this.key=e}}class xw{constructor(e){this.key=e}}class xT{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=be(),this.mutatedKeys=be(),this.eu=j_(e),this.tu=new pi(this.eu)}get nu(){return this.Ya}ru(e,n){const r=n?n.iu:new Gy,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,p)=>{const y=s.get(h),S=ju(this.query,p)?p:null,P=!!y&&this.mutatedKeys.has(y.key),w=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let A=!1;y&&S?y.data.isEqual(S.data)?P!==w&&(r.track({type:3,doc:S}),A=!0):this.su(y,S)||(r.track({type:2,doc:S}),A=!0,(u&&this.eu(S,u)>0||d&&this.eu(S,d)<0)&&(c=!0)):!y&&S?(r.track({type:0,doc:S}),A=!0):y&&!S&&(r.track({type:1,doc:y}),A=!0,(u||d)&&(c=!0)),A&&(S?(o=o.add(S),i=w?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:c,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,p)=>function(S,P){const w=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return me(20277,{Rt:A})}};return w(S)-w(P)}(h.type,p.type)||this.eu(h.doc,p.doc)),this.ou(r),s=s??!1;const c=n&&!s?this._u():[],u=this.Xa.size===0&&this.current&&!s?1:0,d=u!==this.Za;return this.Za=u,o.length!==0||d?{snapshot:new ki(this.query,e.tu,i,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Gy,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=be(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});const n=[];return e.forEach(r=>{this.Xa.has(r)||n.push(new xw(r))}),this.Xa.forEach(r=>{e.has(r)||n.push(new ww(r))}),n}cu(e){this.Ya=e.Qs,this.Xa=be();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return ki.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Gf="SyncEngine";class NT{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class bT{constructor(e){this.key=e,this.hu=!1}}class ST{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Fa(c=>U_(c),Uu),this.Iu=new Map,this.Eu=new Set,this.du=new Qe(ue.comparator),this.Au=new Map,this.Ru=new Df,this.Vu={},this.mu=new Map,this.fu=Ai.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function CT(t,e,n=!0){const r=Tw(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await Nw(r,e,n,!0),s}async function IT(t,e){const n=Tw(t);await Nw(n,e,!0,!1)}async function Nw(t,e,n,r){const s=await GI(t.localStore,_r(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let c;return r&&(c=await TT(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&pw(t.remoteStore,s),c}async function TT(t,e,n,r,s){t.pu=(p,y,S)=>async function(w,A,_,v){let I=A.view.ru(_);I.Cs&&(I=await By(w.localStore,A.query,!1).then(({documents:b})=>A.view.ru(b,I)));const D=v&&v.targetChanges.get(A.targetId),M=v&&v.targetMismatches.get(A.targetId)!=null,V=A.view.applyChanges(I,w.isPrimaryClient,D,M);return Xy(w,A.targetId,V.au),V.snapshot}(t,p,y,S);const i=await By(t.localStore,e,!0),o=new xT(e,i.Qs),c=o.ru(i.documents),u=hl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(c,t.isPrimaryClient,u);Xy(t,n,d.au);const h=new NT(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function AT(t,e,n){const r=ge(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!Uu(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ih(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Lf(r.remoteStore,s.targetId),ch(r,s.targetId)}).catch(Oi)):(ch(r,s.targetId),await ih(r.localStore,s.targetId,!0))}async function kT(t,e){const n=ge(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Lf(n.remoteStore,r.targetId))}async function PT(t,e,n){const r=FT(t);try{const s=await function(o,c){const u=ge(o),d=je.now(),h=c.reduce((S,P)=>S.add(P.key),be());let p,y;return u.persistence.runTransaction("Locally write mutations","readwrite",S=>{let P=Kr(),w=be();return u.Ns.getEntries(S,h).next(A=>{P=A,P.forEach((_,v)=>{v.isValidDocument()||(w=w.add(_))})}).next(()=>u.localDocuments.getOverlayedDocuments(S,P)).next(A=>{p=A;const _=[];for(const v of c){const I=GC(v,p.get(v.key).overlayedDocument);I!=null&&_.push(new Js(v.key,I,P_(I.value.mapValue),wr.exists(!0)))}return u.mutationQueue.addMutationBatch(S,d,_,c)}).next(A=>{y=A;const _=A.applyToLocalDocumentSet(p,w);return u.documentOverlayCache.saveOverlays(S,A.batchId,_)})}).then(()=>({batchId:y.batchId,changes:z_(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,c,u){let d=o.Vu[o.currentUser.toKey()];d||(d=new Qe(Ne)),d=d.insert(c,u),o.Vu[o.currentUser.toKey()]=d}(r,s.batchId,n),await pl(r,s.changes),await Wu(r.remoteStore)}catch(s){const i=zf(s,"Failed to persist write");n.reject(i)}}async function bw(t,e){const n=ge(t);try{const r=await HI(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(Re(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?Re(o.hu,14607):s.removedDocuments.size>0&&(Re(o.hu,42227),o.hu=!1))}),await pl(n,r,e)}catch(r){await Oi(r)}}function Yy(t,e,n){const r=ge(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const c=o.view.va(e);c.snapshot&&s.push(c.snapshot)}),function(o,c){const u=ge(o);u.onlineState=c;let d=!1;u.queries.forEach((h,p)=>{for(const y of p.Sa)y.va(c)&&(d=!0)}),d&&qf(u)}(r.eventManager,e),s.length&&r.Pu.H_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function RT(t,e,n){const r=ge(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new Qe(ue.comparator);o=o.insert(i,zt.newNoDocument(i,pe.min()));const c=be().add(i),u=new $u(pe.min(),new Map,new Qe(Ne),o,c);await bw(r,u),r.du=r.du.remove(i),r.Au.delete(e),Kf(r)}else await ih(r.localStore,e,!1).then(()=>ch(r,e,n)).catch(Oi)}async function DT(t,e){const n=ge(t),r=e.batch.batchId;try{const s=await $I(n.localStore,e);Cw(n,r,null),Sw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await pl(n,s)}catch(s){await Oi(s)}}async function VT(t,e,n){const r=ge(t);try{const s=await function(o,c){const u=ge(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return u.mutationQueue.lookupMutationBatch(d,c).next(p=>(Re(p!==null,37113),h=p.keys(),u.mutationQueue.removeMutationBatch(d,p))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>u.localDocuments.getDocuments(d,h))})}(r.localStore,e);Cw(r,e,n),Sw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await pl(r,s)}catch(s){await Oi(s)}}function Sw(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function Cw(t,e,n){const r=ge(t);let s=r.Vu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Vu[r.currentUser.toKey()]=s}}function ch(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(r=>{t.Ru.containsKey(r)||Iw(t,r)})}function Iw(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Lf(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Kf(t))}function Xy(t,e,n){for(const r of n)r instanceof ww?(t.Ru.addReference(r.key,e),OT(t,r)):r instanceof xw?(ee(Gf,"Document no longer in limbo: "+r.key),t.Ru.removeReference(r.key,e),t.Ru.containsKey(r.key)||Iw(t,r.key)):me(19791,{wu:r})}function OT(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Eu.has(r)||(ee(Gf,"New document in limbo: "+n),t.Eu.add(r),Kf(t))}function Kf(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ue(Me.fromString(e)),r=t.fu.next();t.Au.set(r,new bT(n)),t.du=t.du.insert(n,r),pw(t.remoteStore,new bs(_r(Fu(n.path)),r,"TargetPurposeLimboResolution",Ou.ce))}}async function pl(t,e,n){const r=ge(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((c,u)=>{o.push(r.pu(u,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const p=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(u.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(d){s.push(d);const p=Of.As(u.targetId,d);i.push(p)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(u,d){const h=ge(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>z.forEach(d,y=>z.forEach(y.Es,S=>h.persistence.referenceDelegate.addReference(p,y.targetId,S)).next(()=>z.forEach(y.ds,S=>h.persistence.referenceDelegate.removeReference(p,y.targetId,S)))))}catch(p){if(!Mi(p))throw p;ee(Mf,"Failed to update sequence numbers: "+p)}for(const p of d){const y=p.targetId;if(!p.fromCache){const S=h.Ms.get(y),P=S.snapshotVersion,w=S.withLastLimboFreeSnapshotVersion(P);h.Ms=h.Ms.insert(y,w)}}}(r.localStore,i))}async function MT(t,e){const n=ge(t);if(!n.currentUser.isEqual(e)){ee(Gf,"User change. New user:",e.toKey());const r=await dw(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(c=>{c.forEach(u=>{u.reject(new X(j.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await pl(n,r.Ls)}}function LT(t,e){const n=ge(t),r=n.Au.get(e);if(r&&r.hu)return be().add(r.key);{let s=be();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const c=n.Tu.get(o);s=s.unionWith(c.view.nu)}return s}}function Tw(t){const e=ge(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=bw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=LT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=RT.bind(null,e),e.Pu.H_=_T.bind(null,e.eventManager),e.Pu.yu=wT.bind(null,e.eventManager),e}function FT(t){const e=ge(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=DT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=VT.bind(null,e),e}class ru{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Hu(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return zI(this.persistence,new UI,e.initialUser,this.serializer)}Cu(e){return new uw(Vf.mi,this.serializer)}Du(e){return new QI}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ru.provider={build:()=>new ru};class UT extends ru{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){Re(this.persistence.referenceDelegate instanceof tu,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new bI(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?sn.withCacheSize(this.cacheSizeBytes):sn.DEFAULT;return new uw(r=>tu.mi(r,n),this.serializer)}}class uh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Yy(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=MT.bind(null,this.syncEngine),await yT(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new ET}()}createDatastore(e){const n=Hu(e.databaseInfo.databaseId),r=function(i){return new eT(i)}(e.databaseInfo);return function(i,o,c,u){return new sT(i,o,c,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,c){return new iT(r,s,i,o,c)}(this.localStore,this.datastore,e.asyncQueue,n=>Yy(this.syncEngine,n,0),function(){return Hy.v()?new Hy:new YI}())}createSyncEngine(e,n){return function(s,i,o,c,u,d,h){const p=new ST(s,i,o,c,u,d);return h&&(p.gu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ge(s);ee(Pa,"RemoteStore shutting down."),i.Ea.add(5),await fl(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}uh.provider={build:()=>new uh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Gr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qs="FirestoreClient";class jT{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=rn.UNAUTHENTICATED,this.clientId=Nf.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ee(qs,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ee(qs,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new jr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=zf(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Gd(t,e){t.asyncQueue.verifyOperationInProgress(),ee(qs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await dw(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Jy(t,e){t.asyncQueue.verifyOperationInProgress();const n=await BT(t);ee(qs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Wy(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Wy(e.remoteStore,s)),t._onlineComponents=e}async function BT(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ee(qs,"Using user provided OfflineComponentProvider");try{await Gd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===j.FAILED_PRECONDITION||s.code===j.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Wo("Error using user provided cache. Falling back to memory cache: "+n),await Gd(t,new ru)}}else ee(qs,"Using default OfflineComponentProvider"),await Gd(t,new UT(void 0));return t._offlineComponents}async function Aw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ee(qs,"Using user provided OnlineComponentProvider"),await Jy(t,t._uninitializedComponentsProvider._online)):(ee(qs,"Using default OnlineComponentProvider"),await Jy(t,new uh))),t._onlineComponents}function zT(t){return Aw(t).then(e=>e.syncEngine)}async function su(t){const e=await Aw(t),n=e.eventManager;return n.onListen=CT.bind(null,e.syncEngine),n.onUnlisten=AT.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=IT.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=kT.bind(null,e.syncEngine),n}function $T(t,e,n={}){const r=new jr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,c,u,d){const h=new Qf({next:y=>{h.Nu(),o.enqueueAndForget(()=>Hf(i,p));const S=y.docs.has(c);!S&&y.fromCache?d.reject(new X(j.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&y.fromCache&&u&&u.source==="server"?d.reject(new X(j.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(y)},error:y=>d.reject(y)}),p=new Wf(Fu(c.path),h,{includeMetadataChanges:!0,qa:!0});return $f(i,p)}(await su(t),t.asyncQueue,e,n,r)),r.promise}function HT(t,e,n={}){const r=new jr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,c,u,d){const h=new Qf({next:y=>{h.Nu(),o.enqueueAndForget(()=>Hf(i,p)),y.fromCache&&u.source==="server"?d.reject(new X(j.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(y)},error:y=>d.reject(y)}),p=new Wf(c,h,{includeMetadataChanges:!0,qa:!0});return $f(i,p)}(await su(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zy=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qT="firestore.googleapis.com",ev=!0;class tv{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new X(j.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=qT,this.ssl=ev}else this.host=e.host,this.ssl=e.ssl??ev;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=lw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<cw)throw new X(j.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}iC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=kw(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new X(j.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new X(j.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new X(j.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Yf{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new tv({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new X(j.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new X(j.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new tv(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new XS;switch(r.type){case"firstParty":return new eC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new X(j.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Zy.get(n);r&&(ee("ComponentProvider","Removing Datastore"),Zy.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Zs(this.firestore,e,this._query)}}class st{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ms(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new st(this.firestore,e,this._key)}toJSON(){return{type:st._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(dl(n,st._jsonSchema))return new st(e,r||null,new ue(Me.fromString(n.referencePath)))}}st._jsonSchemaVersion="firestore/documentReference/1.0",st._jsonSchema={type:mt("string",st._jsonSchemaVersion),referencePath:mt("string")};class Ms extends Zs{constructor(e,n,r){super(e,n,Fu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new st(this.firestore,null,new ue(e))}withConverter(e){return new Ms(this.firestore,e,this._path)}}function Cn(t,e,...n){if(t=Tt(t),__("collection","path",e),t instanceof Yf){const r=Me.fromString(e,...n);return fy(r),new Ms(t,null,r)}{if(!(t instanceof st||t instanceof Ms))throw new X(j.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Me.fromString(e,...n));return fy(r),new Ms(t.firestore,null,r)}}function mn(t,e,...n){if(t=Tt(t),arguments.length===1&&(e=Nf.newId()),__("doc","path",e),t instanceof Yf){const r=Me.fromString(e,...n);return hy(r),new st(t,null,new ue(r))}{if(!(t instanceof st||t instanceof Ms))throw new X(j.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Me.fromString(e,...n));return hy(r),new st(t.firestore,t instanceof Ms?t.converter:null,new ue(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nv="AsyncQueue";class rv{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new hw(this,"async_queue_retry"),this._c=()=>{const r=Wd();r&&ee(nv,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Wd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Wd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new jr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Mi(e))throw e;ee(nv,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Gr("INTERNAL UNHANDLED ERROR: ",sv(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Bf.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&me(47125,{Pc:sv(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function sv(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function av(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Ra extends Yf{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new rv,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new rv(e),this._firestoreClient=void 0,await e}}}function WT(t,e,n){n||(n=Yc);const r=Du(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(Ta(i,e))return s;throw new X(j.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new X(j.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<cw)throw new X(j.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Ma(e.host)&&Ef(e.host),r.initialize({options:e,instanceIdentifier:n})}function Gu(t){if(t._terminated)throw new X(j.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||GT(t),t._firestoreClient}function GT(t){var r,s,i;const e=t._freezeSettings(),n=function(c,u,d,h){return new yC(c,u,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,kw(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)}(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new jT(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ln(Ot.fromBase64String(e))}catch(n){throw new X(j.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ln(Ot.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ln._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(dl(e,Ln._jsonSchema))return Ln.fromBase64String(e.bytes)}}Ln._jsonSchemaVersion="firestore/bytes/1.0",Ln._jsonSchema={type:mt("string",Ln._jsonSchemaVersion),bytes:mt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new X(j.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Rt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new X(j.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new X(j.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ne(this._lat,e._lat)||Ne(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Nr._jsonSchemaVersion}}static fromJSON(e){if(dl(e,Nr._jsonSchema))return new Nr(e.latitude,e.longitude)}}Nr._jsonSchemaVersion="firestore/geoPoint/1.0",Nr._jsonSchema={type:mt("string",Nr._jsonSchemaVersion),latitude:mt("number"),longitude:mt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:br._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(dl(e,br._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new br(e.vectorValues);throw new X(j.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}br._jsonSchemaVersion="firestore/vectorValue/1.0",br._jsonSchema={type:mt("string",br._jsonSchemaVersion),vectorValues:mt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KT=/^__.*__$/;class QT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Js(e,this.data,this.fieldMask,n,this.fieldTransforms):new ml(e,this.data,n,this.fieldTransforms)}}class Pw{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Js(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Rw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw me(40011,{Ac:t})}}class Xf{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Xf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return au(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Rw(this.Ac)&&KT.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class YT{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Hu(e)}Cc(e,n,r,s=!1){return new Xf({Ac:e,methodName:n,Dc:r,path:Rt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Jf(t){const e=t._freezeSettings(),n=Hu(t._databaseId);return new YT(t._databaseId,!!e.ignoreUndefinedProperties,n)}function XT(t,e,n,r,s,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,s);ep("Data must be an object, but it was:",o,r);const c=Dw(r,o);let u,d;if(i.merge)u=new wn(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const p of i.mergeFields){const y=dh(e,p,n);if(!o.contains(y))throw new X(j.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);Ow(h,y)||h.push(y)}u=new wn(h),d=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,d=o.fieldTransforms;return new QT(new on(c),u,d)}class Yu extends Qu{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Yu}}class Zf extends Qu{_toFieldTransform(e){return new $C(e.path,new Jo)}isEqual(e){return e instanceof Zf}}function JT(t,e,n,r){const s=t.Cc(1,e,n);ep("Data must be an object, but it was:",s,r);const i=[],o=on.empty();Xs(r,(u,d)=>{const h=tp(e,u,n);d=Tt(d);const p=s.yc(h);if(d instanceof Yu)i.push(h);else{const y=gl(d,p);y!=null&&(i.push(h),o.set(h,y))}});const c=new wn(i);return new Pw(o,c,s.fieldTransforms)}function ZT(t,e,n,r,s,i){const o=t.Cc(1,e,n),c=[dh(e,r,n)],u=[s];if(i.length%2!=0)throw new X(j.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<i.length;y+=2)c.push(dh(e,i[y])),u.push(i[y+1]);const d=[],h=on.empty();for(let y=c.length-1;y>=0;--y)if(!Ow(d,c[y])){const S=c[y];let P=u[y];P=Tt(P);const w=o.yc(S);if(P instanceof Yu)d.push(S);else{const A=gl(P,w);A!=null&&(d.push(S),h.set(S,A))}}const p=new wn(d);return new Pw(h,p,o.fieldTransforms)}function eA(t,e,n,r=!1){return gl(n,t.Cc(r?4:3,e))}function gl(t,e){if(Vw(t=Tt(t)))return ep("Unsupported field value:",e,t),Dw(t,e);if(t instanceof Qu)return function(r,s){if(!Rw(s.Ac))throw s.Sc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const c of r){let u=gl(c,s.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Tt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return jC(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=je.fromDate(r);return{timestampValue:eu(s.serializer,i)}}if(r instanceof je){const i=new je(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:eu(s.serializer,i)}}if(r instanceof Nr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ln)return{bytesValue:tw(s.serializer,r._byteString)};if(r instanceof st){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Rf(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof br)return function(o,c){return{mapValue:{fields:{[A_]:{stringValue:k_},[Xc]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw c.Sc("VectorValues must only contain numeric values.");return Af(c.serializer,d)})}}}}}}(r,s);throw s.Sc(`Unsupported field value: ${Vu(r)}`)}(t,e)}function Dw(t,e){const n={};return N_(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xs(t,(r,s)=>{const i=gl(s,e.mc(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Vw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof je||t instanceof Nr||t instanceof Ln||t instanceof st||t instanceof Qu||t instanceof br)}function ep(t,e,n){if(!Vw(n)||!w_(n)){const r=Vu(n);throw r==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+r)}}function dh(t,e,n){if((e=Tt(e))instanceof Ku)return e._internalPath;if(typeof e=="string")return tp(t,e);throw au("Field path arguments must be of type string or ",t,!1,void 0,n)}const tA=new RegExp("[~\\*/\\[\\]]");function tp(t,e,n){if(e.search(tA)>=0)throw au(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ku(...e.split("."))._internalPath}catch{throw au(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function au(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new X(j.INVALID_ARGUMENT,c+t+u)}function Ow(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new st(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new nA(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Xu("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class nA extends Mw{data(){return super.data()}}function Xu(t,e){return typeof e=="string"?tp(t,e):e instanceof Ku?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lw(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new X(j.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class np{}class Fw extends np{}function at(t,e,...n){let r=[];e instanceof np&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof rp).length,c=i.filter(u=>u instanceof Ju).length;if(o>1||o>0&&c>0)throw new X(j.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Ju extends Fw{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Ju(e,n,r)}_apply(e){const n=this._parse(e);return Uw(e._query,n),new Zs(e.firestore,e.converter,eh(e._query,n))}_parse(e){const n=Jf(e.firestore);return function(i,o,c,u,d,h,p){let y;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new X(j.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){ov(p,h);const P=[];for(const w of p)P.push(iv(u,i,w));y={arrayValue:{values:P}}}else y=iv(u,i,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||ov(p,h),y=eA(c,o,p,h==="in"||h==="not-in");return dt.create(d,h,y)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function zn(t,e,n){const r=e,s=Xu("where",t);return Ju._create(s,r,n)}class rp extends np{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new rp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:nr.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const c=i.getFlattenedFilters();for(const u of c)Uw(o,u),o=eh(o,u)}(e._query,n),new Zs(e.firestore,e.converter,eh(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class sp extends Fw{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new sp(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new X(j.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new X(j.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Xo(i,o)}(e._query,this._field,this._direction);return new Zs(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Li(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function ea(t,e="asc"){const n=e,r=Xu("orderBy",t);return sp._create(r,n)}function iv(t,e,n){if(typeof(n=Tt(n))=="string"){if(n==="")throw new X(j.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!F_(e)&&n.indexOf("/")!==-1)throw new X(j.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Me.fromString(n));if(!ue.isDocumentKey(r))throw new X(j.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xy(t,new ue(r))}if(n instanceof st)return xy(t,n._key);throw new X(j.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vu(n)}.`)}function ov(t,e){if(!Array.isArray(t)||t.length===0)throw new X(j.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Uw(t,e){const n=function(s,i){for(const o of s)for(const c of o.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new X(j.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new X(j.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class rA{convertValue(e,n="none"){switch($s(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(zs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw me(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Xs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[Xc].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>nt(o.doubleValue));return new br(n)}convertGeoPoint(e){return new Nr(nt(e.latitude),nt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Lu(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ko(e));default:return null}}convertTimestamp(e){const n=Bs(e);return new je(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Me.fromString(e);Re(ow(r),9688,{name:e});const s=new Qo(r.get(1),r.get(3)),i=new ue(r.popFirst(5));return s.isEqual(n)||Gr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sA(t,e,n){let r;return r=t?t.toFirestore(e):e,r}class mo{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wa extends Mw{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new yc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Xu("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new X(j.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=wa._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}wa._jsonSchemaVersion="firestore/documentSnapshot/1.0",wa._jsonSchema={type:mt("string",wa._jsonSchemaVersion),bundleSource:mt("string","DocumentSnapshot"),bundleName:mt("string"),bundle:mt("string")};class yc extends wa{data(e={}){return super.data(e)}}class xa{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new mo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new yc(this._firestore,this._userDataWriter,r.key,r,new mo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new X(j.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(c=>{const u=new yc(s._firestore,s._userDataWriter,c.doc.key,c.doc,new mo(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new yc(s._firestore,s._userDataWriter,c.doc.key,c.doc,new mo(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),h=o.indexOf(c.doc.key)),{type:aA(c.type),doc:u,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new X(j.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=xa._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Nf.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function aA(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return me(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iA(t){t=Er(t,st);const e=Er(t.firestore,Ra);return $T(Gu(e),t._key).then(n=>Bw(e,t,n))}xa._jsonSchemaVersion="firestore/querySnapshot/1.0",xa._jsonSchema={type:mt("string",xa._jsonSchemaVersion),bundleSource:mt("string","QuerySnapshot"),bundleName:mt("string"),bundle:mt("string")};class ap extends rA{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ln(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new st(this.firestore,null,n)}}function Ws(t){t=Er(t,Zs);const e=Er(t.firestore,Ra),n=Gu(e),r=new ap(e);return Lw(t._query),HT(n,t._query).then(s=>new xa(e,r,t,s))}function $n(t,e,n,...r){t=Er(t,st);const s=Er(t.firestore,Ra),i=Jf(s);let o;return o=typeof(e=Tt(e))=="string"||e instanceof Ku?ZT(i,"updateDoc",t._key,e,n,r):JT(i,"updateDoc",t._key,e),jw(s,[o.toMutation(t._key,wr.exists(!0))])}function ta(t,e){const n=Er(t.firestore,Ra),r=mn(t),s=sA(t.converter,e);return jw(n,[XT(Jf(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,wr.exists(!1))]).then(()=>r)}function na(t,...e){var u,d,h;t=Tt(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||av(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(av(e[r])){const p=e[r];e[r]=(u=p.next)==null?void 0:u.bind(p),e[r+1]=(d=p.error)==null?void 0:d.bind(p),e[r+2]=(h=p.complete)==null?void 0:h.bind(p)}let i,o,c;if(t instanceof st)o=Er(t.firestore,Ra),c=Fu(t._key.path),i={next:p=>{e[r]&&e[r](Bw(o,t,p))},error:e[r+1],complete:e[r+2]};else{const p=Er(t,Zs);o=Er(p.firestore,Ra),c=p._query;const y=new ap(o);i={next:S=>{e[r]&&e[r](new xa(o,y,p,S))},error:e[r+1],complete:e[r+2]},Lw(t._query)}return function(y,S,P,w){const A=new Qf(w),_=new Wf(S,A,P);return y.asyncQueue.enqueueAndForget(async()=>$f(await su(y),_)),()=>{A.Nu(),y.asyncQueue.enqueueAndForget(async()=>Hf(await su(y),_))}}(Gu(o),c,s,i)}function jw(t,e){return function(r,s){const i=new jr;return r.asyncQueue.enqueueAndForget(async()=>PT(await zT(r),s,i)),i.promise}(Gu(t),e)}function Bw(t,e,n){const r=n.docs.get(e._key),s=new ap(t);return new wa(t,s,e._key,r,new mo(n.hasPendingWrites,n.fromCache),e.converter)}function Ve(){return new Zf("serverTimestamp")}(function(e,n=!0){(function(s){Vi=s})(La),Aa(new Us("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),c=new Ra(new JS(r.getProvider("auth-internal")),new tC(o,r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new X(j.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qo(d.options.projectId,h)}(o,s),o);return i={useFetchStreams:n,...i},c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),vr(cy,uy,e),vr(cy,uy,"esm2020")})();var oA="firebase",lA="12.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vr(oA,lA,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zw="firebasestorage.googleapis.com",cA="storageBucket",uA=2*60*1e3,dA=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr extends Ar{constructor(e,n,r=0){super(Kd(e),`Firebase Storage: ${n} (${Kd(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,kr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Kd(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Tr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Tr||(Tr={}));function Kd(t){return"storage/"+t}function mA(){const t="An unknown error occurred, please check the error payload for server response.";return new kr(Tr.UNKNOWN,t)}function hA(){return new kr(Tr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function fA(){return new kr(Tr.CANCELED,"User canceled the upload/download.")}function pA(t){return new kr(Tr.INVALID_URL,"Invalid URL '"+t+"'.")}function gA(t){return new kr(Tr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function lv(t){return new kr(Tr.INVALID_ARGUMENT,t)}function $w(){return new kr(Tr.APP_DELETED,"The Firebase app was deleted.")}function yA(t){return new kr(Tr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Xn.makeFromUrl(e,n)}catch{return new Xn(e,"")}if(r.path==="")return r;throw gA(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const o="(/(.*))?$",c=new RegExp("^gs://"+s+o,"i"),u={bucket:1,path:3};function d(D){D.path_=decodeURIComponent(D.path)}const h="v[A-Za-z0-9_]+",p=n.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",S=new RegExp(`^https?://${p}/${h}/b/${s}/o${y}`,"i"),P={bucket:1,path:3},w=n===zw?"(?:storage.googleapis.com|storage.cloud.google.com)":n,A="([^?#]*)",_=new RegExp(`^https?://${w}/${s}/${A}`,"i"),I=[{regex:c,indices:u,postModify:i},{regex:S,indices:P,postModify:d},{regex:_,indices:{bucket:1,path:2},postModify:d}];for(let D=0;D<I.length;D++){const M=I[D],V=M.regex.exec(e);if(V){const b=V[M.indices.bucket];let g=V[M.indices.path];g||(g=""),r=new Xn(b,g),M.postModify(r);break}}if(r==null)throw pA(e);return r}}class vA{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EA(t,e,n){let r=1,s=null,i=null,o=!1,c=0;function u(){return c===2}let d=!1;function h(...A){d||(d=!0,e.apply(null,A))}function p(A){s=setTimeout(()=>{s=null,t(S,u())},A)}function y(){i&&clearTimeout(i)}function S(A,..._){if(d){y();return}if(A){y(),h.call(null,A,..._);return}if(u()||o){y(),h.call(null,A,..._);return}r<64&&(r*=2);let I;c===1?(c=2,I=0):I=(r+Math.random())*1e3,p(I)}let P=!1;function w(A){P||(P=!0,y(),!d&&(s!==null?(A||(c=2),clearTimeout(s),p(0)):A||(c=1)))}return p(0),i=setTimeout(()=>{o=!0,w(!0)},n),w}function _A(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wA(t){return t!==void 0}function cv(t,e,n,r){if(r<e)throw lv(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw lv(`Invalid value for '${t}'. Expected ${n} or less.`)}function xA(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var iu;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(iu||(iu={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NA(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e,n,r,s,i,o,c,u,d,h,p,y=!0,S=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=c,this.errorCallback_=u,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=p,this.retry=y,this.isUsingEmulator=S,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((P,w)=>{this.resolve_=P,this.reject_=w,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Xl(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=c=>{const u=c.loaded,d=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const c=i.getErrorCode()===iu.NO_ERROR,u=i.getStatus();if(!c||NA(u,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===iu.ABORT;r(!1,new Xl(!1,null,h));return}const d=this.successCodes_.indexOf(u)!==-1;r(!0,new Xl(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,c=s.connection;if(s.wasSuccessCode)try{const u=this.callback_(c,c.getResponse());wA(u)?i(u):i()}catch(u){o(u)}else if(c!==null){const u=mA();u.serverResponse=c.getErrorText(),this.errorCallback_?o(this.errorCallback_(c,u)):o(u)}else if(s.canceled){const u=this.appDelete_?$w():fA();o(u)}else{const u=hA();o(u)}};this.canceled_?n(!1,new Xl(!1,null,!0)):this.backoffId_=EA(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&_A(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Xl{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function SA(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function CA(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function IA(t,e){e&&(t["X-Firebase-GMPID"]=e)}function TA(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function AA(t,e,n,r,s,i,o=!0,c=!1){const u=xA(t.urlParams),d=t.url+u,h=Object.assign({},t.headers);return IA(h,e),SA(h,n),CA(h,i),TA(h,r),new bA(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kA(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function PA(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e,n){this._service=e,n instanceof Xn?this._location=n:this._location=Xn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ou(e,n)}get root(){const e=new Xn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return PA(this._location.path)}get storage(){return this._service}get parent(){const e=kA(this._location.path);if(e===null)return null;const n=new Xn(this._location.bucket,e);return new ou(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw yA(e)}}function uv(t,e){const n=e==null?void 0:e[cA];return n==null?null:Xn.makeFromBucketSpec(n,t)}function RA(t,e,n,r={}){t.host=`${e}:${n}`;const s=Ma(e);s&&(Ef(`https://${t.host}/b`),i_("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:N1(i,t.app.options.projectId))}class DA{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=zw,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=uA,this._maxUploadRetryTime=dA,this._requests=new Set,s!=null?this._bucket=Xn.makeFromBucketSpec(s,this._host):this._bucket=uv(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Xn.makeFromBucketSpec(this._url,e):this._bucket=uv(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){cv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){cv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(En(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ou(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new vA($w());{const o=AA(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const dv="@firebase/storage",mv="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw="storage";function VA(t=u_(),e){t=Tt(t);const r=Du(t,Hw).getImmediate({identifier:e}),s=w1("storage");return s&&OA(r,...s),r}function OA(t,e,n,r={}){RA(t,e,n,r)}function MA(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new DA(n,r,s,e,La)}function LA(){Aa(new Us(Hw,MA,"PUBLIC").setMultipleInstances(!0)),vr(dv,mv,""),vr(dv,mv,"esm2020")}LA();function qw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const FA=qw,Ww=new cl("auth","Firebase",qw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lu=new _f("@firebase/auth");function UA(t,...e){lu.logLevel<=xe.WARN&&lu.warn(`Auth (${La}): ${t}`,...e)}function vc(t,...e){lu.logLevel<=xe.ERROR&&lu.error(`Auth (${La}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rr(t,...e){throw ip(t,...e)}function Sr(t,...e){return ip(t,...e)}function Gw(t,e,n){const r={...FA(),[e]:n};return new cl("auth","Firebase",r).create(e,{appName:t.name})}function Br(t){return Gw(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ip(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Ww.create(t,...e)}function le(t,e,...n){if(!t)throw ip(e,...n)}function Lr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw vc(e),new Error(e)}function Qr(t,e){t||Lr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cu(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function jA(){return hv()==="http:"||hv()==="https:"}function hv(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(jA()||A1()||"connection"in navigator)?navigator.onLine:!0}function zA(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yl{constructor(e,n){this.shortDelay=e,this.longDelay=n,Qr(n>e,"Short delay should be less than long delay!"),this.isMobile=C1()||k1()}get(){return BA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function op(t,e){Qr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Lr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Lr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Lr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $A={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],qA=new yl(3e4,6e4);function Xr(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Jr(t,e,n,r,s={}){return Qw(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const c=ul({key:t.config.apiKey,...o}).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:u,...i};return T1()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Ma(t.emulatorConfig.host)&&(d.credentials="include"),Kw.fetch()(await Yw(t,t.config.apiHost,n,c),d)})}async function Qw(t,e,n){t._canInitEmulator=!1;const r={...$A,...e};try{const s=new GA(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Jl(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Jl(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw Jl(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw Jl(t,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Gw(t,h,d);rr(t,h)}}catch(s){if(s instanceof Ar)throw s;rr(t,"network-request-failed",{message:String(s)})}}async function vl(t,e,n,r,s={}){const i=await Jr(t,e,n,r,s);return"mfaPendingCredential"in i&&rr(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function Yw(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?op(t.config,s):`${t.config.apiScheme}://${s}`;return HA.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function WA(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class GA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Sr(this.auth,"network-request-failed")),qA.get())})}}function Jl(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Sr(t,e,r);return s.customData._tokenResponse=n,s}function fv(t){return t!==void 0&&t.enterprise!==void 0}class KA{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return WA(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function QA(t,e){return Jr(t,"GET","/v2/recaptchaConfig",Xr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YA(t,e){return Jr(t,"POST","/v1/accounts:delete",e)}async function uu(t,e){return Jr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Io(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function XA(t,e=!1){const n=Tt(t),r=await n.getIdToken(e),s=lp(r);le(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Io(Qd(s.auth_time)),issuedAtTime:Io(Qd(s.iat)),expirationTime:Io(Qd(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Qd(t){return Number(t)*1e3}function lp(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return vc("JWT malformed, contained fewer than 3 sections"),null;try{const s=n_(n);return s?JSON.parse(s):(vc("Failed to decode base64 JWT payload"),null)}catch(s){return vc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function pv(t){const e=lp(t);return le(e,"internal-error"),le(typeof e.exp<"u","internal-error"),le(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tl(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Ar&&JA(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function JA({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Io(this.lastLoginAt),this.creationTime=Io(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function du(t){var p;const e=t.auth,n=await t.getIdToken(),r=await tl(t,uu(e,{idToken:n}));le(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(p=s.providerUserInfo)!=null&&p.length?Xw(s.providerUserInfo):[],o=tk(t.providerData,i),c=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=c?u:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new mh(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function ek(t){const e=Tt(t);await du(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function tk(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Xw(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nk(t,e){const n=await Qw(t,{},async()=>{const r=ul({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await Yw(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:r};return t.emulatorConfig&&Ma(t.emulatorConfig.host)&&(u.credentials="include"),Kw.fetch()(o,u)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function rk(t,e){return Jr(t,"POST","/v2/accounts:revokeToken",Xr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){le(e.idToken,"internal-error"),le(typeof e.idToken<"u","internal-error"),le(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):pv(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){le(e.length!==0,"internal-error");const n=pv(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(le(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await nk(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new gi;return r&&(le(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(le(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(le(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new gi,this.toJSON())}_performRefresh(){return Lr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hs(t,e){le(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Jn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new ZA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new mh(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await tl(this,this.stsTokenManager.getToken(this.auth,e));return le(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return XA(this,e)}reload(){return ek(this)}_assign(e){this!==e&&(le(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Jn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await du(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(En(this.auth.app))return Promise.reject(Br(this.auth));const e=await this.getIdToken();return await tl(this,YA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,c=n.tenantId??void 0,u=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:p,emailVerified:y,isAnonymous:S,providerData:P,stsTokenManager:w}=n;le(p&&w,e,"internal-error");const A=gi.fromJSON(this.name,w);le(typeof p=="string",e,"internal-error"),hs(r,e.name),hs(s,e.name),le(typeof y=="boolean",e,"internal-error"),le(typeof S=="boolean",e,"internal-error"),hs(i,e.name),hs(o,e.name),hs(c,e.name),hs(u,e.name),hs(d,e.name),hs(h,e.name);const _=new Jn({uid:p,auth:e,email:s,emailVerified:y,displayName:r,isAnonymous:S,photoURL:o,phoneNumber:i,tenantId:c,stsTokenManager:A,createdAt:d,lastLoginAt:h});return P&&Array.isArray(P)&&(_.providerData=P.map(v=>({...v}))),u&&(_._redirectEventId=u),_}static async _fromIdTokenResponse(e,n,r=!1){const s=new gi;s.updateFromServerResponse(n);const i=new Jn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await du(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];le(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Xw(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new gi;c.updateFromIdToken(r);const u=new Jn({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new mh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv=new Map;function Fr(t){Qr(t instanceof Function,"Expected a class definition");let e=gv.get(t);return e?(Qr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,gv.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Jw.type="NONE";const yv=Jw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ec(t,e,n){return`firebase:${t}:${e}:${n}`}class yi{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Ec(this.userKey,s.apiKey,i),this.fullPersistenceKey=Ec("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await uu(this.auth,{idToken:e}).catch(()=>{});return n?Jn._fromGetAccountInfoResponse(this.auth,n,e):null}return Jn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new yi(Fr(yv),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Fr(yv);const o=Ec(r,e.config.apiKey,e.name);let c=null;for(const d of n)try{const h=await d._get(o);if(h){let p;if(typeof h=="string"){const y=await uu(e,{idToken:h}).catch(()=>{});if(!y)break;p=await Jn._fromGetAccountInfoResponse(e,y,h)}else p=Jn._fromJSON(e,h);d!==i&&(c=p),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new yi(i,e,r):(i=u[0],c&&await i._set(o,c.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new yi(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vv(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(nx(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Zw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(sx(e))return"Blackberry";if(ax(e))return"Webos";if(ex(e))return"Safari";if((e.includes("chrome/")||tx(e))&&!e.includes("edge/"))return"Chrome";if(rx(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Zw(t=Ht()){return/firefox\//i.test(t)}function ex(t=Ht()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function tx(t=Ht()){return/crios\//i.test(t)}function nx(t=Ht()){return/iemobile/i.test(t)}function rx(t=Ht()){return/android/i.test(t)}function sx(t=Ht()){return/blackberry/i.test(t)}function ax(t=Ht()){return/webos/i.test(t)}function cp(t=Ht()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function sk(t=Ht()){var e;return cp(t)&&!!((e=window.navigator)!=null&&e.standalone)}function ak(){return P1()&&document.documentMode===10}function ix(t=Ht()){return cp(t)||rx(t)||ax(t)||sx(t)||/windows phone/i.test(t)||nx(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(t,e=[]){let n;switch(t){case"Browser":n=vv(Ht());break;case"Worker":n=`${vv(Ht())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${La}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ik{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,c)=>{try{const u=e(i);o(u)}catch(u){c(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ok(t,e={}){return Jr(t,"GET","/v2/passwordPolicy",Xr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lk=6;class ck{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??lk,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uk{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ev(this),this.idTokenSubscription=new Ev(this),this.beforeStateQueue=new ik(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ww,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Fr(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await yi.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await uu(this,{idToken:e}),r=await Jn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(En(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,c=r==null?void 0:r._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&(u!=null&&u.user)&&(r=u.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await du(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=zA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(En(this.app))return Promise.reject(Br(this));const n=e?Tt(e):null;return n&&le(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&le(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return En(this.app)?Promise.reject(Br(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return En(this.app)?Promise.reject(Br(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Fr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ok(this),n=new ck(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new cl("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await rk(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Fr(e)||this._popupRedirectResolver;le(n,this,"argument-error"),this.redirectPersistenceManager=await yi.create(this,[Fr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(le(c,this,"internal-error"),c.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ox(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(En(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&UA(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function ja(t){return Tt(t)}class Ev{constructor(e){this.auth=e,this.observer=null,this.addObserver=U1(n=>this.observer=n)}get next(){return le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function dk(t){Zu=t}function lx(t){return Zu.loadJS(t)}function mk(){return Zu.recaptchaEnterpriseScript}function hk(){return Zu.gapiScript}function fk(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class pk{constructor(){this.enterprise=new gk}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class gk{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const yk="recaptcha-enterprise",cx="NO_RECAPTCHA";class vk{constructor(e){this.type=yk,this.auth=ja(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,c)=>{QA(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new KA(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function s(i,o,c){const u=window.grecaptcha;fv(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(cx)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new pk().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(c=>{if(!n&&fv(window.grecaptcha))s(c,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=mk();u.length!==0&&(u+=c),lx(u).then(()=>{s(c,i,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function _v(t,e,n,r=!1,s=!1){const i=new vk(t);let o;if(s)o=cx;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const c={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function hh(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await _v(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await _v(t,e,n,n==="getOobCode");return r(t,c)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ek(t,e){const n=Du(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Ta(i,e??{}))return s;rr(s,"already-initialized")}return n.initialize({options:e})}function _k(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Fr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function wk(t,e,n){const r=ja(t);le(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=ux(e),{host:o,port:c}=xk(e),u=c===null?"":`:${c}`,d={url:`${i}//${o}${u}/`},h=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){le(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),le(Ta(d,r.config.emulator)&&Ta(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Ma(o)?(Ef(`${i}//${o}${u}`),i_("Auth",!0)):Nk()}function ux(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function xk(t){const e=ux(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:wv(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:wv(o)}}}function wv(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Nk(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Lr("not implemented")}_getIdTokenResponse(e){return Lr("not implemented")}_linkToIdToken(e,n){return Lr("not implemented")}_getReauthenticationResolver(e){return Lr("not implemented")}}async function bk(t,e){return Jr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sk(t,e){return vl(t,"POST","/v1/accounts:signInWithPassword",Xr(t,e))}async function Ck(t,e){return Jr(t,"POST","/v1/accounts:sendOobCode",Xr(t,e))}async function Ik(t,e){return Ck(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tk(t,e){return vl(t,"POST","/v1/accounts:signInWithEmailLink",Xr(t,e))}async function Ak(t,e){return vl(t,"POST","/v1/accounts:signInWithEmailLink",Xr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl extends up{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new nl(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new nl(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return hh(e,n,"signInWithPassword",Sk);case"emailLink":return Tk(e,{email:this._email,oobCode:this._password});default:rr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return hh(e,r,"signUpPassword",bk);case"emailLink":return Ak(e,{idToken:n,email:this._email,oobCode:this._password});default:rr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vi(t,e){return vl(t,"POST","/v1/accounts:signInWithIdp",Xr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kk="http://localhost";class Da extends up{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Da(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):rr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new Da(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return vi(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,vi(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,vi(e,n)}buildRequest(){const e={requestUri:kk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=ul(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pk(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Rk(t){const e=io(oo(t)).link,n=e?io(oo(e)).deep_link_id:null,r=io(oo(t)).deep_link_id;return(r?io(oo(r)).link:null)||r||n||e||t}class ed{constructor(e){const n=io(oo(e)),r=n.apiKey??null,s=n.oobCode??null,i=Pk(n.mode??null);le(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=Rk(e);try{return new ed(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(){this.providerId=Ui.PROVIDER_ID}static credential(e,n){return nl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=ed.parseLink(n);return le(r,"argument-error"),nl._fromEmailAndCode(e,r.code,r.tenantId)}}Ui.PROVIDER_ID="password";Ui.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ui.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El extends dx{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs extends El{constructor(){super("facebook.com")}static credential(e){return Da._fromParams({providerId:vs.PROVIDER_ID,signInMethod:vs.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vs.credentialFromTaggedObject(e)}static credentialFromError(e){return vs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vs.credential(e.oauthAccessToken)}catch{return null}}}vs.FACEBOOK_SIGN_IN_METHOD="facebook.com";vs.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends El{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Da._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Es.credential(n,r)}catch{return null}}}Es.GOOGLE_SIGN_IN_METHOD="google.com";Es.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s extends El{constructor(){super("github.com")}static credential(e){return Da._fromParams({providerId:_s.PROVIDER_ID,signInMethod:_s.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return _s.credentialFromTaggedObject(e)}static credentialFromError(e){return _s.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return _s.credential(e.oauthAccessToken)}catch{return null}}}_s.GITHUB_SIGN_IN_METHOD="github.com";_s.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws extends El{constructor(){super("twitter.com")}static credential(e,n){return Da._fromParams({providerId:ws.PROVIDER_ID,signInMethod:ws.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ws.credentialFromTaggedObject(e)}static credentialFromError(e){return ws.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return ws.credential(n,r)}catch{return null}}}ws.TWITTER_SIGN_IN_METHOD="twitter.com";ws.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dk(t,e){return vl(t,"POST","/v1/accounts:signUp",Xr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Jn._fromIdTokenResponse(e,r,s),o=xv(r);return new Gs({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=xv(r);return new Gs({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function xv(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vk(t){var s;if(En(t.app))return Promise.reject(Br(t));const e=ja(t);if(await e._initializationPromise,(s=e.currentUser)!=null&&s.isAnonymous)return new Gs({user:e.currentUser,providerId:null,operationType:"signIn"});const n=await Dk(e,{returnSecureToken:!0}),r=await Gs._fromIdTokenResponse(e,"signIn",n,!0);return await e._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu extends Ar{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,mu.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new mu(e,n,r,s)}}function mx(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?mu._fromErrorAndOperation(t,i,e,r):i})}async function Ok(t,e,n=!1){const r=await tl(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Gs._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mk(t,e,n=!1){const{auth:r}=t;if(En(r.app))return Promise.reject(Br(r));const s="reauthenticate";try{const i=await tl(t,mx(r,s,e,t),n);le(i.idToken,r,"internal-error");const o=lp(i.idToken);le(o,r,"internal-error");const{sub:c}=o;return le(t.uid===c,r,"user-mismatch"),Gs._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&rr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hx(t,e,n=!1){if(En(t.app))return Promise.reject(Br(t));const r="signIn",s=await mx(t,r,e),i=await Gs._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Lk(t,e){return hx(ja(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fk(t,e,n){var r;le(((r=n.url)==null?void 0:r.length)>0,t,"invalid-continue-uri"),le(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),le(typeof n.linkDomain>"u"||n.linkDomain.length>0,t,"invalid-hosting-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.linkDomain=n.linkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(le(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(le(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uk(t,e,n){const r=ja(t),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function i(o,c){le(c.handleCodeInApp,r,"argument-error"),c&&Fk(r,o,c)}i(s,n),await hh(r,s,"getOobCode",Ik)}function Nv(t,e){const n=ed.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function bv(t,e,n){if(En(t.app))return Promise.reject(Br(t));const r=Tt(t),s=Ui.credentialWithLink(e,n||cu());return le(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Lk(r,s)}function jk(t,e,n,r){return Tt(t).onIdTokenChanged(e,n,r)}function Bk(t,e,n){return Tt(t).beforeAuthStateChanged(e,n)}const hu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fx{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(hu,"1"),this.storage.removeItem(hu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zk=1e3,$k=10;class px extends fx{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ix(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);ak()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,$k):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},zk)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}px.type="LOCAL";const Hk=px;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx extends fx{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}gx.type="SESSION";const yx=gx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qk(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new td(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(o).map(async d=>d(n.origin,i)),u=await qk(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}td.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dp(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((c,u)=>{const d=dp("",20);s.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(p){const y=p;if(y.data.eventId===d)switch(y.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(y.data.response);break;default:clearTimeout(h),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cr(){return window}function Gk(t){Cr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vx(){return typeof Cr().WorkerGlobalScope<"u"&&typeof Cr().importScripts=="function"}async function Kk(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Qk(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function Yk(){return vx()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ex="firebaseLocalStorageDb",Xk=1,fu="firebaseLocalStorage",_x="fbase_key";class _l{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function nd(t,e){return t.transaction([fu],e?"readwrite":"readonly").objectStore(fu)}function Jk(){const t=indexedDB.deleteDatabase(Ex);return new _l(t).toPromise()}function fh(){const t=indexedDB.open(Ex,Xk);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(fu,{keyPath:_x})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(fu)?e(r):(r.close(),await Jk(),e(await fh()))})})}async function Sv(t,e,n){const r=nd(t,!0).put({[_x]:e,value:n});return new _l(r).toPromise()}async function Zk(t,e){const n=nd(t,!1).get(e),r=await new _l(n).toPromise();return r===void 0?null:r.value}function Cv(t,e){const n=nd(t,!0).delete(e);return new _l(n).toPromise()}const e2=800,t2=3;class wx{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fh(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>t2)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return vx()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=td._getInstance(Yk()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await Kk(),!this.activeServiceWorker)return;this.sender=new Wk(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Qk()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fh();return await Sv(e,hu,"1"),await Cv(e,hu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Sv(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Zk(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Cv(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=nd(s,!1).getAll();return new _l(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),e2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}wx.type="LOCAL";const n2=wx;new yl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r2(t,e){return e?Fr(e):(le(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp extends up{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return vi(e,this._buildIdpRequest())}_linkToIdToken(e,n){return vi(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return vi(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function s2(t){return hx(t.auth,new mp(t),t.bypassAuthState)}function a2(t){const{auth:e,user:n}=t;return le(n,e,"internal-error"),Mk(n,new mp(t),t.bypassAuthState)}async function i2(t){const{auth:e,user:n}=t;return le(n,e,"internal-error"),Ok(n,new mp(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return s2;case"linkViaPopup":case"linkViaRedirect":return i2;case"reauthViaPopup":case"reauthViaRedirect":return a2;default:rr(this.auth,"internal-error")}}resolve(e){Qr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o2=new yl(2e3,1e4);class li extends xx{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,li.currentPopupAction&&li.currentPopupAction.cancel(),li.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return le(e,this.auth,"internal-error"),e}async onExecution(){Qr(this.filter.length===1,"Popup operations only handle one event");const e=dp();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Sr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Sr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,li.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Sr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,o2.get())};e()}}li.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2="pendingRedirect",_c=new Map;class c2 extends xx{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=_c.get(this.auth._key());if(!e){try{const r=await u2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}_c.set(this.auth._key(),e)}return this.bypassAuthState||_c.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function u2(t,e){const n=h2(e),r=m2(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function d2(t,e){_c.set(t._key(),e)}function m2(t){return Fr(t._redirectPersistence)}function h2(t){return Ec(l2,t.config.apiKey,t.name)}async function f2(t,e,n=!1){if(En(t.app))return Promise.reject(Br(t));const r=ja(t),s=r2(r,e),o=await new c2(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2=10*60*1e3;class g2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!y2(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Nx(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Sr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=p2&&this.cachedEventUids.clear(),this.cachedEventUids.has(Iv(e))}saveEventToCache(e){this.cachedEventUids.add(Iv(e)),this.lastProcessedEventTime=Date.now()}}function Iv(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Nx({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function y2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Nx(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v2(t,e={}){return Jr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_2=/^https?/;async function w2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await v2(t);for(const n of e)try{if(x2(n))return}catch{}rr(t,"unauthorized-domain")}function x2(t){const e=cu(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!_2.test(n))return!1;if(E2.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N2=new yl(3e4,6e4);function Tv(){const t=Cr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function b2(t){return new Promise((e,n)=>{var s,i,o;function r(){Tv(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Tv(),n(Sr(t,"network-request-failed"))},timeout:N2.get()})}if((i=(s=Cr().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Cr().gapi)!=null&&o.load)r();else{const c=fk("iframefcb");return Cr()[c]=()=>{gapi.load?r():n(Sr(t,"network-request-failed"))},lx(`${hk()}?onload=${c}`).catch(u=>n(u))}}).catch(e=>{throw wc=null,e})}let wc=null;function S2(t){return wc=wc||b2(t),wc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2=new yl(5e3,15e3),I2="__/auth/iframe",T2="emulator/auth/iframe",A2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},k2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function P2(t){const e=t.config;le(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?op(e,T2):`https://${t.config.authDomain}/${I2}`,r={apiKey:e.apiKey,appName:t.name,v:La},s=k2.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${ul(r).slice(1)}`}async function R2(t){const e=await S2(t),n=Cr().gapi;return le(n,t,"internal-error"),e.open({where:document.body,url:P2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:A2,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Sr(t,"network-request-failed"),c=Cr().setTimeout(()=>{i(o)},C2.get());function u(){Cr().clearTimeout(c),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},V2=500,O2=600,M2="_blank",L2="http://localhost";class Av{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function F2(t,e,n,r=V2,s=O2){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...D2,width:r.toString(),height:s.toString(),top:i,left:o},d=Ht().toLowerCase();n&&(c=tx(d)?M2:n),Zw(d)&&(e=e||L2,u.scrollbars="yes");const h=Object.entries(u).reduce((y,[S,P])=>`${y}${S}=${P},`,"");if(sk(d)&&c!=="_self")return U2(e||"",c),new Av(null);const p=window.open(e||"",c,h);le(p,t,"popup-blocked");try{p.focus()}catch{}return new Av(p)}function U2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j2="__/auth/handler",B2="emulator/auth/handler",z2=encodeURIComponent("fac");async function kv(t,e,n,r,s,i){le(t.config.authDomain,t,"auth-domain-config-required"),le(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:La,eventId:s};if(e instanceof dx){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",F1(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof El){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const h of Object.keys(c))c[h]===void 0&&delete c[h];const u=await t._getAppCheckToken(),d=u?`#${z2}=${encodeURIComponent(u)}`:"";return`${$2(t)}?${ul(c).slice(1)}${d}`}function $2({config:t}){return t.emulator?op(t,B2):`https://${t.authDomain}/${j2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd="webStorageSupport";class H2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=yx,this._completeRedirectFn=f2,this._overrideRedirectResult=d2}async _openPopup(e,n,r,s){var o;Qr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await kv(e,n,r,cu(),s);return F2(e,i,dp())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await kv(e,n,r,cu(),s);return Gk(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Qr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await R2(e),r=new g2(e);return n.register("authEvent",s=>(le(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Yd,{type:Yd},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Yd];i!==void 0&&n(!!i),rr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=w2(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return ix()||ex()||cp()}}const q2=H2;var Pv="@firebase/auth",Rv="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function K2(t){Aa(new Us("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;le(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ox(t)},d=new uk(r,s,i,u);return _k(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Aa(new Us("auth-internal",e=>{const n=ja(e.getProvider("auth").getImmediate());return(r=>new W2(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),vr(Pv,Rv,G2(t)),vr(Pv,Rv,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q2=5*60,Y2=a_("authIdTokenMaxAge")||Q2;let Dv=null;const X2=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Y2)return;const s=n==null?void 0:n.token;Dv!==s&&(Dv=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function J2(t=u_()){const e=Du(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Ek(t,{popupRedirectResolver:q2,persistence:[n2,Hk,yx]}),r=a_("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=X2(i.toString());Bk(n,o,()=>o(n.currentUser)),jk(n,c=>o(c))}}const s=r_("auth");return s&&wk(n,`http://${s}`),n}function Z2(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}dk({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Sr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",Z2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});K2("Browser");const eP={apiKey:"AIzaSyDU0B1lAVcRBcFPxvF66FheMFTXDgIbRgQ",authDomain:"sistemix-9fe75.firebaseapp.com",projectId:"sistemix-9fe75",storageBucket:"sistemix-9fe75.firebasestorage.app",messagingSenderId:"188178661955",appId:"1:188178661955:web:e48719efb1bf9bdf64caf6",measurementId:"G-F2P48VMKLP",databaseURL:"https://sistemix-9fe75-default-rtdb.firebaseio.com"},hp=c_(eP),Fe=WT(hp,{experimentalForceLongPolling:!0,useFetchStreams:!1,ignoreUndefinedProperties:!0});VA(hp);const Qa=J2(hp);try{Vk(Qa).then(()=>{console.info("Autenticao annima ativa")}).catch(t=>{console.warn("Falha no login annimo:",(t==null?void 0:t.code)||(t==null?void 0:t.message))})}catch(t){console.warn("Erro inesperado ao iniciar login annimo:",t==null?void 0:t.message)}const ph=Cn(Fe,"clients");function bx(t,e){const n=e?at(ph,zn("storeId","==",e)):at(ph,ea("createdAt","desc"));return na(n,r=>{const s=r.docs.map(i=>({id:i.id,...i.data()})).sort((i,o)=>{var c,u,d,h;return(((u=(c=o.createdAt)==null?void 0:c.toMillis)==null?void 0:u.call(c))??0)-(((h=(d=i.createdAt)==null?void 0:d.toMillis)==null?void 0:h.call(d))??0)});t(s)})}async function tP(t,e){if(!e)throw new Error("storeId  obrigatrio ao criar cliente");const n={storeId:e,name:t.name??"Novo Cliente",whatsapp:t.whatsapp??"",phone:t.phone??"",cpf:t.cpf??"",cnpj:t.cnpj??"",allowCredit:t.allowCredit??!1,isCompany:t.isCompany??!1,cep:t.cep??"",address:t.address??"",number:t.number??"",complement:t.complement??"",neighborhood:t.neighborhood??"",city:t.city??"",state:t.state??"",email:t.email??"",notes:t.notes??"",code:t.code??"",active:t.active??!0,createdAt:Ve(),updatedAt:Ve()};return(await ta(ph,n)).id}async function nP(t,e){const n=mn(Fe,"clients",t);await $n(n,{...e,updatedAt:Ve()})}function pu({open:t,onClose:e,isEdit:n=!1,client:r=null,storeId:s}){const[i,o]=E.useState(""),[c,u]=E.useState(""),[d,h]=E.useState(""),[p,y]=E.useState(""),[S,P]=E.useState(""),[w,A]=E.useState(!1),[_,v]=E.useState(!1),[I,D]=E.useState(!1),[M,V]=E.useState(!1),[b,g]=E.useState(""),[x,T]=E.useState(""),[k,R]=E.useState(""),[C,te]=E.useState(""),[Se,we]=E.useState(""),[Ae,H]=E.useState(""),[q,Z]=E.useState(""),[K,se]=E.useState(""),[U,G]=E.useState(""),[re,fe]=E.useState(""),[Ee,ke]=E.useState(!0),[Y,ae]=E.useState(!1),[it,ot]=E.useState("");if(E.useEffect(()=>{t&&n&&r&&(o(r.name||""),u(r.whatsapp||""),h(r.phone||""),y(r.cpf||""),P(r.cnpj||""),A(!!r.allowCredit),v(!!r.isCompany),g(r.cep||""),T(r.address||""),R(r.number||""),te(r.complement||""),we(r.neighborhood||""),H(r.city||""),Z(r.state||""),se(r.email||""),G(r.notes||""),fe(r.code||""),ke(r.active!==!1),ot(""))},[t,n,r]),!t)return null;const oe=()=>{o(""),u(""),h(""),y(""),P(""),A(!1),v(!1),D(!1),V(!1),g(""),T(""),R(""),te(""),we(""),H(""),Z(""),se(""),G(""),fe(""),ke(!0),ot("")},Je=()=>{Y||(e&&e(),oe())},tn=async ce=>{if(ce.preventDefault(),ot(""),!i.trim()){ot("Informe o nome do cliente.");return}ae(!0);try{const _t={name:i.trim(),whatsapp:c.trim(),phone:d.trim(),cpf:p.trim(),cnpj:S.trim(),allowCredit:w,isCompany:_,cep:b.trim(),address:x.trim(),number:k.trim(),complement:C.trim(),neighborhood:Se.trim(),city:Ae.trim(),state:q.trim(),email:K.trim(),notes:U.trim(),code:re.trim(),active:Ee};n&&(r!=null&&r.id)?await nP(r.id,_t):await tP(_t,s),Je()}catch(_t){console.error(_t),ot("No foi possvel salvar. Verifique sua conexo e regras do Firestore.")}finally{ae(!1)}};return a.createElement("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-[70]"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg w-[840px] max-w-[98vw]"},a.createElement("div",{className:"flex items-center justify-between p-4 border-b"},a.createElement("h3",{className:"font-semibold text-lg"},a.createElement("span",{className:"text-gray-500"},"Clientes"),a.createElement("span",{className:"mx-2 text-gray-300"},""),a.createElement("span",null,n?"Editar Cliente":"Novo Cliente")),a.createElement("button",{onClick:Je,className:"text-gray-500 hover:text-gray-700"},"")),a.createElement("form",{onSubmit:tn},a.createElement("div",{className:"p-4"},it&&a.createElement("div",{className:"text-sm text-red-600"},it),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Nome"),a.createElement("input",{value:i,onChange:ce=>o(ce.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Whatsapp"),a.createElement("input",{value:c,onChange:ce=>u(ce.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Telefone"),a.createElement("input",{value:d,onChange:ce=>h(ce.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-[1fr_auto_auto] gap-3 items-end"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},_?"CNPJ":"CPF"),a.createElement("div",{className:"mt-1 flex items-center gap-2"},a.createElement("input",{value:_?S:p,onChange:ce=>_?P(ce.target.value):y(ce.target.value),className:"flex-1 border rounded px-3 py-2 text-sm"}),a.createElement("button",{type:"button",className:"px-3 py-2 border rounded text-sm"},""))),a.createElement("label",{className:"flex items-center gap-2 text-sm"},a.createElement("span",null,"Permitir credirio"),a.createElement("button",{type:"button",onClick:()=>A(ce=>!ce),className:`relative inline-flex h-5 w-9 items-center rounded-full ${w?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${w?"translate-x-4":"translate-x-1"}`}))),a.createElement("label",{className:"flex items-center gap-2 text-sm"},a.createElement("span",null," empresa"),a.createElement("button",{type:"button",onClick:()=>v(ce=>!ce),className:`relative inline-flex h-5 w-9 items-center rounded-full ${_?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${_?"translate-x-4":"translate-x-1"}`})))),a.createElement("div",{className:"mt-4 border rounded"},a.createElement("button",{type:"button",onClick:()=>D(ce=>!ce),className:"w-full px-3 py-2 text-left flex items-center justify-between"},a.createElement("span",{className:"font-semibold text-sm"},"Endereo (opcional)"),a.createElement("span",{className:"text-gray-500"},I?"":"")),I&&a.createElement("div",{className:"px-3 pt-2 pb-3 space-y-3"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_auto] gap-3 items-end"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"CEP"),a.createElement("div",{className:"mt-1 flex items-center gap-2"},a.createElement("input",{value:b,onChange:ce=>g(ce.target.value),className:"flex-1 border rounded px-3 py-2 text-sm"}),a.createElement("button",{type:"button",className:"px-3 py-2 border rounded text-sm"},"")))),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Endereo"),a.createElement("input",{value:x,onChange:ce=>T(ce.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Nmero"),a.createElement("input",{value:k,onChange:ce=>R(ce.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Complemento"),a.createElement("input",{value:C,onChange:ce=>te(ce.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Bairro"),a.createElement("input",{value:Se,onChange:ce=>we(ce.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Cidade"),a.createElement("input",{value:Ae,onChange:ce=>H(ce.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Estado"),a.createElement("input",{value:q,onChange:ce=>Z(ce.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))))),a.createElement("div",{className:"mt-4 border rounded"},a.createElement("button",{type:"button",onClick:()=>V(ce=>!ce),className:"w-full px-3 py-2 text-left flex items-center justify-between"},a.createElement("span",{className:"font-semibold text-sm"},"Informaes adicionais (opcional)"),a.createElement("span",{className:"text-gray-500"},M?"":"")),M&&a.createElement("div",{className:"px-3 pt-2 pb-3 space-y-3"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Cdigo"),a.createElement("input",{value:re,onChange:ce=>fe(ce.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Email"),a.createElement("input",{type:"email",value:K,onChange:ce=>se(ce.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Observaes"),a.createElement("textarea",{value:U,onChange:ce=>G(ce.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm",rows:3}))))),a.createElement("div",{className:"mt-4 flex flex-col md:flex-row items-start md:items-center justify-between gap-3"},a.createElement("label",{className:"flex items-center gap-3 text-sm"},a.createElement("span",null,"Cadastro Ativo"),a.createElement("button",{type:"button",onClick:()=>ke(ce=>!ce),className:`relative inline-flex h-5 w-9 items-center rounded-full ${Ee?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${Ee?"translate-x-4":"translate-x-1"}`}))),a.createElement("div",{className:"flex items-center gap-3"},a.createElement("button",{type:"button",onClick:Je,className:"px-3 py-2 border rounded text-sm"},"Cancelar"),a.createElement("button",{disabled:Y,type:"submit",className:"px-3 py-2 rounded text-sm bg-green-600 text-white disabled:opacity-60"},"Salvar")))))))}function rP({storeId:t,addNewSignal:e}){const[n,r]=E.useState([]),[s,i]=E.useState(""),[o,c]=E.useState(!1),[u,d]=E.useState(!1),[h,p]=E.useState(null),y=E.useRef(e);E.useEffect(()=>{const w=bx(A=>r(A),t);return()=>w&&w()},[t]),E.useEffect(()=>{e!==y.current&&c(!0)},[e]);const S=E.useMemo(()=>{const w=s.trim().toLowerCase();return n.filter(A=>(A.name||"").toLowerCase().includes(w))},[n,s]),P=w=>{p(w),d(!0)};return a.createElement("div",null,a.createElement("div",{className:"bg-white rounded-lg p-4 shadow"},a.createElement("div",{className:"flex items-center gap-3"},a.createElement("input",{value:s,onChange:w=>i(w.target.value),placeholder:"Pesquisar nome, telefone...",className:"flex-1 border rounded px-3 py-2 text-sm"}),a.createElement("button",{onClick:()=>c(!0),className:"hidden md:inline-flex px-3 py-2 rounded text-sm bg-green-600 text-white"},"+ Novo"))),a.createElement("div",{className:"mt-4 bg-white rounded-lg shadow overflow-hidden"},a.createElement("div",{className:"hidden md:grid grid-cols-[1fr_10rem_8rem_2rem] items-center px-4 py-3 text-xs text-gray-500 border-b"},a.createElement("div",null,"Clientes (",S.length,")"),a.createElement("div",{className:"text-right"},"Whatsapp"),a.createElement("div",{className:"text-right"},"Status"),a.createElement("div",null)),S.map(w=>a.createElement(a.Fragment,null,a.createElement("div",{key:w.id+"-m",className:"md:hidden px-4 py-3 border-b last:border-0 cursor-pointer",onClick:()=>P(w)},a.createElement("div",{className:"text-sm font-medium flex items-center justify-between gap-2"},a.createElement("span",{className:"truncate mr-2"},w.name),w.code?a.createElement("span",{className:"text-gray-500 text-xs shrink-0"},"#",w.code):null)),a.createElement("div",{key:w.id,className:"hidden md:grid grid-cols-[1fr_10rem_8rem_2rem] items-center px-4 py-3 border-b last:border-0"},a.createElement("div",{className:"text-sm"},a.createElement("div",{className:"font-medium cursor-pointer",onClick:()=>P(w)},w.name)),a.createElement("div",{className:"text-sm text-right"},w.whatsapp||"-"),a.createElement("div",{className:"text-sm text-right"},a.createElement("div",{className:`px-2 py-1 rounded text-xs ${w.active??!0?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`},w.active??!0?"Ativo":"Inativo")),a.createElement("div",{className:"text-right text-sm"},""))))),a.createElement(pu,{open:o,onClose:()=>c(!1),storeId:t}),a.createElement(pu,{open:u,onClose:()=>d(!1),isEdit:!0,client:h,storeId:t}))}const gh=Cn(Fe,"products");function Sx(t,e){const n=e?at(gh,zn("storeId","==",e)):at(gh,ea("createdAt","desc"));return na(n,r=>{const s=r.docs.map(i=>({id:i.id,...i.data()})).sort((i,o)=>{var c,u,d,h;return(((u=(c=o.createdAt)==null?void 0:c.toMillis)==null?void 0:u.call(c))??0)-(((h=(d=i.createdAt)==null?void 0:d.toMillis)==null?void 0:h.call(d))??0)});t(s)},r=>{console.error("listenProducts error",r)})}async function sP(t,e){if(!e)throw new Error("storeId  obrigatrio ao criar produto");const n={storeId:e,name:t.name??"Novo Produto",active:t.active??!0,categoryId:t.categoryId??null,supplier:t.supplier??"",cost:t.cost??0,salePrice:t.salePrice??0,promoPrice:t.promoPrice??null,priceMin:t.priceMin??t.promoPrice??t.salePrice??0,priceMax:t.priceMax??t.salePrice??0,barcode:t.barcode??"",reference:t.reference??"",validityDate:t.validityDate??null,controlStock:t.controlStock??!0,stockInitial:t.stockInitial??0,stockMin:t.stockMin??0,stock:t.stock??t.stockInitial??0,showInCatalog:t.showInCatalog??!1,featured:t.featured??!1,variations:t.variations??0,variationsData:t.variationsData??[],description:t.description??"",commissionPercent:t.commissionPercent??0,unit:t.unit??"Unidade",allowFraction:t.allowFraction??!1,notes:t.notes??"",mlQuery:t.mlQuery??"",origin:t.origin??"",ncm:t.ncm??"",cest:t.cest??"",isSmartphone:!!t.isSmartphone,phoneBrand:t.phoneBrand??"",phoneColor:t.phoneColor??"",imei1:t.imei1??"",imei2:t.imei2??"",serialNumber:t.serialNumber??"",condition:t.condition??"",warrantyMonths:t.warrantyMonths??null,imageUrl:t.imageUrl??null,createdAt:Ve(),updatedAt:Ve()};return(await ta(gh,n)).id}async function aP(t,e){const n=mn(Fe,"products",t);await $n(n,{...e,updatedAt:Ve()})}function iP({open:t,onClose:e,onConfirm:n,commissionPercent:r=0,initialItems:s=[]}){const i=(w={})=>({name:w.name??"",cost:String(w.cost??"0"),salePrice:String(w.salePrice??"0"),promoPrice:w.promoPrice!=null?String(w.promoPrice):"",barcode:w.barcode??"",reference:w.reference??"",validityDate:w.validityDate??"",stockInitial:String(w.stockInitial??w.stock??"0"),stockMin:String(w.stockMin??"0"),active:w.active??!0}),[o,c]=E.useState([i()]),[u,d]=E.useState(null),h=w=>{const A=parseFloat(w);return(isNaN(A)?0:A).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})};if(E.useEffect(()=>{if(t){const w=Array.isArray(s)&&s.length>0?s:[i()];c(w.map(i))}},[t,s]),!t)return null;const p=()=>{c(w=>[...w,{name:"",cost:"0",salePrice:"0",promoPrice:"",barcode:"",reference:"",validityDate:"",stockInitial:"0",stockMin:"0",active:!0}])},y=(w,A,_)=>{c(v=>v.map((I,D)=>D===w?{...I,[A]:_}:I))},S=w=>{const A=parseFloat(o[w].cost)||0,_=parseFloat(r)||0,v=A*(1+_/100);y(w,"salePrice",String(v.toFixed(2)))},P=()=>{const w=o.map(A=>({name:(A.name||"").trim(),cost:parseFloat(A.cost)||0,salePrice:parseFloat(A.salePrice)||0,promoPrice:A.promoPrice?parseFloat(A.promoPrice)||0:null,priceMin:A.promoPrice?parseFloat(A.promoPrice)||0:parseFloat(A.salePrice)||0,priceMax:parseFloat(A.salePrice)||0,barcode:(A.barcode||"").trim(),reference:(A.reference||"").trim(),validityDate:A.validityDate||null,stockInitial:parseInt(A.stockInitial,10)||0,stockMin:parseInt(A.stockMin,10)||0,stock:parseInt(A.stockInitial,10)||0,active:A.active!==!1}));n&&n(w),e&&e()};return a.createElement("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[60]"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg w-[900px] max-w-[98vw]"},a.createElement("div",{className:"flex items-center justify-between p-4 border-b"},a.createElement("div",{className:"flex items-center gap-4 text-sm"},a.createElement("span",{className:"font-semibold"},"Gerenciar variaes"),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("button",{type:"button",className:"px-2 py-1 border rounded-full text-xs bg-green-50 border-green-200 text-green-700"},"Ativos"),a.createElement("button",{type:"button",className:"px-2 py-1 border rounded-full text-xs"},"Inativos"))),a.createElement("button",{onClick:e,className:"text-gray-500 hover:text-gray-700"},"")),a.createElement("form",{onSubmit:w=>{w.preventDefault(),P()}},a.createElement("div",{className:"p-4"},a.createElement("div",{className:"max-h-[70vh] overflow-y-auto pr-1"},a.createElement("div",{className:"md:hidden"},a.createElement("div",null,a.createElement("div",{className:"font-semibold mb-1"},"Variaes"),a.createElement("div",{className:"text-xs text-gray-600 mb-2"},o.length," variaes")),a.createElement("div",{className:"border rounded overflow-hidden"},o.map((w,A)=>a.createElement("div",{key:A,className:"border-b last:border-0"},a.createElement("button",{type:"button",onClick:()=>d(_=>_===A?null:A),className:"w-full text-left px-3 py-3"},a.createElement("div",{className:"grid grid-cols-[1fr_auto_auto] items-start gap-3"},a.createElement("div",null,a.createElement("div",{className:"text-sm font-medium leading-tight truncate"},w.name||"-"),a.createElement("div",{className:"mt-1 text-xs text-gray-600"},a.createElement("span",null,"Estoque: ",parseInt(w.stockInitial||"0",10)||0))),a.createElement("div",{className:"text-xs text-gray-500 pt-[1px]"},(w.reference||"").trim()?w.reference:""),a.createElement("div",{className:"text-right"},a.createElement("div",{className:"text-base font-semibold leading-tight"},h(w.promoPrice||w.salePrice)),a.createElement("div",{className:"text-xs text-gray-600"},"Custo: ",h(w.cost))))),u===A&&a.createElement("div",{className:"px-3 pb-3"},a.createElement("div",{className:"grid grid-cols-1 gap-3"},a.createElement("input",{value:w.name,onChange:_=>y(A,"name",_.target.value),className:"w-full border rounded px-3 py-2 text-sm",placeholder:"Nome da variao"})),a.createElement("div",{className:"mt-3 grid grid-cols-1 gap-3"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Custo"),a.createElement("input",{type:"number",step:"0.01",value:w.cost,onChange:_=>y(A,"cost",_.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Preo de venda"),a.createElement("input",{type:"number",step:"0.01",value:w.salePrice,onChange:_=>y(A,"salePrice",_.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Preo promocional"),a.createElement("input",{type:"number",step:"0.01",value:w.promoPrice??"",onChange:_=>y(A,"promoPrice",_.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",{className:"mt-2"},a.createElement("button",{type:"button",onClick:()=>S(A),className:"text-xs text-green-700"},"Calcular preo de venda")),a.createElement("div",{className:"mt-3 grid grid-cols-1 gap-3"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Cdigo de barras"),a.createElement("input",{value:w.barcode,onChange:_=>y(A,"barcode",_.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Referncia"),a.createElement("input",{value:w.reference,onChange:_=>y(A,"reference",_.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Validade"),a.createElement("input",{type:"date",value:w.validityDate||"",onChange:_=>y(A,"validityDate",_.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",{className:"mt-3 grid grid-cols-1 gap-3"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Estoque inicial"),a.createElement("input",{type:"number",value:w.stockInitial,onChange:_=>y(A,"stockInitial",_.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Estoque mnimo (alerta)"),a.createElement("input",{type:"number",value:w.stockMin,onChange:_=>y(A,"stockMin",_.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",{className:"flex items-end"},a.createElement("div",{className:"flex items-center gap-2 text-sm"},a.createElement("span",null,"Ativa"),a.createElement("button",{type:"button",onClick:()=>y(A,"active",!w.active),className:`relative inline-flex h-5 w-9 items-center rounded-full ${w.active?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${w.active?"translate-x-4":"translate-x-1"}`})))))))),o.length===0&&a.createElement("div",{className:"px-3 py-6 text-sm text-gray-500"},"Nenhuma variao adicionada ainda."))),a.createElement("div",{className:"hidden md:block space-y-6"},o.map((w,A)=>{var _;return a.createElement("div",{key:A,className:"border rounded p-3"},a.createElement("div",{className:"flex items-center justify-between mb-2"},a.createElement("div",{className:"text-sm font-medium"},"Variao ",A+1," ",(_=o[A])!=null&&_.createdAt?"":a.createElement("span",{className:"ml-2 text-xs text-gray-500"},"Nova"))),a.createElement("div",{className:"grid grid-cols-3 gap-4"},a.createElement("div",{className:"col-span-3"},a.createElement("input",{value:w.name,onChange:v=>y(A,"name",v.target.value),className:"w-full border rounded px-3 py-2 text-sm",placeholder:"Nome da variao"}))),a.createElement("div",{className:"mt-3 grid grid-cols-3 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Custo"),a.createElement("input",{type:"number",step:"0.01",value:w.cost,onChange:v=>y(A,"cost",v.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Preo de venda"),a.createElement("input",{type:"number",step:"0.01",value:w.salePrice,onChange:v=>y(A,"salePrice",v.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Preo promocional"),a.createElement("input",{type:"number",step:"0.01",value:w.promoPrice??"",onChange:v=>y(A,"promoPrice",v.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",{className:"mt-2"},a.createElement("button",{type:"button",onClick:()=>S(A),className:"text-xs text-green-700"},"Calcular preo de venda")),a.createElement("div",{className:"mt-3 grid grid-cols-3 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Cdigo de barras"),a.createElement("input",{value:w.barcode,onChange:v=>y(A,"barcode",v.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Referncia"),a.createElement("input",{value:w.reference,onChange:v=>y(A,"reference",v.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Validade"),a.createElement("input",{type:"date",value:w.validityDate||"",onChange:v=>y(A,"validityDate",v.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",{className:"mt-3 grid grid-cols-3 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Estoque inicial"),a.createElement("input",{type:"number",value:w.stockInitial,onChange:v=>y(A,"stockInitial",v.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Estoque mnimo (alerta)"),a.createElement("input",{type:"number",value:w.stockMin,onChange:v=>y(A,"stockMin",v.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",{className:"flex items-end"},a.createElement("div",{className:"flex items-center gap-2 text-sm"},a.createElement("span",null,"Ativa"),a.createElement("button",{type:"button",onClick:()=>y(A,"active",!w.active),className:`relative inline-flex h-5 w-9 items-center rounded-full ${w.active?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${w.active?"translate-x-4":"translate-x-1"}`}))))))}))),a.createElement("div",{className:"mt-3 px-6 flex items-center justify-between"},a.createElement("button",{type:"button",onClick:p,className:"px-3 py-2 border rounded text-sm"},"Adicionar nova variao"),a.createElement("div",{className:"flex items-center gap-3"},a.createElement("button",{type:"button",onClick:e,className:"px-3 py-2 border rounded text-sm"},"Cancelar"),a.createElement("button",{type:"submit",className:"px-3 py-2 rounded text-sm bg-green-600 text-white"},"Confirmar")))))))}const yh=Cn(Fe,"categories");function Cx(t,e){const n=e?at(yh,zn("storeId","==",e)):at(yh,ea("createdAt","desc"));return na(n,r=>{const s=r.docs.map(i=>({id:i.id,...i.data()})).sort((i,o)=>{var c,u,d,h;return(((u=(c=o.createdAt)==null?void 0:c.toMillis)==null?void 0:u.call(c))??0)-(((h=(d=i.createdAt)==null?void 0:d.toMillis)==null?void 0:h.call(d))??0)});t(s)},r=>{console.error("listenCategories error",r)})}async function oP(t,e){if(!e)throw new Error("storeId  obrigatrio ao criar categoria");const n={storeId:e,name:t.name??"Nova Categoria",commissionRate:Number(t.commissionRate??0),active:t.active??!0,imageUrl:t.imageUrl??null,createdAt:Ve(),updatedAt:Ve()};return(await ta(yh,n)).id}async function lP(t,e){const n=mn(Fe,"categories",t);await $n(n,{...e,updatedAt:Ve()})}function vh({open:t,onClose:e,isEdit:n=!1,category:r=null,storeId:s}){const[i,o]=E.useState(""),[c,u]=E.useState("0"),[d,h]=E.useState(!0),[p,y]=E.useState(!1),[S,P]=E.useState("");if(E.useEffect(()=>{t&&n&&r&&(o(r.name||""),u(String(r.commissionRate??0)),h(r.active!==!1),P(""))},[t,n,r]),!t)return null;const w=()=>{p||(e&&e(),o(""),u("0"),h(!0),P(""))},A=async _=>{if(_.preventDefault(),P(""),!i.trim()){P("Informe o nome da categoria.");return}y(!0);try{const v={name:i.trim(),commissionRate:parseFloat(c)||0,active:d};n&&(r!=null&&r.id)?await lP(r.id,v):await oP(v,s),w()}catch(v){console.error("addCategory error:",v);const I=(v==null?void 0:v.code)||"unknown",D=(v==null?void 0:v.message)||"Sem detalhes.";P(`Erro ao salvar: ${I}. ${D}`)}finally{y(!1)}};return a.createElement("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-[70]"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg w-[520px]"},a.createElement("div",{className:"flex items-center justify-between p-4 border-b"},a.createElement("h3",{className:"font-semibold text-lg"},n?"Editar Categoria":"Nova Categoria"),a.createElement("button",{onClick:w,className:"text-gray-500 hover:text-gray-700"},"")),a.createElement("form",{onSubmit:A,className:"p-4 space-y-4"},S&&a.createElement("div",{className:"text-sm text-red-600"},S),a.createElement("div",null,a.createElement("label",{className:"text-sm text-gray-600"},"Nome"),a.createElement("input",{value:i,onChange:_=>o(_.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm",placeholder:"Ex.: Eletrnicos"})),a.createElement("div",null,a.createElement("label",{className:"text-sm text-gray-600"},"Taxa de comisso"),a.createElement("input",{type:"number",step:"0.01",value:c,onChange:_=>u(_.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm",placeholder:"0"})),a.createElement("div",{className:"flex items-center justify-between"},a.createElement("label",{className:"flex items-center gap-2 text-sm"},a.createElement("span",null,"Cadastro Ativo"),a.createElement("button",{type:"button",onClick:()=>h(_=>!_),className:`relative inline-flex h-5 w-9 items-center rounded-full ${d?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${d?"translate-x-4":"translate-x-1"}`})))),a.createElement("div",{className:"flex items-center justify-end gap-3 pt-2"},a.createElement("button",{type:"button",onClick:w,className:"px-3 py-2 border rounded text-sm"},"Cancelar"),a.createElement("button",{disabled:p,type:"submit",className:"px-3 py-2 rounded text-sm bg-green-600 text-white disabled:opacity-60"},"Confirmar")))))}const Eh=Cn(Fe,"suppliers");function Ix(t,e){const n=e?at(Eh,zn("storeId","==",e)):at(Eh,ea("createdAt","desc"));return na(n,r=>{const s=r.docs.map(i=>({id:i.id,...i.data()})).sort((i,o)=>{var c,u,d,h;return(((u=(c=o.createdAt)==null?void 0:c.toMillis)==null?void 0:u.call(c))??0)-(((h=(d=i.createdAt)==null?void 0:d.toMillis)==null?void 0:h.call(d))??0)});t(s)},r=>{console.error("listenSuppliers error",r)})}async function cP(t,e){if(!e)throw new Error("storeId  obrigatrio ao criar fornecedor");const n={storeId:e,name:t.name??"Novo Fornecedor",whatsapp:t.whatsapp??"",phone:t.phone??"",cnpj:t.cnpj??"",isCompany:t.isCompany??!1,cep:t.cep??"",address:t.address??"",number:t.number??"",complement:t.complement??"",neighborhood:t.neighborhood??"",city:t.city??"",state:t.state??"",code:t.code??"",stateRegistration:t.stateRegistration??"",email:t.email??"",notes:t.notes??"",active:t.active??!0,createdAt:Ve(),updatedAt:Ve()};return(await ta(Eh,n)).id}async function uP(t,e){const n=mn(Fe,"suppliers",t);await $n(n,{...e,updatedAt:Ve()})}function _h({open:t,onClose:e,isEdit:n=!1,supplier:r=null,storeId:s}){const[i,o]=E.useState(""),[c,u]=E.useState(""),[d,h]=E.useState(""),[p,y]=E.useState(""),[S,P]=E.useState(!1),[w,A]=E.useState(!1),[_,v]=E.useState(!1),[I,D]=E.useState(""),[M,V]=E.useState(""),[b,g]=E.useState(""),[x,T]=E.useState(""),[k,R]=E.useState(""),[C,te]=E.useState(""),[Se,we]=E.useState(""),[Ae,H]=E.useState(""),[q,Z]=E.useState(""),[K,se]=E.useState(""),[U,G]=E.useState(""),[re,fe]=E.useState(!0),[Ee,ke]=E.useState(!1),[Y,ae]=E.useState("");if(E.useEffect(()=>{t&&n&&r&&(o(r.name||""),u(r.whatsapp||""),h(r.phone||""),y(r.cnpj||""),P(!!r.isCompany),D(r.cep||""),V(r.address||""),g(r.number||""),T(r.complement||""),R(r.neighborhood||""),te(r.city||""),we(r.state||""),H(r.code||""),Z(r.stateRegistration||""),se(r.email||""),G(r.notes||""),fe(r.active!==!1),ae(""))},[t,n,r]),!t)return null;const it=()=>{Ee||(e&&e(),o(""),u(""),h(""),y(""),P(!1),A(!1),v(!1),D(""),V(""),g(""),T(""),R(""),te(""),we(""),H(""),Z(""),se(""),G(""),fe(!0),ae(""))},ot=async oe=>{if(oe.preventDefault(),ae(""),!i.trim()){ae("Informe o nome do fornecedor.");return}ke(!0);try{const Je={name:i.trim(),whatsapp:c.trim(),phone:d.trim(),cnpj:p.trim(),isCompany:S,cep:I.trim(),address:M.trim(),number:b.trim(),complement:x.trim(),neighborhood:k.trim(),city:C.trim(),state:Se.trim(),code:Ae.trim(),stateRegistration:q.trim(),email:K.trim(),notes:U.trim(),active:re};n&&(r!=null&&r.id)?await uP(r.id,Je):await cP(Je,s),it()}catch(Je){console.error(Je),ae("No foi possvel salvar. Verifique sua conexo e regras do Firestore.")}finally{ke(!1)}};return a.createElement("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-[70]"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg w-[840px] max-w-[98vw]"},a.createElement("div",{className:"flex items-center justify-between p-4 border-b"},a.createElement("h3",{className:"font-semibold text-lg"},n?"Editar Fornecedor":"Novo Fornecedor"),a.createElement("button",{onClick:it,className:"text-gray-500 hover:text-gray-700"},"")),a.createElement("form",{onSubmit:ot},a.createElement("div",{className:"p-4"},Y&&a.createElement("div",{className:"text-sm text-red-600"},Y),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Nome"),a.createElement("input",{value:i,onChange:oe=>o(oe.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Whatsapp"),a.createElement("input",{value:c,onChange:oe=>u(oe.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Telefone"),a.createElement("input",{value:d,onChange:oe=>h(oe.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-[1fr_auto] gap-3 items-start md:items-end"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"CNPJ"),a.createElement("div",{className:"mt-1 flex items-center gap-2"},a.createElement("input",{value:p,onChange:oe=>y(oe.target.value),className:"flex-1 border rounded px-3 py-2 text-sm"}),a.createElement("button",{type:"button",className:"px-3 py-2 border rounded text-sm"},""))),a.createElement("label",{className:"flex items-center gap-2 text-sm"},a.createElement("span",null," empresa"),a.createElement("button",{type:"button",onClick:()=>P(oe=>!oe),className:`relative inline-flex h-5 w-9 items-center rounded-full ${S?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${S?"translate-x-4":"translate-x-1"}`})))),a.createElement("div",{className:"mt-4 border rounded"},a.createElement("button",{type:"button",onClick:()=>A(oe=>!oe),className:"w-full px-3 py-2 text-left flex items-center justify-between"},a.createElement("span",{className:"font-semibold text-sm"},"Endereo (opcional)"),a.createElement("span",{className:"text-gray-500"},w?"":"")),w&&a.createElement("div",{className:"px-3 pt-2 pb-3 space-y-3"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_auto] gap-3 items-start md:items-end"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"CEP"),a.createElement("div",{className:"mt-1 flex items-center gap-2"},a.createElement("input",{value:I,onChange:oe=>D(oe.target.value),className:"flex-1 border rounded px-3 py-2 text-sm"}),a.createElement("button",{type:"button",className:"px-3 py-2 border rounded text-sm"},"")))),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Endereo"),a.createElement("input",{value:M,onChange:oe=>V(oe.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Nmero"),a.createElement("input",{value:b,onChange:oe=>g(oe.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Complemento"),a.createElement("input",{value:x,onChange:oe=>T(oe.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Bairro"),a.createElement("input",{value:k,onChange:oe=>R(oe.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Cidade"),a.createElement("input",{value:C,onChange:oe=>te(oe.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Estado"),a.createElement("input",{value:Se,onChange:oe=>we(oe.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))))),a.createElement("div",{className:"mt-4 border rounded"},a.createElement("button",{type:"button",onClick:()=>v(oe=>!oe),className:"w-full px-3 py-2 text-left flex items-center justify-between"},a.createElement("span",{className:"font-semibold text-sm"},"Informaes adicionais (opcional)"),a.createElement("span",{className:"text-gray-500"},_?"":"")),_&&a.createElement("div",{className:"px-3 pt-2 pb-3 space-y-3"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Cdigo"),a.createElement("input",{value:Ae,onChange:oe=>H(oe.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Inscrio Estadual"),a.createElement("input",{value:q,onChange:oe=>Z(oe.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Email"),a.createElement("input",{type:"email",value:K,onChange:oe=>se(oe.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Observaes"),a.createElement("textarea",{value:U,onChange:oe=>G(oe.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm",rows:3})))),a.createElement("div",{className:"mt-4 flex flex-col md:flex-row md:items-center md:justify-between gap-3"},a.createElement("label",{className:"flex items-center gap-3 text-sm"},a.createElement("span",null,"Cadastro Ativo"),a.createElement("button",{type:"button",onClick:()=>fe(oe=>!oe),className:`relative inline-flex h-5 w-9 items-center rounded-full ${re?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${re?"translate-x-4":"translate-x-1"}`}))),a.createElement("div",{className:"flex items-center gap-3 md:justify-end"},a.createElement("button",{type:"button",onClick:it,className:"px-3 py-2 border rounded text-sm"},"Cancelar"),a.createElement("button",{disabled:Ee,type:"submit",className:"px-3 py-2 rounded text-sm bg-green-600 text-white disabled:opacity-60"},"Salvar")))))))}function gu({open:t,onClose:e,isEdit:n=!1,product:r=null,categories:s=[],suppliers:i=[],storeId:o}){var as;const[c,u]=E.useState(""),[d,h]=E.useState("0"),[p,y]=E.useState("0"),[S,P]=E.useState("0"),[w,A]=E.useState("0"),[_,v]=E.useState("cadastro"),[I,D]=E.useState(""),[M,V]=E.useState(""),[b,g]=E.useState("0"),[x,T]=E.useState("0"),[k,R]=E.useState(""),[C,te]=E.useState(""),[Se,we]=E.useState(""),[Ae,H]=E.useState(""),[q,Z]=E.useState(!0),[K,se]=E.useState("0"),[U,G]=E.useState(!1),[re,fe]=E.useState(!1),[Ee,ke]=E.useState(""),[Y,ae]=E.useState("0"),[it,ot]=E.useState("Unidade"),[oe,Je]=E.useState(!1),[tn,ce]=E.useState(""),[_t,sr]=E.useState(""),[ze,$]=E.useState(""),[Ce,qt]=E.useState(""),[Pe,In]=E.useState([]),[J,Ze]=E.useState(!1),[wt,lt]=E.useState(!0),[xt,Wt]=E.useState(!1),[hn,Hn]=E.useState(""),[Tn,$e]=E.useState(!1),[ar,fn]=E.useState(""),[Zr,qn]=E.useState(!1),[es,nn]=E.useState(!1),[ra,et]=E.useState(""),[sa,An]=E.useState(!1),[kn,ir]=E.useState(!1),[Pn,Nt]=E.useState(""),[Pr,ts]=E.useState(""),[or,aa]=E.useState(""),[ns,Gt]=E.useState(""),[Kt,Rn]=E.useState(""),[Mt,pn]=E.useState(""),[Wn,Lt]=E.useState(null);E.useEffect(()=>{t&&n&&r&&(v("cadastro"),u(r.name||""),D(r.categoryId||""),V(r.supplier||""),g(String(r.cost??0)),T(String(r.salePrice??0)),R(r.promoPrice!=null?String(r.promoPrice):""),te(r.barcode||""),we(r.reference||""),H(r.validityDate||""),Z(!!r.controlStock),P(String(r.stock??0)),se(String(r.stockMin??0)),G(!!r.showInCatalog),fe(!!r.featured),A(String(r.variations??0)),In(Array.isArray(r.variationsData)?r.variationsData:[]),ke(r.description||""),ae(String(r.commissionPercent??0)),ot(r.unit||"Unidade"),Je(!!r.allowFraction),ce(r.notes||""),sr(r.origin||""),$(r.ncm||""),qt(r.cest||""),lt(!!r.active),Hn(""),ir(!!r.isSmartphone),Nt(r.phoneBrand||""),ts(r.phoneColor||""),aa(r.imei1||""),Gt(r.imei2||""),Rn(r.serialNumber||""),pn(r.condition||""),Lt(r.warrantyMonths??null))},[t,n,r]);const tt=()=>({name:"var 1",cost:parseFloat(b)||0,salePrice:parseFloat(x)||0,promoPrice:k?parseFloat(k)||0:null,barcode:C.trim(),reference:Se.trim(),validityDate:Ae||null,stockInitial:parseInt(S,10)||0,stockMin:parseInt(K,10)||0,stock:parseInt(S,10)||0,active:!!wt});if(!t)return null;const rs=()=>{xt||(e&&e(),v("cadastro"),u(""),D(""),V(""),g("0"),T("0"),R(""),te(""),we(""),H(""),Z(!0),P("0"),se("0"),G(!1),fe(!1),A("0"),In([]),ke(""),ae("0"),ot("Unidade"),Je(!1),ce(""),sr(""),$(""),qt(""),lt(!0),Hn(""),$e(!1),fn(""),qn(!1),nn(!1),et(""),An(!1),ir(!1),Nt(""),ts(""),aa(""),Gt(""),Rn(""),pn(""),Lt(null))},ss=async B=>{if(B.preventDefault(),Hn(""),!c.trim()){Hn("Informe o nome do produto.");return}Wt(!0);try{const ye=parseFloat(x)||0,Qt=k?parseFloat(k)||0:null,ht=Pe.length>0,lr=ht?Pe.map(Yt=>Yt.promoPrice!=null?parseFloat(Yt.promoPrice)||0:parseFloat(Yt.salePrice)||0):[Qt??ye],Dn=ht?Pe.map(Yt=>parseFloat(Yt.salePrice)||0):[ye],is=Math.min(...lr),cr=Math.max(...Dn),ia=ht?Pe.reduce((Yt,Rr)=>Yt+(parseInt(Rr.stock,10)||0),0):parseInt(S,10)||0,os=ht?Pe.reduce((Yt,Rr)=>Yt+(parseInt(Rr.stockInitial,10)||parseInt(Rr.stock,10)||0),0):parseInt(S,10)||0,oa=ht?Pe.length:parseInt(w)||0,ft={name:c.trim(),categoryId:I||null,supplier:M.trim(),cost:parseFloat(b)||0,salePrice:ht?cr:ye,promoPrice:ht?null:Qt,priceMin:ht?is:Qt??ye,priceMax:ht?cr:ye,barcode:C.trim(),reference:Se.trim(),validityDate:Ae||null,controlStock:!!q,stockInitial:os,stockMin:parseInt(K,10)||0,stock:ia,showInCatalog:!!U,featured:!!re,variations:oa,variationsData:Pe,description:Ee.trim(),commissionPercent:parseFloat(Y)||0,unit:it,allowFraction:!!oe,notes:tn.trim(),origin:_t,ncm:ze.trim(),cest:Ce.trim(),active:!!wt,isSmartphone:!!kn,phoneBrand:Pn.trim(),phoneColor:Pr.trim(),imei1:or.trim(),imei2:ns.trim(),serialNumber:Kt.trim(),condition:Mt||"",warrantyMonths:Wn!=null?Number(Wn):null};n&&(r!=null&&r.id)?await aP(r.id,ft):await sP(ft,o),rs()}catch(ye){console.error(ye);const Qt=(ye==null?void 0:ye.code)||"unknown",ht=(ye==null?void 0:ye.message)||"Sem detalhes.";Hn(`Erro ao salvar: ${Qt}. ${ht}`)}finally{Wt(!1)}};return a.createElement("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg w-[980px] max-w-[98vw]"},a.createElement("div",{className:"flex items-center justify-between p-4 border-b"},a.createElement("h3",{className:"font-semibold text-lg"},n?"Editar produto":"Novo produto"),a.createElement("button",{onClick:rs,className:"text-gray-500 hover:text-gray-700"},"")),a.createElement("div",{className:"px-4 pt-3 border-b flex items-center gap-6 text-sm"},a.createElement("button",{onClick:()=>v("cadastro"),className:`pb-2 ${_==="cadastro"?"text-green-600 border-b-2 border-green-600 font-semibold":"text-gray-600"}`},"Cadastro"),a.createElement("button",{onClick:n?()=>v("estoque"):void 0,className:`pb-2 ${_==="estoque"?"text-green-600 border-b-2 border-green-600 font-semibold":"text-gray-600"} ${n?"":"opacity-50 cursor-not-allowed"}`},"Estoque")),a.createElement("form",{onSubmit:ss},a.createElement("div",{className:"p-4"},a.createElement("div",{className:"max-h-[70vh] overflow-y-auto space-y-4 pr-1"},hn&&a.createElement("div",{className:"text-sm text-red-600"},hn),_==="cadastro"?a.createElement(a.Fragment,null,a.createElement("div",null,a.createElement("div",{className:"font-semibold mb-2"},"Dados do produto"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},a.createElement("div",{className:"md:col-span-2 order-2 md:order-none"},a.createElement("input",{value:c,onChange:B=>u(B.target.value),className:"w-full border rounded px-3 py-2 text-sm",placeholder:"Nome do produto"}),a.createElement("div",{className:"mt-3 grid grid-cols-2 gap-3"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Categoria"),a.createElement("button",{type:"button",onClick:()=>$e(!0),className:"mt-1 w-full border rounded px-3 py-2 text-sm text-left"},((as=s.find(B=>B.id===I))==null?void 0:as.name)||"Selecionar categoria")),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Fornecedor"),a.createElement("button",{type:"button",onClick:()=>nn(!0),className:"mt-1 w-full border rounded px-3 py-2 text-sm text-left"},M||"Selecionar fornecedor"))),a.createElement("div",{className:"mt-3"},a.createElement("div",{className:"flex items-center gap-3"},a.createElement("span",{className:"text-sm"},"Smarthphone"),a.createElement("button",{type:"button",onClick:()=>ir(B=>!B),className:`relative inline-flex h-5 w-9 items-center rounded-full ${kn?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${kn?"translate-x-4":"translate-x-1"}`}))),kn&&a.createElement("div",{className:"mt-3 space-y-3"},a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Marca do celular"),a.createElement("input",{value:Pn,onChange:B=>Nt(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm",placeholder:"Ex.: Samsung"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Cor"),a.createElement("input",{value:Pr,onChange:B=>ts(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm",placeholder:"Ex.: Preto"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Nmero de srie"),a.createElement("input",{value:Kt,onChange:B=>Rn(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"IMEI 1"),a.createElement("input",{value:or,onChange:B=>aa(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"IMEI 2"),a.createElement("input",{value:ns,onChange:B=>Gt(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",null,a.createElement("div",{className:"text-xs text-gray-600 mb-1"},"Condio"),a.createElement("div",{className:"flex items-center gap-4 text-sm"},a.createElement("label",{className:"flex items-center gap-2"},a.createElement("input",{type:"radio",name:"condicao",checked:Mt==="novo",onChange:()=>pn("novo")}),a.createElement("span",null,"Novo")),a.createElement("label",{className:"flex items-center gap-2"},a.createElement("input",{type:"radio",name:"condicao",checked:Mt==="vitrine",onChange:()=>pn("vitrine")}),a.createElement("span",null,"Vitrine")),a.createElement("label",{className:"flex items-center gap-2"},a.createElement("input",{type:"radio",name:"condicao",checked:Mt==="usado",onChange:()=>pn("usado")}),a.createElement("span",null,"Usado")))),a.createElement("div",null,a.createElement("div",{className:"text-xs text-gray-600 mb-1"},"Garantia"),a.createElement("div",{className:"flex items-center gap-4 text-sm"},a.createElement("label",{className:"flex items-center gap-2"},a.createElement("input",{type:"radio",name:"garantia",checked:Wn===3,onChange:()=>Lt(3)}),a.createElement("span",null,"3m")),a.createElement("label",{className:"flex items-center gap-2"},a.createElement("input",{type:"radio",name:"garantia",checked:Wn===6,onChange:()=>Lt(6)}),a.createElement("span",null,"6m")),a.createElement("label",{className:"flex items-center gap-2"},a.createElement("input",{type:"radio",name:"garantia",checked:Wn===12,onChange:()=>Lt(12)}),a.createElement("span",null,"12m"))))))),a.createElement("div",{className:"order-first md:order-none"},a.createElement("div",{className:"h-32 border rounded flex items-center justify-center text-gray-400 text-sm"},"Sem imagem"),a.createElement("button",{type:"button",disabled:!0,className:"mt-2 px-3 py-2 border rounded text-xs text-gray-400"},"Adicionar fotos")))),a.createElement("div",{className:`${Pe.length>=2?"hidden":""}`},a.createElement("div",{className:"font-semibold mb-2"},"Preo e estoque"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Custo"),a.createElement("input",{type:"number",step:"0.01",value:b,onChange:B=>g(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Preo de venda"),a.createElement("input",{type:"number",step:"0.01",value:x,onChange:B=>T(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Preo promocional"),a.createElement("input",{type:"number",step:"0.01",value:k,onChange:B=>R(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",{className:"mt-2"},a.createElement("button",{type:"button",onClick:()=>{const B=parseFloat(b)||0,ye=parseFloat(Y)||0,Qt=B*(1+ye/100);T(String(Qt.toFixed(2)))},className:"text-xs text-green-700"},"Calcular preo de venda")),a.createElement("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-3 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Cdigo de barras"),a.createElement("input",{value:C,onChange:B=>te(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Referncia"),a.createElement("input",{value:Se,onChange:B=>we(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Validade"),a.createElement("input",{type:"date",value:Ae,onChange:B=>H(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-3 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Estoque inicial"),a.createElement("input",{type:"number",value:S,onChange:B=>P(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Estoque mnimo (alerta)"),a.createElement("input",{type:"number",value:K,onChange:B=>se(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",{className:"flex items-end"},a.createElement("label",{className:"flex items-center gap-2 text-sm mt-1"},a.createElement("span",null,"Cadastro Ativo"),a.createElement("button",{type:"button",onClick:()=>lt(B=>!B),className:`relative inline-flex h-5 w-9 items-center rounded-full ${wt?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${wt?"translate-x-4":"translate-x-1"}`}))))),a.createElement("div",{className:"mt-3 flex flex-col md:flex-row gap-4 md:gap-8 text-sm"},a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",null,"Controlar estoque"),a.createElement("button",{type:"button",onClick:()=>Z(B=>!B),className:`relative inline-flex h-5 w-9 items-center rounded-full ${q?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${q?"translate-x-4":"translate-x-1"}`}))),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",null,"Exibir no catlogo"),a.createElement("button",{type:"button",onClick:()=>G(B=>!B),className:`relative inline-flex h-5 w-9 items-center rounded-full ${U?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${U?"translate-x-4":"translate-x-1"}`}))),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",null,"Destacar produto"),a.createElement("button",{type:"button",onClick:()=>fe(B=>!B),className:`relative inline-flex h-5 w-9 items-center rounded-full ${re?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${re?"translate-x-4":"translate-x-1"}`}))))),a.createElement("div",null,a.createElement("div",{className:"flex items-center justify-between mb-2"},a.createElement("div",{className:"font-semibold"},"Variaes"),a.createElement("button",{type:"button",onClick:()=>Ze(!0),className:"px-3 py-2 border rounded text-sm"},"Gerenciar variaes")),a.createElement("div",{className:"md:hidden"},a.createElement("div",{className:"text-xs text-gray-600"},Pe.length," variaes"),a.createElement("div",{className:"mt-2 border rounded overflow-hidden"},Pe.map((B,ye)=>a.createElement("div",{key:ye,className:"px-3 py-3 border-b last:border-0"},a.createElement("div",{className:"grid grid-cols-[1fr_auto_auto] items-start gap-3"},a.createElement("div",null,a.createElement("div",{className:"text-sm font-medium leading-tight truncate",title:B.name},B.name||"-"),a.createElement("div",{className:"mt-1 text-xs text-gray-600"},a.createElement("span",null,"Estoque: ",B.stock??0))),a.createElement("div",{className:"text-xs text-gray-500 pt-[1px]"},(B.reference||"").trim()?B.reference:""),a.createElement("div",{className:"text-right"},a.createElement("div",{className:"text-base font-semibold leading-tight"},(B.promoPrice??B.salePrice??0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),a.createElement("div",{className:"text-xs text-gray-600"},"Custo: ",(B.cost??0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})))))),Pe.length===0&&a.createElement("div",{className:"px-3 py-6 text-sm text-gray-500"},"Nenhuma variao adicionada ainda."))),a.createElement("div",{className:"hidden md:block"},a.createElement("div",{className:"text-xs text-gray-600"},Pe.length," variaes"),a.createElement("div",{className:"mt-2 border rounded overflow-hidden"},a.createElement("div",{className:"grid grid-cols-[2fr_1fr_1fr_1fr_1fr] px-3 py-2 text-xs text-gray-500 border-b"},a.createElement("div",null,"Nome"),a.createElement("div",{className:"text-right"},"Custo"),a.createElement("div",{className:"text-right"},"Preo"),a.createElement("div",{className:"text-right"},"Estoque Min."),a.createElement("div",{className:"text-right"},"Estoque")),Pe.map((B,ye)=>a.createElement("div",{key:ye,className:"grid grid-cols-[2fr_1fr_1fr_1fr_1fr] px-3 py-2 border-b last:border-0 text-sm"},a.createElement("div",{className:"truncate",title:B.name},B.name||"-"),a.createElement("div",{className:"text-right"},(B.cost??0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),a.createElement("div",{className:"text-right"},(B.salePrice??0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),a.createElement("div",{className:"text-right"},B.stockMin??0),a.createElement("div",{className:`text-right ${(B.stock??0)>0?"":"text-red-600"}`},B.stock??0))),Pe.length===0&&a.createElement("div",{className:"px-3 py-6 text-sm text-gray-500"},"Nenhuma variao adicionada ainda."))),a.createElement("div",{className:"font-semibold mb-2"},"Dados adicionais"),a.createElement("textarea",{value:Ee,onChange:B=>ke(B.target.value),className:"w-full border rounded px-3 py-2 text-sm",placeholder:"Descrio do produto",rows:3}),a.createElement("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-3 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Comisso (%)"),a.createElement("input",{type:"number",step:"0.01",value:Y,onChange:B=>ae(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Unidade de venda"),a.createElement("select",{value:it,onChange:B=>ot(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"},a.createElement("option",null,"Unidade"),a.createElement("option",null,"Caixa"),a.createElement("option",null,"Pacote"),a.createElement("option",null,"Metro"))),a.createElement("div",{className:"flex items-end"},a.createElement("div",{className:"flex items-center gap-2 text-sm"},a.createElement("span",null,"Permite vender fracionado"),a.createElement("button",{type:"button",onClick:()=>Je(B=>!B),className:`relative inline-flex h-5 w-9 items-center rounded-full ${oe?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${oe?"translate-x-4":"translate-x-1"}`}))))),a.createElement("div",{className:"mt-3"},a.createElement("label",{className:"text-xs text-gray-600"},"Observaes internas"),a.createElement("textarea",{value:tn,onChange:B=>ce(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm",rows:2})),a.createElement("div",{className:"mt-3"},a.createElement("div",{className:"font-semibold mb-2"},"Dados Fiscais"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Origem da mercadoria"),a.createElement("select",{value:_t,onChange:B=>sr(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"},a.createElement("option",{value:""},"Selecionar..."),a.createElement("option",{value:"0"},"0 - Nacional"),a.createElement("option",{value:"1"},"1 - Estrangeira - Importao direta"),a.createElement("option",{value:"2"},"2 - Estrangeira - Adquirida no mercado interno"))),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"NCM"),a.createElement("input",{value:ze,onChange:B=>$(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"CEST"),a.createElement("input",{value:Ce,onChange:B=>qt(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})))))):a.createElement(a.Fragment,null,a.createElement("div",{className:"font-semibold mb-2"},"Estoque"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Estoque inicial"),a.createElement("input",{type:"number",value:S,onChange:B=>P(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Estoque mnimo (alerta)"),a.createElement("input",{type:"number",value:K,onChange:B=>se(B.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",{className:"mt-3 flex items-center gap-8 text-sm"},a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",null,"Controlar estoque"),a.createElement("button",{type:"button",onClick:()=>Z(B=>!B),className:`relative inline-flex h-5 w-9 items-center rounded-full ${q?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${q?"translate-x-4":"translate-x-1"}`}))),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",null,"Exibir no catlogo"),a.createElement("button",{type:"button",onClick:()=>G(B=>!B),className:`relative inline-flex h-5 w-9 items-center rounded-full ${U?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${U?"translate-x-4":"translate-x-1"}`}))),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",null,"Destacar produto"),a.createElement("button",{type:"button",onClick:()=>fe(B=>!B),className:`relative inline-flex h-5 w-9 items-center rounded-full ${re?"bg-green-500":"bg-gray-300"}`},a.createElement("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition ${re?"translate-x-4":"translate-x-1"}`}))))))),a.createElement("div",{className:"flex items-center justify-end gap-3 pt-2 px-6"},a.createElement("button",{type:"button",onClick:rs,className:"px-3 py-2 border rounded text-sm"},"Cancelar"),a.createElement("button",{disabled:xt,type:"submit",className:"px-3 py-2 rounded text-sm bg-green-600 text-white disabled:opacity-60"},"Confirmar"))),J&&a.createElement(iP,{open:J,commissionPercent:Y,initialItems:Pe.length?Pe:[tt()],onClose:()=>Ze(!1),onConfirm:B=>{if(In(B),A(String(B.length)),B.length>=1){const ye=B[0];g(String(ye.cost??0)),T(String(ye.salePrice??0)),R(ye.promoPrice!=null?String(ye.promoPrice):""),te(ye.barcode??""),we(ye.reference??""),H(ye.validityDate??null);const Qt=ye.stock??ye.stockInitial??0;P(String(Qt)),se(String(ye.stockMin??0)),lt(!!ye.active)}Ze(!1)}}),Tn&&a.createElement("div",{className:"fixed inset-0 z-[60] bg-black/30 flex items-center justify-center"},a.createElement("div",{className:"bg-white w-[520px] max-w-[90vw] rounded-lg shadow-lg"},a.createElement("div",{className:"flex items-center justify-between p-3 border-b"},a.createElement("div",{className:"font-semibold"},"Selecionar categoria"),a.createElement("button",{type:"button",onClick:()=>qn(!0),className:"px-2 py-1 text-sm rounded bg-green-600 text-white"},"+ Nova")),a.createElement("div",{className:"p-3"},a.createElement("input",{value:ar,onChange:B=>fn(B.target.value),className:"w-full border rounded px-3 py-2 text-sm",placeholder:"Pesquisar..."}),a.createElement("div",{className:"mt-3 max-h-[50vh] overflow-y-auto divide-y"},s.filter(B=>(B.name||"").toLowerCase().includes(ar.trim().toLowerCase())).map(B=>a.createElement("button",{key:B.id,type:"button",onClick:()=>{D(B.id),$e(!1)},className:"w-full text-left px-3 py-3 hover:bg-gray-50 flex items-center justify-between"},a.createElement("span",{className:"truncate"},B.name),a.createElement("span",{className:"text-gray-400"},""))),s.length===0&&a.createElement("div",{className:"px-3 py-3 text-sm text-gray-500"},"Nenhuma categoria cadastrada.")),a.createElement("div",{className:"flex items-center justify-end gap-2 pt-3"},a.createElement("button",{type:"button",onClick:()=>$e(!1),className:"px-3 py-2 border rounded text-sm"},"Cancelar"),a.createElement("button",{type:"button",onClick:()=>$e(!1),className:"px-3 py-2 rounded text-sm bg-green-600 text-white"},"Confirmar"))))),Zr&&a.createElement(vh,{open:Zr,onClose:()=>qn(!1),storeId:o}),es&&a.createElement("div",{className:"fixed inset-0 z-[60] bg-black/30 flex items-center justify-center"},a.createElement("div",{className:"bg-white w-[520px] max-w-[90vw] rounded-lg shadow-lg"},a.createElement("div",{className:"flex items-center justify-between p-3 border-b"},a.createElement("div",{className:"font-semibold"},"Selecionar fornecedor"),a.createElement("button",{type:"button",onClick:()=>An(!0),className:"px-2 py-1 text-sm rounded bg-green-600 text-white"},"+ Nova")),a.createElement("div",{className:"p-3"},a.createElement("input",{value:ra,onChange:B=>et(B.target.value),className:"w-full border rounded px-3 py-2 text-sm",placeholder:"Pesquisar..."}),a.createElement("div",{className:"mt-3 max-h-[50vh] overflow-y-auto divide-y"},i.filter(B=>(B.name||"").toLowerCase().includes(ra.trim().toLowerCase())).map((B,ye)=>a.createElement("button",{key:B.id??ye,type:"button",onClick:()=>{V(B.name||""),nn(!1)},className:"w-full text-left px-3 py-3 hover:bg-gray-50 flex items-center justify-between"},a.createElement("span",{className:"truncate"},B.name||"-"),a.createElement("span",{className:"text-gray-400"},""))),i.length===0&&a.createElement("div",{className:"px-3 py-3 text-sm text-gray-500"},"Nenhum fornecedor cadastrado.")),a.createElement("div",{className:"flex items-center justify-end gap-2 pt-3"},a.createElement("button",{type:"button",onClick:()=>nn(!1),className:"px-3 py-2 border rounded text-sm"},"Cancelar"),a.createElement("button",{type:"button",onClick:()=>nn(!1),className:"px-3 py-2 rounded text-sm bg-green-600 text-white"},"Confirmar"))))),sa&&a.createElement(_h,{open:sa,onClose:()=>An(!1),storeId:o})))}const dP=[{key:"produto",label:"Produto"},{key:"categorias",label:"Categorias"},{key:"movestoque",label:"Movimento De Estoque"},{key:"fornecedores",label:"Fornecedores"},{key:"compras",label:"Compras"}];function mP({storeId:t,addNewSignal:e}){const[n,r]=E.useState("produto"),[s,i]=E.useState([]),[o,c]=E.useState(()=>new Set),[u,d]=E.useState(""),[h,p]=E.useState("list"),[y,S]=E.useState(!1),[P,w]=E.useState(!1),[A,_]=E.useState(!1),[v,I]=E.useState(null),[D,M]=E.useState(()=>new Set),[V,b]=E.useState(null),[g,x]=E.useState([]),[T,k]=E.useState(()=>new Set),[R,C]=E.useState(!0),[te,Se]=E.useState(!1),[we,Ae]=E.useState(!1),[H,q]=E.useState(!1),[Z,K]=E.useState(null),[se,U]=E.useState([]),[G,re]=E.useState(!1),[fe,Ee]=E.useState(!1),[ke,Y]=E.useState(null),[ae,it]=E.useState(()=>new Set);E.useEffect(()=>{const $=Sx(Pe=>i(Pe),t),Ce=Cx(Pe=>x(Pe),t),qt=Ix(Pe=>U(Pe),t);return()=>{$&&$(),Ce&&Ce(),qt&&qt()}},[t]);const ot=E.useMemo(()=>{const $=u.trim().toLowerCase();return s.filter(Ce=>(Ce.name||"").toLowerCase().includes($))},[s,u]),oe=E.useMemo(()=>{const $=u.trim().toLowerCase();return g.filter(Ce=>(Ce.name||"").toLowerCase().includes($)).filter(Ce=>Ce.active??!0?R:te)},[g,u,R,te]),Je=$=>{const Ce=new Set(o);Ce.has($)?Ce.delete($):Ce.add($),c(Ce)},tn=$=>{const Ce=new Set(D);Ce.has($)?Ce.delete($):Ce.add($),M(Ce)},ce=()=>{n==="categorias"?Ae(!0):n==="fornecedores"?re(!0):w(!0)};E.useEffect(()=>{typeof e=="number"&&e>0&&ce()},[e]);const _t=$=>{I($),_(!0)},sr=$=>{K($),q(!0)},ze=$=>{Y($),Ee(!0)};return a.createElement("div",null,a.createElement("div",{className:"mb-3"},a.createElement("div",{className:"flex items-center gap-3 text-sm overflow-x-auto whitespace-nowrap md:overflow-visible scrollbar-none -mx-2 px-2"},dP.map($=>a.createElement("button",{key:$.key,className:`shrink-0 inline-flex px-2 py-1 ${n===$.key?"text-green-700 font-medium border-b-2 border-green-600":"text-gray-600"}`,onClick:()=>r($.key)},$.label)))),a.createElement("div",{className:"grid grid-cols-[1fr_auto] gap-2 items-center"},a.createElement("input",{value:u,onChange:$=>d($.target.value),placeholder:"Pesquisar...",className:"px-3 py-2 border rounded"}),a.createElement("div",{className:"flex gap-2 items-center"},a.createElement("button",{className:"md:hidden h-9 w-9 rounded border flex items-center justify-center","aria-label":"Filtros",title:"Filtros",onClick:()=>S($=>!$)},a.createElement("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},a.createElement("path",{d:"M3 5h18M6 12h12M10 19h4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}))),a.createElement("button",{className:"hidden md:inline-flex px-3 py-2 rounded border text-sm",onClick:()=>S($=>!$)},"Filtros"),a.createElement("button",{className:"px-3 py-2 rounded border text-sm",onClick:()=>p(h==="list"?"grid":"list")},""),n!=="produto"&&a.createElement("button",{className:"hidden md:inline-flex px-3 py-2 rounded border text-sm"},"Opes"),a.createElement("button",{className:"hidden md:inline-flex px-3 py-2 rounded bg-green-600 text-white text-sm",onClick:ce},"+ Novo"))),a.createElement("div",{className:`mt-2 px-3 py-2 rounded bg-gray-100 text-xs text-gray-600 ${n==="produto"?"hidden md:block":""}`},n==="produto"&&a.createElement("div",{className:"grid grid-cols-[1.5rem_1fr_1fr_12rem_6rem_6rem_2rem]"},a.createElement("div",null),a.createElement("div",null,"Produto (",ot.length,")"),a.createElement("div",{className:"text-center"},"Variaes"),a.createElement("div",{className:"text-right"},"Preo"),a.createElement("div",{className:"text-right"},"Estoque"),a.createElement("div",{className:"text-right"},"Status"),a.createElement("div",null)),n==="categorias"&&a.createElement("div",{className:"grid grid-cols-[1fr_8rem_6rem]"},a.createElement("div",null,"Categorias (",oe.length,")"),a.createElement("div",{className:"text-right"},"Status"),a.createElement("div",null)),n==="fornecedores"&&a.createElement("div",{className:"grid grid-cols-[1fr_8rem_6rem]"},a.createElement("div",null,"Fornecedores (",se.length,")"),a.createElement("div",{className:"text-right"},"Status"),a.createElement("div",null))),a.createElement("div",{className:"mt-4"},n==="produto"?a.createElement("div",{className:"bg-white rounded-lg shadow overflow-hidden"},ot.map($=>{const Ce=Number($.priceMin??$.salePrice??0),qt=Number($.priceMax??$.salePrice??Ce),Pe=Ce!==qt?`De ${Ce.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})} a ${qt.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}`:`${Ce.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}`,In=Number($.stock??0);return a.createElement(a.Fragment,null,a.createElement("div",{key:$.id,className:"relative grid grid-cols-[1.5rem_1fr_auto_auto] md:grid-cols-[1.5rem_1fr_1fr_12rem_6rem_6rem_2rem] items-center px-4 py-3 border-b last:border-0"},a.createElement("div",null,a.createElement("input",{type:"checkbox",checked:o.has($.id),onChange:()=>Je($.id)})),a.createElement("div",{className:"text-xs md:text-sm"},a.createElement("div",{className:"font-medium cursor-pointer",onClick:()=>_t($)},$.name),a.createElement("div",{className:"text-xs text-gray-500 flex items-center gap-1 mt-1"},($.variations??0)>0?`${$.variations} variantes`:"variantes",a.createElement("span",{className:"red-dot"})),a.createElement("div",{className:"text-xs text-gray-500 flex items-center gap-1"},"Estoque: ",In.toLocaleString("pt-BR"),a.createElement("span",{className:"red-dot"}))),a.createElement("div",{className:"hidden md:block text-xs text-gray-700 md:text-center md:justify-self-center"},Array.isArray($.variationsData)&&$.variationsData.length>0?a.createElement("div",{className:"space-y-1"},$.variationsData.slice(0,2).map((J,Ze)=>{const wt=Number((J==null?void 0:J.salePrice)??0),lt=(J==null?void 0:J.promoPrice)!=null?Number(J.promoPrice):null,xt=lt??wt;return a.createElement("div",{key:Ze,className:"flex items-center justify-center gap-2"},a.createElement("span",{className:"font-medium truncate"},(J==null?void 0:J.name)||(J==null?void 0:J.label)||`Variao ${Ze+1}`),J!=null&&J.reference?a.createElement("span",{className:"text-gray-500"},"(",J.reference,")"):null,a.createElement("span",{className:"whitespace-nowrap"},xt.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})))}),Array.isArray($.variationsData)&&$.variationsData.length>2?a.createElement("div",{className:"flex items-center justify-center pt-1"},a.createElement("button",{type:"button","aria-label":"Abrir todas as variaes",title:"Abrir todas as variaes",className:"inline-flex h-7 w-7 items-center justify-center rounded border",onClick:()=>tn($.id)},a.createElement("svg",{className:`${D.has($.id)?"":"rotate-180"} transition-transform`,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},a.createElement("polyline",{points:"18 15 12 9 6 15"})))):null):a.createElement("div",{className:"text-gray-500"},"")),a.createElement("div",{className:"text-right text-xs md:text-sm whitespace-nowrap md:whitespace-normal md:text-right md:pl-0 pl-4 justify-self-end"},Pe),a.createElement("div",{className:"md:hidden text-right"},a.createElement("button",{type:"button","aria-label":"Abrir detalhes",title:"Abrir detalhes",className:"inline-flex h-8 w-8 items-center justify-center rounded border",onClick:()=>tn($.id)},a.createElement("svg",{className:`${D.has($.id)?"":"rotate-180"} transition-transform`,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},a.createElement("polyline",{points:"18 15 12 9 6 15"})))),a.createElement("div",{className:`hidden md:block text-right text-sm ${In===0?"text-red-500":""}`},In.toLocaleString("pt-BR")),a.createElement("div",{className:"hidden md:block text-right text-sm"},a.createElement("div",{className:`px-2 py-1 rounded text-xs ${$.active??!0?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`},$.active??!0?"Ativo":"Inativo")),a.createElement("div",{className:"hidden md:block text-right text-sm"},a.createElement("button",{type:"button","aria-label":"Mais aes",title:"Mais aes",className:"inline-flex h-8 w-8 items-center justify-center rounded border",onClick:()=>b(V===$.id?null:$.id)},""),V===$.id&&a.createElement("div",{className:"absolute z-50 right-4 top-12 w-56 bg-white border rounded-lg shadow"},a.createElement("div",{className:"py-2"},a.createElement("button",{type:"button",className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",onClick:()=>{console.log("clonar",$.id)}},a.createElement("span",null,""),a.createElement("span",null,"Clonar")),a.createElement("button",{type:"button",className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",onClick:()=>{console.log("inativar",$.id)}},a.createElement("span",null,""),a.createElement("span",null,"Inativar")),a.createElement("button",{type:"button",className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",onClick:()=>{console.log("alterar_estoque",$.id)}},a.createElement("span",null,""),a.createElement("span",null,"Alterar estoque")),a.createElement("button",{type:"button",className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",onClick:()=>{console.log("destacar",$.id)}},a.createElement("span",null,""),a.createElement("span",null,"Destacar")),a.createElement("button",{type:"button",className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",onClick:()=>{console.log("remover_catalogo",$.id)}},a.createElement("span",null,""),a.createElement("span",null,"Remover do catlogo")),a.createElement("button",{type:"button",className:"w-full px-3 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",onClick:()=>{console.log("sincronizar",$.id)}},a.createElement("span",null,""),a.createElement("span",null,"Sincronizar entre empresas")))))),a.createElement("div",{className:`md:hidden px-4 ${D.has($.id)?"py-2 bg-gray-50 border-b":"py-0"} last:border-0`},a.createElement("div",{className:`overflow-hidden transition-all duration-200 ease-in-out ${D.has($.id)?"max-h-[480px] opacity-100":"max-h-0 opacity-0"}`},Array.isArray($.variationsData)&&$.variationsData.length>0?a.createElement("div",{className:"space-y-2"},$.variationsData.map((J,Ze)=>{const wt=Number((J==null?void 0:J.salePrice)??0),lt=(J==null?void 0:J.promoPrice)!=null?Number(J.promoPrice):null,xt=lt??wt,Wt=Number((J==null?void 0:J.stock)??0);return a.createElement("div",{key:Ze,className:"grid grid-cols-[1fr_6rem] items-center gap-2 text-xs"},a.createElement("div",{className:"truncate"},a.createElement("span",{className:"font-medium"},(J==null?void 0:J.name)||(J==null?void 0:J.label)||`Variao ${Ze+1}`),J!=null&&J.reference?a.createElement("span",{className:"ml-1 text-gray-500"},"(",J.reference,")"):null,Wt?a.createElement("span",{className:"ml-2 text-gray-500"},"Estoque: ",Wt.toLocaleString("pt-BR")):null),a.createElement("div",{className:"text-right whitespace-nowrap"},xt.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})))})):a.createElement("div",{className:"text-xs text-gray-600 py-2"},"Sem variaes cadastradas"))),a.createElement("div",{className:`hidden md:block px-4 ${D.has($.id)?"py-2 bg-gray-50 border-b":"py-0"} last:border-0`},a.createElement("div",{className:`overflow-hidden transition-all duration-200 ease-in-out ${D.has($.id)?"max-h-[480px] opacity-100":"max-h-0 opacity-0"}`},Array.isArray($.variationsData)&&$.variationsData.length>0?a.createElement("div",{className:"space-y-2"},$.variationsData.map((J,Ze)=>{const wt=Number((J==null?void 0:J.salePrice)??0),lt=(J==null?void 0:J.promoPrice)!=null?Number(J.promoPrice):null,xt=lt??wt,Wt=Number((J==null?void 0:J.stock)??0);return a.createElement("div",{key:Ze,className:"grid grid-cols-[1fr_6rem] items-center gap-2 text-sm"},a.createElement("div",{className:"truncate"},a.createElement("span",{className:"font-medium"},(J==null?void 0:J.name)||(J==null?void 0:J.label)||`Variao ${Ze+1}`),J!=null&&J.reference?a.createElement("span",{className:"ml-1 text-gray-500"},"(",J.reference,")"):null,Wt?a.createElement("span",{className:"ml-2 text-gray-500"},"Estoque: ",Wt.toLocaleString("pt-BR")):null),a.createElement("div",{className:"text-right whitespace-nowrap"},xt.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})))})):a.createElement("div",{className:"text-sm text-gray-600 py-2"},"Sem variaes cadastradas"))))})):n==="categorias"?a.createElement("div",{className:"bg-white rounded-lg shadow overflow-hidden"},a.createElement("div",{className:"grid grid-cols-[1.5rem_1fr_8rem_2rem] items-center px-4 py-3 text-xs text-gray-500 border-b"},a.createElement("div",null),a.createElement("div",null,"Nome"),a.createElement("div",{className:"text-right"},"Status"),a.createElement("div",null)),oe.map($=>a.createElement("div",{key:$.id,className:"grid grid-cols-[1.5rem_1fr_8rem_2rem] items-center px-4 py-3 border-b last:border-0"},a.createElement("div",null),a.createElement("div",{className:"text-sm"},a.createElement("div",{className:"font-medium cursor-pointer",onClick:()=>sr($)},$.name)),a.createElement("div",{className:"hidden md:block text-sm text-right"},a.createElement("div",{className:`px-2 py-1 rounded text-xs ${$.active??!0?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`},$.active??!0?"Ativo":"Inativo")),a.createElement("div",{className:"text-right text-sm"},"")))):n==="fornecedores"?a.createElement("div",{className:"bg-white rounded-lg shadow overflow-hidden"},a.createElement("div",{className:"grid grid-cols-[1.5rem_1fr_8rem_2rem] items-center px-4 py-3 text-xs text-gray-500 border-b"},a.createElement("div",null),a.createElement("div",null,"Fornecedor (",se.length,")"),a.createElement("div",{className:"text-right"},"Status"),a.createElement("div",null)),se.map($=>a.createElement("div",{key:$.id,className:"grid grid-cols-[1.5rem_1fr_8rem_2rem] items-center px-4 py-3 border-b last:border-0"},a.createElement("div",null),a.createElement("div",{className:"text-sm"},a.createElement("div",{className:"font-medium cursor-pointer",onClick:()=>ze($)},$.name)),a.createElement("div",{className:"hidden md:block text-sm text-right"},a.createElement("div",{className:`px-2 py-1 rounded text-xs ${$.active??!0?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`},$.active??!0?"Ativo":"Inativo")),a.createElement("div",{className:"text-right text-sm"},"")))):null),V&&a.createElement("div",{className:"fixed inset-0 z-40",onClick:()=>b(null)}),a.createElement(gu,{open:P,onClose:()=>w(!1),categories:g,suppliers:se,storeId:t}),a.createElement(gu,{open:A,onClose:()=>_(!1),isEdit:!0,product:v,categories:g,suppliers:se,storeId:t}),a.createElement(vh,{open:we,onClose:()=>Ae(!1),storeId:t}),a.createElement(vh,{open:H,onClose:()=>q(!1),isEdit:!0,category:Z,storeId:t}),a.createElement(_h,{open:G,onClose:()=>re(!1),storeId:t}),a.createElement(_h,{open:fe,onClose:()=>Ee(!1),isEdit:!0,supplier:ke,storeId:t}))}const rl=Cn(Fe,"orders");async function hP(t){try{if(t){const e=at(rl,zn("storeId","==",t)),n=await Ws(e);let r=0;n.docs.forEach(i=>{var u;const o=String(((u=i.data())==null?void 0:u.number)||"").replace(/^#/,""),c=parseInt(o,10);!isNaN(c)&&c>r&&(r=c)});const s=r+1;return`#${String(s).padStart(6,"0")}`}else{const e=at(rl,ea("createdAt","desc")),n=await Ws(e);let r=1;if(!n.empty){const s=n.docs[0].data(),i=String((s==null?void 0:s.number)||"").replace(/^#/,""),o=parseInt(i,10);isNaN(o)||(r=o+1)}return`#${String(r).padStart(6,"0")}`}}catch{return`#${String(1).padStart(6,"0")}`}}function rd(t,e){const n=e?at(rl,zn("storeId","==",e)):at(rl,ea("createdAt","desc"));return na(n,r=>{const s=r.docs.map(i=>({id:i.id,...i.data()})).sort((i,o)=>{var c,u,d,h;return(((u=(c=o.createdAt)==null?void 0:c.toMillis)==null?void 0:u.call(c))??0)-(((h=(d=i.createdAt)==null?void 0:d.toMillis)==null?void 0:h.call(d))??0)});t(s)})}async function fP(t,e){if(!e)throw new Error("storeId  obrigatrio ao criar OS");const n=await hP(e),r={storeId:e,client:t.client||"",technician:t.technician||"",dateIn:t.dateIn||null,expectedDate:t.expectedDate||null,brand:t.brand||"",model:t.model||"",serialNumber:t.serialNumber||"",equipment:t.equipment||"",problem:t.problem||"",receiptNotes:t.receiptNotes||"",internalNotes:t.internalNotes||"",password:t.password||"",checklist:Array.isArray(t.checklist)?t.checklist:[],files:Array.isArray(t.files)?t.files:[],services:Array.isArray(t.services)?t.services:[],products:Array.isArray(t.products)?t.products:[],totalServices:Number(t.totalServices||0),totalProducts:Number(t.totalProducts||0),discount:Number(t.discount||0),total:Number(t.total||0),payments:Array.isArray(t.payments)?t.payments:[],status:t.status||"Iniciado",valor:Number(t.total||0),number:n,createdAt:Ve(),updatedAt:Ve()};return(await ta(rl,r)).id}async function pP(t,e){const n=mn(Fe,"orders",t);await $n(n,{...e,updatedAt:Ve()})}function gP({open:t,onClose:e}){return t?a.createElement("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-[70]"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg w-[860px] max-w-[98vw]"},a.createElement("div",{className:"flex items-center justify-between p-4 border-b"},a.createElement("h3",{className:"font-semibold text-lg"},"Prvia de Nova Venda"),a.createElement("button",{onClick:e,className:"text-gray-500 hover:text-gray-700"},"")),a.createElement("div",{className:"p-4 text-sm text-gray-600"},a.createElement("p",null,"Este  um placeholder para a prvia de Nova Venda. Integre aqui seu fluxo j criado ou pea para conectar servios e UI completos.")),a.createElement("div",{className:"p-4 flex justify-end gap-3"},a.createElement("button",{onClick:e,className:"px-3 py-2 border rounded text-sm"},"Fechar"),a.createElement("button",{className:"px-3 py-2 bg-green-600 text-white rounded text-sm"},"Avanar")))):null}const yP=[{key:"todos",label:"Todos"},{key:"pedido",label:"Pedido"},{key:"venda",label:"Vendas"},{key:"cancelada",label:"Canceladas"}];function vP({initialDayFilter:t=null}){const[e,n]=E.useState([]),[r,s]=E.useState(""),[i,o]=E.useState("todos"),[c,u]=E.useState(!0),[d,h]=E.useState(!1),[p,y]=E.useState(!1),[S,P]=E.useState(t);E.useEffect(()=>{const g=rd(x=>n(x));return()=>{g&&g()}},[]),E.useEffect(()=>{P(t)},[t]);const w=g=>{var x;return(x=g==null?void 0:g.toDate)!=null&&x.call(g)?g.toDate():g?new Date(g):null},A=(g,x)=>g&&x&&g.getFullYear()===x.getFullYear()&&g.getMonth()===x.getMonth()&&g.getDate()===x.getDate(),_=E.useMemo(()=>{const g=r.trim().toLowerCase(),x=new Date,T=x.getMonth(),k=x.getFullYear();return e.filter(R=>{const C=(R.client||"").toLowerCase(),te=(R.id||"").toLowerCase();return C.includes(g)||te.includes(g)}).filter(R=>{if(!c)return!0;const C=w(R.createdAt);return C?C.getMonth()===T&&C.getFullYear()===k:!0}).filter(R=>{if(!S)return!0;const C=w(R.createdAt);return C?A(C,new Date(S)):!1}).filter(R=>{if(i==="todos")return!0;const C=(R.status||"").toLowerCase();return i==="pedido"?C==="pedido":i==="venda"?C==="venda"||C==="finalizado"||C==="pago":i==="cancelada"?C==="cancelada":!0})},[e,r,c,i]),v=E.useMemo(()=>_.reduce((g,x)=>g+Number(x.valor||x.total||0),0),[_]),I=E.useMemo(()=>_.filter(g=>(g.status||"").toLowerCase()==="venda").length,[_]),D=E.useMemo(()=>_.length?v/_.length:0,[_,v]),M=g=>g.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),V=g=>{var te;const x=(te=g==null?void 0:g.toDate)!=null&&te.call(g)?g.toDate():g?new Date(g):new Date,k=["dom","seg","ter","qua","qui","sex","sb"][x.getDay()],R=String(x.getDate()).padStart(2,"0"),C=String(x.getMonth()+1).padStart(2,"0");return`${k} - ${R}/${C}`},b=g=>{const x=Array.isArray(g.payments)&&g.payments.length?g.payments[0]:null;return(x==null?void 0:x.method)||"-"};return a.createElement("div",null,a.createElement("div",{className:"bg-white rounded-lg p-4 shadow"},a.createElement("div",{className:"flex items-center gap-3"},a.createElement("input",{value:r,onChange:g=>s(g.target.value),placeholder:"Pesquisar...",className:"flex-1 border rounded px-3 py-2 text-sm"}),S&&a.createElement("button",{onClick:()=>P(null),className:"px-3 py-2 border rounded text-sm",title:"Limpar filtro por dia"},"Limpar dia"),a.createElement("button",{onClick:()=>u(g=>!g),className:"px-3 py-2 border rounded text-sm"},c?"Este Ms":"Todos"),a.createElement("button",{onClick:()=>h(g=>!g),className:"px-3 py-2 border rounded text-sm"},"Filtros")),a.createElement("div",{className:"mt-4 grid grid-cols-3 gap-4 text-sm"},a.createElement("div",null,a.createElement("div",{className:"text-xs text-gray-500"},"Total"),a.createElement("div",{className:"text-green-600 font-semibold"},M(v))),a.createElement("div",null,a.createElement("div",{className:"text-xs text-gray-500"},"Vendas realizadas"),a.createElement("div",{className:"text-green-600 font-semibold"},I)),a.createElement("div",null,a.createElement("div",{className:"text-xs text-gray-500"},"Ticket Mdio"),a.createElement("div",{className:"text-green-600 font-semibold"},M(D)))),a.createElement("div",{className:"mt-4 flex items-center justify-between"},a.createElement("div",{className:"flex items-center gap-6 text-sm"},yP.map(g=>a.createElement("button",{key:g.key,onClick:()=>o(g.key),className:`pb-2 ${i===g.key?"text-green-600 border-b-2 border-green-600 font-semibold":"text-gray-600"}`},g.label))),a.createElement("div",{className:"flex items-center gap-3"},a.createElement("button",{className:"px-3 py-2 border rounded text-sm"},"Opes"),a.createElement("button",{onClick:()=>y(!0),className:"px-3 py-2 rounded text-sm bg-green-600 text-white"},"+ Nova Venda")))),a.createElement("div",{className:"mt-4 bg-white rounded-lg shadow overflow-hidden"},a.createElement("div",{className:"grid grid-cols-[6rem_1fr_8rem_10rem_8rem_8rem_8rem] items-center px-4 py-3 text-xs text-gray-500 border-b"},a.createElement("div",null,"Venda"),a.createElement("div",null,"Cliente"),a.createElement("div",{className:"text-center"},"Fiscal"),a.createElement("div",{className:"text-center"},"Meio de Pg."),a.createElement("div",{className:"text-center"},"Data"),a.createElement("div",{className:"text-right"},"Valor"),a.createElement("div",{className:"text-center"},"Status")),_.map(g=>a.createElement("div",{key:g.id,className:"grid grid-cols-[6rem_1fr_8rem_10rem_8rem_8rem_8rem] items-center px-4 py-3 border-b last:border-0"},a.createElement("div",{className:"text-sm"},"#",String(g.id).slice(-4)),a.createElement("div",{className:"text-sm"},g.client||"-"),a.createElement("div",{className:"text-sm text-center"},g.fiscal?"":"-"),a.createElement("div",{className:"text-sm text-center"},b(g)),a.createElement("div",{className:"text-sm text-center"},V(g.createdAt)),a.createElement("div",{className:"text-sm text-right"},M(Number(g.valor||g.total||0))),a.createElement("div",{className:"text-sm text-center"},a.createElement("div",{className:`px-2 py-1 rounded text-xs ${(g.status??"").toLowerCase()==="venda"?"bg-green-100 text-green-700":(g.status??"").toLowerCase()==="pedido"?"bg-yellow-100 text-yellow-700":(g.status??"").toLowerCase()==="cancelada"?"bg-red-100 text-red-700":"bg-gray-200 text-gray-700"}`},g.status||"Indef.")))),!_.length&&a.createElement("div",{className:"px-4 py-6 text-sm text-gray-600"},"Nenhuma venda encontrada.")),a.createElement(gP,{open:p,onClose:()=>y(!1)}))}const EP="modulepreload",_P=function(t){return"/"+t},Vv={},wP=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(u=>{if(u=_P(u),u in Vv)return;Vv[u]=!0;const d=u.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":EP,d||(p.as="script"),p.crossOrigin="",p.href=u,c&&p.setAttribute("nonce",c),document.head.appendChild(p),d)return new Promise((y,S)=>{p.addEventListener("load",y),p.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})};function xP({storeId:t,onNavigate:e,onOpenSalesDay:n}){const[r,s]=E.useState([]),[i,o]=E.useState(!1),[c,u]=E.useState([]);E.useEffect(()=>{const U=rd(re=>s(re),t);let G=null;return wP(async()=>{const{listenGoals:re}=await Promise.resolve().then(()=>NP);return{listenGoals:re}},void 0).then(({listenGoals:re})=>{G=re(fe=>u(fe),t)}).catch(()=>{}),()=>{U&&U(),G&&G()}},[t]);const d=U=>{var G;return(G=U==null?void 0:U.toDate)!=null&&G.call(U)?U.toDate():U?new Date(U):null},h=(U,G)=>U.getFullYear()===G.getFullYear()&&U.getMonth()===G.getMonth()&&U.getDate()===G.getDate(),p=new Date,y=E.useMemo(()=>r.filter(U=>{const G=d(U.createdAt);return G?h(G,p):!1}),[r]),S=E.useMemo(()=>y.filter(U=>(U.status||"").toLowerCase()==="venda"),[y]);function P(U){const G=(U||"").toLowerCase();return["os finalizada e faturada cliente final","os finalizada e faturada cliente logista"].includes(G)?!0:G.includes("finalizada")&&G.includes("faturada")&&(G.includes("cliente final")||G.includes("cliente logista"))}const w=E.useMemo(()=>y.filter(U=>P(U.status)),[y]),A=E.useMemo(()=>S.reduce((U,G)=>U+Number(G.valor||G.total||0),0),[S]),_=E.useMemo(()=>S.length?A/S.length:0,[S,A]),v=E.useMemo(()=>w.reduce((U,G)=>U+Number(G.total||G.valor||0),0),[w]),I=E.useMemo(()=>w.length?v/w.length:0,[w,v]),D=U=>Number(U||0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),M=U=>i?"":D(U),V=U=>U.toLocaleDateString("pt-BR",{day:"numeric",month:"long",year:"numeric"}),b=E.useMemo(()=>{const U=[];for(let G=1;G<=5;G++){const re=new Date(p);re.setDate(p.getDate()-G);const Ee=r.filter(ke=>{const Y=d(ke.createdAt),ae=(ke.status||"").toLowerCase()==="venda";return!!Y&&ae&&h(Y,re)}).reduce((ke,Y)=>ke+Number(Y.valor||Y.total||0),0);U.push({date:re,total:Ee})}return U},[r]);function g(U){typeof n=="function"?n(U):typeof e=="function"&&e("vendas")}const x=`${String(p.getMonth()+1).padStart(2,"0")}/${p.getFullYear()}`,T=E.useMemo(()=>c.find(U=>U.monthYear===x)||null,[c,x]),k=T?Number(T.target||0):0,R=E.useMemo(()=>r.filter(U=>{const G=d(U.createdAt);return G?G.getMonth()===p.getMonth()&&G.getFullYear()===p.getFullYear():!1}),[r]),C=E.useMemo(()=>R.filter(U=>(U.status||"").toLowerCase()==="venda").reduce((U,G)=>U+Number(G.valor||G.total||0),0),[R]),te=E.useMemo(()=>R.filter(U=>P(U.status)).reduce((U,G)=>U+Number(G.total||G.valor||0),0),[R]),Se=E.useMemo(()=>{if(!T)return 0;let U=0;return T.includeSale&&(U+=C),T.includeServiceOrder&&(U+=te),U},[T,C,te]),we=k?Math.min(100,Math.round(Se/k*100)):0,Ae=T?T.includeSale&&T.includeServiceOrder?"Venda + Ordem de Servio":T.includeSale?"Venda":"Ordem de Servio":"Venda + Ordem de Servio",H=U=>{try{return new Intl.NumberFormat("pt-BR",{notation:"compact",maximumFractionDigits:1}).format(Number(U||0))}catch{const re=Number(U||0);return re>=1e6?`${(re/1e6).toFixed(1)} mi`:re>=1e3?`${(re/1e3).toFixed(1)} mil`:String(re.toFixed(0))}},q=U=>Number(U.valor||U.total||0),Z=U=>{const re=(Array.isArray(U.products)?U.products:[]).reduce((fe,Ee)=>fe+(parseFloat(Ee.cost)||0)*(parseFloat(Ee.quantity)||0),0);return re>0?re:q(U)*.65},K=E.useMemo(()=>{const U=[];for(let G=1;G<=5;G++){const re=new Date(p);re.setDate(p.getDate()-G);const fe=r.filter(Y=>{const ae=d(Y.createdAt),it=(Y.status||"").toLowerCase()==="venda";return!!ae&&it&&h(ae,re)}),Ee=fe.reduce((Y,ae)=>Y+q(ae),0),ke=fe.reduce((Y,ae)=>Y+Math.max(0,q(ae)-Z(ae)),0);U.push({date:re,sales:Ee,profit:ke})}return U},[r]),se=E.useMemo(()=>{const U=K.flatMap(re=>[re.sales,re.profit]);return Math.max(0,...U)||1},[K]);return a.createElement("div",{className:"space-y-6"},a.createElement("section",{className:"rounded-lg bg-white p-4 md:p-6 shadow"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-green-100 text-green-700"},""),a.createElement("h2",{className:"text-base md:text-lg font-semibold"},"Resumo do Dia")),a.createElement("button",{className:"h-9 w-9 rounded-full hover:bg-gray-100 flex items-center justify-center text-gray-600",onClick:()=>o(U=>!U),"aria-label":i?"Mostrar valores":"Ocultar valores",title:i?"Mostrar valores":"Ocultar valores"},a.createElement("span",null,i?"":""))),a.createElement("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("button",{onClick:()=>e&&e("vendas"),className:"text-left p-4 border rounded-lg hover:shadow-sm transition-all"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-700"},a.createElement("span",{className:"text-green-600"},""),a.createElement("span",null,"Total de Venda (",S.length,")")),a.createElement("span",{className:"text-gray-400"},"")),a.createElement("div",{className:"mt-2 text-2xl md:text-3xl font-bold text-green-600"},M(A)),a.createElement("div",{className:"mt-3 flex items-center justify-between"},a.createElement("div",{className:"flex items-center gap-2 text-xs text-gray-600"},a.createElement("span",null,"Ticket Mdio"),a.createElement("span",{title:"Mdia por venda"},"")),a.createElement("div",{className:"text-sm text-green-600 font-semibold"},M(_)))),a.createElement("button",{onClick:()=>e&&e("os"),className:"text-left p-4 border rounded-lg hover:shadow-sm transition-all"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-700"},a.createElement("span",{className:"text-green-600"},""),a.createElement("span",null,"Ordem de Servio Finalizada (",w.length,")")),a.createElement("span",{className:"text-gray-400"},"")),a.createElement("div",{className:"mt-2 text-2xl md:text-3xl font-bold text-green-600"},M(v)),a.createElement("div",{className:"mt-3 flex items-center justify-between"},a.createElement("div",{className:"flex items-center gap-2 text-xs text-gray-600"},a.createElement("span",null,"Ticket Mdio"),a.createElement("span",{title:"Mdia por OS"},"")),a.createElement("div",{className:"text-sm text-green-600 font-semibold"},M(I)))))),a.createElement("section",{className:"rounded-lg bg-white p-4 md:p-6 shadow"},a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-green-100 text-green-700"},""),a.createElement("h3",{className:"text-base md:text-lg font-semibold"},"ltimos dias")),a.createElement("div",{className:"mt-4 divide-y"},b.map((U,G)=>a.createElement("button",{key:G,onClick:()=>g(U.date),className:"w-full text-left px-2 md:px-3 py-4 hover:bg-gray-50"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",{className:"flex items-center gap-3"},a.createElement("span",{className:"text-gray-600"},""),a.createElement("div",null,a.createElement("div",{className:"text-sm md:text-base font-medium text-gray-800"},V(U.date)),a.createElement("div",{className:"text-xs text-gray-500"},"Ver vendas deste dia"))),a.createElement("div",{className:"flex items-center gap-3"},a.createElement("div",{className:"text-green-600 font-semibold text-sm md:text-base"},M(U.total)),a.createElement("span",{className:"text-gray-400"},""))))))),a.createElement("section",{className:"rounded-lg bg-white p-4 md:p-6 shadow"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-green-100 text-green-700"},""),a.createElement("h3",{className:"text-base md:text-lg font-semibold"},"Metas do Ms")),a.createElement("button",{className:"h-9 px-3 rounded border text-sm",onClick:()=>e&&e("metas")},"Ver todas ")),a.createElement("div",{className:"mt-3"},a.createElement("span",{className:"inline-flex items-center px-2 py-1 rounded bg-green-50 text-green-700 text-xs border border-green-200"},Ae)),a.createElement("div",{className:"mt-3 text-sm text-gray-700"},a.createElement("span",{className:"mr-1"},M(Se)),a.createElement("span",null,"/"),a.createElement("span",{className:"ml-1"},M(k))),a.createElement("div",{className:"mt-3 h-2 rounded bg-gray-200 overflow-hidden"},a.createElement("div",{className:"h-full bg-green-600",style:{width:`${we}%`}})),a.createElement("div",{className:"mt-1 text-right text-xs text-gray-500"},we,"%")),a.createElement("section",{className:"rounded-lg bg-white p-4 md:p-6 shadow"},a.createElement("div",{className:"flex items-center gap-2"},a.createElement("span",{className:"inline-flex h-6 w-6 items-center justify-center rounded-full bg-green-100 text-green-700"},""),a.createElement("h3",{className:"text-base md:text-lg font-semibold"},"Vendas x Lucro")),a.createElement("div",{className:"mt-4"},a.createElement("div",{className:"grid grid-cols-5 gap-6 md:gap-8 items-end h-48"},K.map((U,G)=>{const re=Math.round(U.sales/se*100),fe=Math.round(U.profit/se*100),Ee=String(U.date.getDate()).padStart(2,"0"),ke=String(U.date.getMonth()+1).padStart(2,"0"),Y=U.date.getFullYear();return a.createElement("div",{key:G,className:"flex flex-col items-center justify-end h-full"},a.createElement("div",{className:"mb-2 text-[11px] md:text-xs text-gray-700"},a.createElement("span",{className:"mr-3 text-green-700"},H(U.sales)),a.createElement("span",{className:"text-green-900"},H(U.profit))),a.createElement("div",{className:"flex items-end gap-2 w-full justify-center"},a.createElement("div",{className:"w-8 md:w-10 bg-green-400 rounded",style:{height:`${re}%`},title:`Vendas: ${D(U.sales)}`}),a.createElement("div",{className:"w-8 md:w-10 bg-green-700 rounded",style:{height:`${fe}%`},title:`Lucro: ${D(U.profit)}`})),a.createElement("div",{className:"mt-2 text-[11px] md:text-xs text-gray-600"},Ee,"/",ke,"/",Y))})))))}const wh=Cn(Fe,"goals");function Tx(t,e){const n=e?at(wh,zn("storeId","==",e)):at(wh);return na(n,r=>{const s=r.docs.map(i=>({id:i.id,...i.data()}));t(s)})}async function fp(t,e){const n={storeId:e,monthYear:t.monthYear,target:Number(t.target||0),includeSale:!!t.includeSale,includeServiceOrder:!!t.includeServiceOrder,sellerId:t.sellerId||"",sellerName:t.sellerName||"",createdAt:Ve(),updatedAt:Ve()};return(await ta(wh,n)).id}async function Ax(t,e){const n=mn(Fe,"goals",t);await $n(n,{...e,updatedAt:Ve()})}const NP=Object.freeze(Object.defineProperty({__proto__:null,addGoal:fp,listenGoals:Tx,updateGoal:Ax},Symbol.toStringTag,{value:"Module"}));function he({checked:t=!1,onChange:e,label:n,disabled:r=!1,className:s=""}){const i=()=>{r||e&&e(!t)},o=c=>{r||(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),i())};return a.createElement("div",{className:`flex items-center justify-between ${s}`},n?a.createElement("span",{className:`text-sm ${r?"text-gray-400":"text-gray-700"}`},n):null,a.createElement("button",{type:"button",role:"switch","aria-checked":t,"aria-disabled":r,onClick:i,onKeyDown:o,className:`relative inline-flex h-6 w-11 rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 ${r?"bg-gray-300 cursor-not-allowed":t?"bg-green-500":"bg-gray-300"} ${t?"focus:ring-green-500":"focus:ring-gray-400"}`},a.createElement("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white shadow transition ${t?"translate-x-5":"translate-x-0"}`})))}function bP({open:t,onClose:e,storeId:n}){const[r,s]=E.useState(""),[i,o]=E.useState("R$ 0,00"),[c,u]=E.useState(!1),[d,h]=E.useState(!1),[p,y]=E.useState(!1);if(!t)return null;function S(w){const _=String(w).replace(/\D/g,"").replace(/^0+/,"")||"0",v=_.length>2?_.slice(0,-2):"0",I=_.slice(-2).padStart(2,"0");return`R$ ${v.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${I}`}async function P(){if(!n)return e&&e();const w=r.trim();if(!w||!/^(0?[1-9]|1[0-2])\/(\d{4})$/.test(w))return;const A=Number(String(i).replace(/[^0-9.,]/g,"").replace(".","").replace(",","."));y(!0);try{await fp({monthYear:w,target:A,includeSale:c,includeServiceOrder:d},n),e&&e()}finally{y(!1)}}return a.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center"},a.createElement("div",{className:"absolute inset-0 bg-black/40",onClick:e}),a.createElement("div",{className:"relative bg-white rounded-lg shadow-lg w-[95vw] max-w-[520px]"},a.createElement("div",{className:"px-4 py-3 border-b"},a.createElement("h3",{className:"text-base font-medium"},"Definir Meta")),a.createElement("div",{className:"p-4 space-y-3"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Ms / Ano"),a.createElement("input",{value:r,onChange:w=>s(w.target.value),placeholder:"MM/AAAA",className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Meta"),a.createElement("input",{value:i,onChange:w=>o(S(w.target.value)),placeholder:"R$ 0,00",className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",{className:"pt-2"},a.createElement("div",{className:"text-xs text-gray-600 mb-2"},"Escolha os registros que deseja incluir:"),a.createElement("div",{className:"flex flex-col gap-3"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("span",{className:"text-sm"},"Venda"),a.createElement(he,{checked:c,onChange:u})),a.createElement("div",{className:"flex items-center justify-between"},a.createElement("span",{className:"text-sm"},"Ordem de Servio"),a.createElement(he,{checked:d,onChange:h}))))),a.createElement("div",{className:"px-4 py-3 border-t flex items-center justify-end gap-2"},a.createElement("button",{className:"px-3 py-2 text-sm rounded border",onClick:e,disabled:p},"Cancelar"),a.createElement("button",{className:"px-3 py-2 text-sm rounded bg-green-600 text-white",onClick:P,disabled:p},"Confirmar"))))}function SP({open:t,onClose:e,storeId:n,sellers:r=[]}){const[s,i]=E.useState(""),[o,c]=E.useState(""),[u,d]=E.useState("R$ 0,00"),[h,p]=E.useState(!1),y=E.useMemo(()=>r.map(w=>({id:w.id,name:w.name||"-"})),[r]);if(!t)return null;function S(w){const _=String(w).replace(/\D/g,"").replace(/^0+/,"")||"0",v=_.length>2?_.slice(0,-2):"0",I=_.slice(-2).padStart(2,"0");return`R$ ${v.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${I}`}async function P(){var v;const w=o.trim();if(!n||!s||!w||!/^(0?[1-9]|1[0-2])\/(\d{4})$/.test(w))return;const A=Number(String(u).replace(/[^0-9.,]/g,"").replace(".","").replace(",",".")),_=((v=y.find(I=>I.id===s))==null?void 0:v.name)||"";p(!0);try{await fp({monthYear:w,target:A,includeSale:!0,includeServiceOrder:!1,sellerId:s,sellerName:_},n),e&&e()}finally{p(!1)}}return a.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center"},a.createElement("div",{className:"absolute inset-0 bg-black/40",onClick:e}),a.createElement("div",{className:"relative bg-white rounded-lg shadow-lg w-[95vw] max-w-[560px]"},a.createElement("div",{className:"px-4 py-3 border-b"},a.createElement("h3",{className:"text-base font-medium"},"Definir Meta")),a.createElement("div",{className:"p-4 space-y-3"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Vendedor"),a.createElement("div",{className:"mt-1"},a.createElement("select",{value:s,onChange:w=>i(w.target.value),className:"w-full border rounded px-3 py-2 text-sm"},a.createElement("option",{value:""},"Selecione..."),y.map(w=>a.createElement("option",{key:w.id,value:w.id},w.name))))),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Ms / Ano"),a.createElement("input",{value:o,onChange:w=>c(w.target.value),placeholder:"MM/AAAA",className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Meta"),a.createElement("input",{value:u,onChange:w=>d(S(w.target.value)),placeholder:"R$ 0,00",className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",{className:"px-4 py-3 border-t flex items-center justify-end gap-2"},a.createElement("button",{className:"px-3 py-2 text-sm rounded border",onClick:e,disabled:h},"Cancelar"),a.createElement("button",{className:"px-3 py-2 text-sm rounded bg-green-600 text-white",onClick:P,disabled:h},"Confirmar"))))}const CP=Cn(Fe,"stores");async function IP(t){const e=at(CP,zn("ownerId","==",t));return(await Ws(e)).docs.map(r=>({id:r.id,...r.data()}))}async function TP(t){if(!t)return null;const e=mn(Fe,"stores",t),n=await iA(e);return n.exists()?{id:n.id,...n.data()}:null}async function AP(t,e){const n=mn(Fe,"stores",t);await $n(n,{...e,updatedAt:Ve()})}function kx(t){return Cn(Fe,"stores",t,"fees")}function kP(t,e,n){if(!t)return()=>{};const r=at(kx(t),ea("createdAt","desc"));return na(r,s=>{const i=s.docs.map(o=>({id:o.id,...o.data()}));e(i)},s=>{console.error("listenFees error",s),n&&n(s)})}async function PP(t,e){const n={name:e.name??"",value:typeof e.value=="number"?e.value:Number(e.value||0),type:e.type==="percent"?"percent":"fixed",active:e.active!==!1,createdAt:Ve(),updatedAt:Ve()};return(await ta(kx(t),n)).id}async function RP(t,e,n){const r=mn(Fe,"stores",t,"fees",e);await $n(r,{...n,updatedAt:Ve()})}const pp=Cn(Fe,"users");async function xh(t){const e=at(pp,zn("email","==",t)),n=await Ws(e);if(n.empty)return null;const r=n.docs[0];return{id:r.id,...r.data()}}async function DP(t,e){const n=mn(Fe,"users",t);await $n(n,{...e,updatedAt:Ve()})}function gp(t,e){const n=Cn(Fe,"users",t,"members"),r=at(n,ea("createdAt","desc"));return na(r,s=>{const i=s.docs.map(o=>({id:o.id,...o.data()}));e(i)})}async function Nh(t){const e=await Ws(pp);for(const n of e.docs){const r=n.id,s=Cn(Fe,"users",r,"members"),i=at(s,zn("email","==",t)),o=await Ws(i);if(!o.empty){const c=o.docs[0];return{id:c.id,ownerId:r,...c.data()}}}return null}async function VP(t,e){const n=Cn(Fe,"users",t,"members"),r=e.role??(e.isAdmin?"admin":e.isSeller?"manager":"staff"),s={name:e.name??"Usurio",email:e.email??"",password:e.password??"",whatsapp:e.whatsapp??"",isSeller:!!e.isSeller,isTech:!!e.isTech,isAdmin:!!e.isAdmin,allowDiscount:!!e.allowDiscount,discountMaxPercent:e.unlimitedDiscount?null:typeof e.discountMaxPercent=="number"?e.discountMaxPercent:null,unlimitedDiscount:!!e.unlimitedDiscount,role:r,active:e.active??!0,permissions:e.permissions??{},createdAt:Ve(),updatedAt:Ve()};return(await ta(n,s)).id}async function Px(t,e,n){const{password:r,...s}=n||{},i=mn(Fe,"users",t,"members",e);await $n(i,{...s,updatedAt:Ve()})}async function OP(t,e,n){if(!t)throw new Error("Usurio invlido");const r=at(pp,zn("__name__","==",t)),s=await Ws(r);if(s.empty)throw new Error("Usurio no encontrado");const o=s.docs[0].data();if(String((o==null?void 0:o.password)||"")!==String(e||""))throw new Error("Senha atual incorreta");const u=mn(Fe,"users",t);await $n(u,{password:String(n||""),updatedAt:Ve()})}async function MP(t,e,n,r){if(!t||!e)throw new Error("Usurio invlido");const s=Cn(Fe,"users",t,"members"),i=at(s,zn("__name__","==",e)),o=await Ws(i);if(o.empty)throw new Error("Usurio no encontrado");const u=o.docs[0].data();if(String((u==null?void 0:u.password)||"")!==String(n||""))throw new Error("Senha atual incorreta");const h=mn(Fe,"users",t,"members",e);await $n(h,{password:String(r||""),updatedAt:Ve()})}async function LP(t,e){const n=await xh(t);if(n){if(!(String(n.password||"")===String(e||"")))throw new Error("Senha incorreta");return n}const r=await Nh(t);if(!r)throw new Error("Usurio no encontrado no banco de dados");if(!(String(r.password||"")===String(e||"")))throw new Error("Senha incorreta");return{id:r.ownerId,ownerId:r.ownerId,memberId:r.id,name:r.name||"Usurio",email:r.email||t,role:r.role||"staff",isSeller:!!r.isSeller,isTech:!!r.isTech,isAdmin:!!r.isAdmin,active:r.active!==!1}}function FP({open:t,onClose:e,goal:n}){const[r,s]=E.useState(""),[i,o]=E.useState("R$ 0,00"),[c,u]=E.useState(!1),[d,h]=E.useState(!1),[p,y]=E.useState(!1);if(E.useEffect(()=>{if(n){s(n.monthYear||"");const A=Number(n.target||0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"});o(A),u(!!n.includeSale),h(!!n.includeServiceOrder)}},[n]),!t)return null;function S(w){const _=String(w).replace(/\D/g,"").replace(/^0+/,"")||"0",v=_.length>2?_.slice(0,-2):"0",I=_.slice(-2).padStart(2,"0");return`R$ ${v.replace(/\B(?=(\d{3})+(?!\d))/g,".")},${I}`}async function P(){if(!(n!=null&&n.id))return e&&e();const w=r.trim();if(!w||!/^(0?[1-9]|1[0-2])\/(\d{4})$/.test(w))return;const A=Number(String(i).replace(/[^0-9.,]/g,"").replace(".","").replace(",","."));y(!0);try{await Ax(n.id,{monthYear:w,target:A,includeSale:c,includeServiceOrder:d}),e&&e()}finally{y(!1)}}return a.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center"},a.createElement("div",{className:"absolute inset-0 bg-black/40",onClick:e}),a.createElement("div",{className:"relative bg-white rounded-lg shadow-lg w-[95vw] max-w-[520px]"},a.createElement("div",{className:"px-4 py-3 border-b"},a.createElement("h3",{className:"text-base font-medium"},"Editar Meta")),a.createElement("div",{className:"p-4 space-y-3"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Ms / Ano"),a.createElement("input",{value:r,onChange:w=>s(w.target.value),placeholder:"MM/AAAA",className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Meta"),a.createElement("input",{value:i,onChange:w=>o(S(w.target.value)),placeholder:"R$ 0,00",className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",{className:"pt-2"},a.createElement("div",{className:"text-xs text-gray-600 mb-2"},"Escolha os registros que deseja incluir:"),a.createElement("div",{className:"flex flex-col gap-3"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("span",{className:"text-sm"},"Venda"),a.createElement(he,{checked:c,onChange:u})),a.createElement("div",{className:"flex items-center justify-between"},a.createElement("span",{className:"text-sm"},"Ordem de Servio"),a.createElement(he,{checked:d,onChange:h}))))),a.createElement("div",{className:"px-4 py-3 border-t flex items-center justify-end gap-2"},a.createElement("button",{className:"px-3 py-2 text-sm rounded border",onClick:e,disabled:p},"Cancelar"),a.createElement("button",{className:"px-3 py-2 text-sm rounded bg-green-600 text-white",onClick:P,disabled:p},"Salvar"))))}function Ov(t){const e=String(t||"").match(/^(0?[1-9]|1[0-2])\/(\d{4})$/);return e?{month:Number(e[1]),year:Number(e[2])}:null}function Mv(t,e,n){return t.getMonth()+1===e&&t.getFullYear()===n}function Lv(t){var e;return(e=t==null?void 0:t.toDate)!=null&&e.call(t)?t.toDate():t?new Date(t):null}function UP(t){const e=(t||"").toLowerCase();return["os finalizada e faturada cliente final","os finalizada e faturada cliente logista"].includes(e)?!0:e.includes("finalizada")&&e.includes("faturada")&&(e.includes("cliente final")||e.includes("cliente logista"))}function jP({storeId:t,owner:e}){const[n,r]=E.useState([]),[s,i]=E.useState([]),[o,c]=E.useState(!1),[u,d]=E.useState(!1),[h,p]=E.useState(!1),[y,S]=E.useState(null),[P,w]=E.useState("empresa"),[A,_]=E.useState([]);E.useEffect(()=>{const V=Tx(x=>r(x),t),b=rd(x=>i(x),t);let g=null;return e!=null&&e.id&&(g=gp(e.id,x=>_(x.filter(T=>T.isSeller||/vendedor/i.test(String(T.name||"")))))),()=>{V&&V(),b&&b(),g&&g()}},[t,e==null?void 0:e.id]);const v=E.useMemo(()=>n.filter(V=>!V.sellerId).map(V=>{const b=Ov(V.monthYear);let g=0;if(b){const{month:x,year:T}=b,k=s.filter(C=>{const te=Lv(C.createdAt);return!!te&&Mv(te,x,T)&&(C.status||"").toLowerCase()==="venda"}),R=s.filter(C=>{const te=Lv(C.createdAt);return!!te&&Mv(te,x,T)&&UP(C.status)});V.includeSale&&(g+=k.reduce((C,te)=>C+Number(te.valor||te.total||0),0)),V.includeServiceOrder&&(g+=R.reduce((C,te)=>C+Number(te.total||te.valor||0),0))}return{...V,value:g}}),[n,s]),I=E.useMemo(()=>n.filter(V=>!!V.sellerId).map(V=>{var T;const b=Ov(V.monthYear);let g=0;if(b){const{month:k,year:R}=b;g=0}const x=V.sellerName||((T=A.find(k=>k.id===V.sellerId))==null?void 0:T.name)||"-";return{...V,value:g,sellerName:x}}),[n,s,A]),D=V=>Number(V||0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),M=V=>V.includeSale&&V.includeServiceOrder?"Venda + Ordem de Servio":V.includeSale?"Venda":"Ordem de Servio";return a.createElement("div",{className:"rounded-lg bg-white p-4 md:p-6 shadow"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("h2",{className:"text-lg font-semibold"},"Metas"),P==="empresa"?a.createElement("button",{className:"h-9 px-3 rounded bg-green-600 text-white text-sm",onClick:()=>c(!0)},"+ Novo"):a.createElement("button",{className:"h-9 px-3 rounded bg-green-600 text-white text-sm",onClick:()=>d(!0)},"+ Novo")),a.createElement("div",{className:"mt-4 flex items-center gap-6 text-sm"},a.createElement("button",{onClick:()=>w("empresa"),className:`pb-2 ${P==="empresa"?"text-green-600 border-b-2 border-green-600 font-semibold":"text-gray-600"}`},"Empresa"),a.createElement("button",{onClick:()=>w("vendedor"),className:`pb-2 ${P==="vendedor"?"text-green-600 border-b-2 border-green-600 font-semibold":"text-gray-600"}`},"Vendedor")),P==="empresa"?a.createElement("div",{className:"mt-4 overflow-hidden rounded-lg border"},a.createElement("div",{className:"grid grid-cols-[12rem_12rem_12rem_1fr] px-4 py-3 text-xs text-gray-500 border-b"},a.createElement("div",null,"Ms"),a.createElement("div",null,"Valor"),a.createElement("div",null,"Meta"),a.createElement("div",{className:"text-left"},"Tipo")),v.map(V=>a.createElement("button",{key:V.id,type:"button",className:"grid grid-cols-[12rem_12rem_12rem_1fr] items-center px-4 py-3 border-b last:border-0 text-left hover:bg-gray-50",onClick:()=>{S(V),p(!0)}},a.createElement("div",{className:"text-sm"},V.monthYear),a.createElement("div",{className:"text-sm"},D(V.value)),a.createElement("div",{className:"text-sm"},D(V.target)),a.createElement("div",{className:"text-sm"},a.createElement("span",{className:"inline-flex items-center px-2 py-1 rounded bg-green-50 text-green-700 text-xs border border-green-200"},M(V))))),!v.length&&a.createElement("div",{className:"px-4 py-6 text-sm text-gray-600"},"Nenhuma meta definida.")):a.createElement("div",{className:"mt-4 overflow-hidden rounded-lg border"},a.createElement("div",{className:"grid grid-cols-[10rem_12rem_1fr_12rem_8rem] px-4 py-3 text-xs text-gray-500 border-b"},a.createElement("div",null,"Ms"),a.createElement("div",null,"Valor"),a.createElement("div",null,"Vendedor"),a.createElement("div",null,"Meta"),a.createElement("div",{className:"text-left"},"Tipo")),I.map(V=>a.createElement("div",{key:V.id,className:"grid grid-cols-[10rem_12rem_1fr_12rem_8rem] items-center px-4 py-3 border-b last:border-0"},a.createElement("div",{className:"text-sm"},V.monthYear),a.createElement("div",{className:"text-sm"},D(V.value)),a.createElement("div",{className:"text-sm"},V.sellerName),a.createElement("div",{className:"text-sm"},D(V.target)),a.createElement("div",{className:"text-sm"},a.createElement("span",{className:"inline-flex items-center px-2 py-1 rounded bg-green-50 text-green-700 text-xs border border-green-200"},"Venda")))),!I.length&&a.createElement("div",{className:"px-4 py-6 text-sm text-gray-600"},"Nenhuma meta de vendedor definida.")),a.createElement(bP,{open:o,onClose:()=>c(!1),storeId:t}),a.createElement(FP,{open:h,onClose:()=>{p(!1),S(null)},goal:y}),a.createElement(SP,{open:u,onClose:()=>d(!1),storeId:t,sellers:A}))}function Zl({open:t,onClose:e,clients:n=[],onChoose:r,onNew:s}){const[i,o]=E.useState("");if(!t)return null;const c=(n||[]).filter(u=>(u.name||"").toLowerCase().includes(i.trim().toLowerCase()));return a.createElement("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-[70]"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg w-[700px] max-w-[95vw]"},a.createElement("div",{className:"flex items-center justify-between p-4 border-b"},a.createElement("h3",{className:"font-semibold text-lg"},"Selecionar cliente"),a.createElement("button",{onClick:s,className:"px-3 py-1 rounded text-xs bg-green-600 text-white"},"+ Novo")),a.createElement("div",{className:"p-4"},a.createElement("div",{className:"flex items-center gap-2"},a.createElement("input",{value:i,onChange:u=>o(u.target.value),placeholder:"Pesquisar...",className:"flex-1 border rounded px-3 py-2 text-sm"})),a.createElement("div",{className:"mt-3 max-h-[60vh] overflow-y-auto"},c.map(u=>a.createElement("div",{key:u.id,className:"grid grid-cols-[1fr_2rem] items-center gap-3 px-2 py-3 border-b last:border-0 text-sm cursor-pointer",onClick:()=>r&&r(u)},a.createElement("div",{className:"font-medium"},u.name),a.createElement("div",{className:"text-right text-gray-400"},""))),c.length===0&&a.createElement("div",{className:"px-2 py-3 text-sm text-gray-600"},"Nenhum cliente encontrado."))),a.createElement("div",{className:"p-4 border-t flex items-center justify-end gap-2"},a.createElement("button",{type:"button",onClick:e,className:"px-3 py-2 border rounded text-sm"},"Fechar"))))}function BP({storeId:t,ownerId:e,addNewSignal:n}){const[r,s]=E.useState("list"),[i,o]=E.useState(""),[c,u]=E.useState(!1),[d,h]=E.useState(!1),[p,y]=E.useState([]);E.useEffect(()=>{const O=rd(ie=>y(ie),t);return()=>O&&O()},[t]);const S=E.useRef(n),P=E.useMemo(()=>{const O=i.trim().toLowerCase();return O?p.filter(ie=>String(ie.id).includes(O)||(ie.client||"").toLowerCase().includes(O)||(ie.technician||"").toLowerCase().includes(O)||(ie.model||"").toLowerCase().includes(O)):p},[p,i]),w=E.useMemo(()=>p.filter(O=>(O.status||"").toLowerCase().includes("finalizada")).reduce((O,ie)=>O+(ie.valor||0),0),[p]),A=E.useMemo(()=>p.filter(O=>(O.status||"").toLowerCase().includes("finalizada")).length,[p]),_=E.useMemo(()=>A>0?w/A:0,[A,w]),[v,I]=E.useState(""),[D,M]=E.useState(!1),[V,b]=E.useState(!1),[g,x]=E.useState([]),[T,k]=E.useState(""),[R,C]=E.useState(""),[te,Se]=E.useState([]),[we,Ae]=E.useState(!1),[H,q]=E.useState(!1),[Z,K]=E.useState(""),[se,U]=E.useState(""),[G,re]=E.useState(""),[fe,Ee]=E.useState(""),[ke,Y]=E.useState(""),[ae,it]=E.useState(""),[ot,oe]=E.useState(""),[Je,tn]=E.useState(""),[ce,_t]=E.useState(""),[sr,ze]=E.useState(`Garantia de produtos e servios.
90 dias para defeito de fabricao.
No cobre produto quebrado.
No cobre riscos na tela
No cobre trincos na tela.`),[$,Ce]=E.useState(!1),[qt,Pe]=E.useState("Iniciado"),[In,J]=E.useState(!1),[Ze,wt]=E.useState([]),[lt,xt]=E.useState(!1),[Wt,hn]=E.useState(!1),[Hn,Tn]=E.useState(!1),[$e,ar]=E.useState(null),[fn,Zr]=E.useState(1),[qn,es]=E.useState("0"),[nn,ra]=E.useState([]),[et,sa]=E.useState([]),[An,kn]=E.useState([]),[ir,Pn]=E.useState(!1),[Nt,Pr]=E.useState(null),[ts,or]=E.useState(null),[aa,ns]=E.useState("");E.useEffect(()=>{if($e){let O=$e.salePrice??$e.priceMin??0;Nt&&(O=Nt.promoPrice??Nt.salePrice??O),es(String(O))}},[$e,Nt]),E.useEffect(()=>{const O=Sx(At=>ra(At),t),ie=Cx(At=>sa(At),t),de=Ix(At=>kn(At),t),He=bx(At=>x(At),t);let gn;return e&&(gn=gp(e,At=>Se(At.filter(Bi=>Bi.active??!0)))),()=>{O&&O(),ie&&ie(),de&&de(),He&&He(),gn&&gn()}},[t,e]);const Gt=E.useMemo(()=>Ze.reduce((O,ie)=>O+(parseFloat(ie.price)||0)*(parseFloat(ie.quantity)||0),0),[Ze]),[Kt,Rn]=E.useState([]),[Mt,pn]=E.useState(!1),[Wn,Lt]=E.useState(!1),[tt,rs]=E.useState(null),[ss,as]=E.useState(""),[B,ye]=E.useState(""),[Qt,ht]=E.useState(!1),[lr,Dn]=E.useState(!1),[is,cr]=E.useState(!1),[ia,os]=E.useState(0),oa=E.useMemo(()=>Kt.reduce((O,ie)=>O+(parseFloat(ie.amount)||0),0),[Kt]),ft=E.useMemo(()=>{const O=(parseFloat(Gt)||0)-(parseFloat(oa)||0);return O>0?O:0},[Gt,oa]),Yt=E.useMemo(()=>te.filter(O=>(O.isTech??!1)||/t[e]cnico/i.test(String(O.name||""))),[te]),Rr=E.useMemo(()=>{const O=ie=>String(ie.role||"").toLowerCase();return te.filter(ie=>(ie.isSeller??!1)||/atendente|vendedor/i.test(String(ie.name||""))||O(ie).includes("attendant")||O(ie).includes("seller"))},[te]),Ba=()=>{I(""),k(""),C(""),K(""),U(""),re(""),Ee(""),Y(""),it(""),oe(""),tn(""),_t(""),ze(`Garantia de produtos e servios.
90 dias para defeito de fabricao.
No cobre produto quebrado.
No cobre riscos na tela
No cobre trincos na tela.`),wt([]),Rn([]),or(null),ns(""),Pe("Iniciado")};E.useEffect(()=>{S.current!==n&&(Ba(),s("new"),S.current=n)},[n]);const ji=O=>{if(!O)return"";const ie=O!=null&&O.seconds?new Date(O.seconds*1e3):new Date(O),de=ad=>String(ad).padStart(2,"0"),He=ie.getFullYear(),gn=de(ie.getMonth()+1),At=de(ie.getDate()),Bi=de(ie.getHours()),wl=de(ie.getMinutes());return`${He}-${gn}-${At}T${Bi}:${wl}`},sd=O=>{I(O.client||""),k(O.technician||""),C(O.attendant||""),K(ji(O.dateIn)||""),U(ji(O.expectedDate)||""),re(O.brand||""),Ee(O.model||""),Y(O.serialNumber||""),it(O.equipment||""),oe(O.problem||""),tn(O.receiptNotes||""),_t(O.internalNotes||""),wt(Array.isArray(O.products)?O.products:[]),Rn(Array.isArray(O.payments)?O.payments:[]),or(O.id),ns(O.number||O.id),Pe(O.status||"Iniciado"),s("edit")},ur=async()=>{if(!$){Ce(!0);try{const O={client:v,technician:T,attendant:R,dateIn:Z?new Date(Z):null,expectedDate:se?new Date(se):null,brand:G,model:fe,serialNumber:ke,equipment:ae,problem:ot,receiptNotes:Je,internalNotes:ce,services:[],products:Ze,totalServices:0,totalProducts:Gt,discount:0,total:Gt,valor:Gt,payments:Kt,password:"",checklist:[],files:[],status:qt};ts?await pP(ts,O):await fP({...O},t),Ba(),s("list")}catch(O){console.error("Erro ao salvar OS",O),alert("Erro ao salvar OS. Verifique o console.")}finally{Ce(!1)}}},Vn=()=>{ar(null),Zr(1),es("0"),xt(!0)},la=O=>{wt(ie=>ie.filter((de,He)=>He!==O))};return a.createElement("div",null,r==="list"?a.createElement(a.Fragment,null,a.createElement("div",{className:"bg-white rounded-lg p-4 shadow"},a.createElement("div",{className:"flex items-center gap-6 text-sm"},a.createElement("button",{className:"pb-2 text-green-600 border-b-2 border-green-600 font-semibold"},"Ordens De Servio"),a.createElement("button",{className:"pb-2 text-gray-600"},"Servios")),a.createElement("div",{className:"mt-4 flex items-center gap-3"},a.createElement("div",{className:"flex-1 flex items-center gap-2"},a.createElement("input",{value:i,onChange:O=>o(O.target.value),placeholder:"Pesquisar...",className:"flex-1 border rounded px-3 py-2 text-sm"}),a.createElement("button",{type:"button",onClick:()=>u(O=>!O),className:"h-9 w-9 border rounded flex items-center justify-center md:h-auto md:w-auto md:px-3 md:py-2 text-sm","aria-label":"Perodo",title:"Perodo"},a.createElement("span",{className:"md:hidden"},""),a.createElement("span",{className:"hidden md:inline"}," Perodo")),a.createElement("button",{type:"button",onClick:()=>h(O=>!O),className:"h-9 w-9 border rounded flex items-center justify-center md:h-auto md:w-auto md:px-3 md:py-2 text-sm","aria-label":"Filtros",title:"Filtros"},a.createElement("span",{className:"md:hidden"},""),a.createElement("span",{className:"hidden md:inline"}," Filtros"))),a.createElement("div",{className:"hidden md:block flex-1"}),a.createElement("button",{className:"hidden md:inline-block px-3 py-2 border rounded text-sm"},"Opes"),a.createElement("button",{onClick:()=>{Ba(),s("new")},className:"hidden md:inline-block px-3 py-2 rounded text-sm bg-green-600 text-white"},"+ Nova"))),a.createElement("div",{className:"mt-4 grid grid-cols-3 gap-4"},a.createElement("div",{className:"bg-white p-4 rounded shadow"},a.createElement("div",{className:"text-xs text-gray-500"},"Total"),a.createElement("div",{className:"text-green-700 font-semibold"},w.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}))),a.createElement("div",{className:"bg-white p-4 rounded shadow"},a.createElement("div",{className:"text-xs text-gray-500"},"OS's realizadas"),a.createElement("div",{className:"font-semibold"},A)),a.createElement("div",{className:"bg-white p-4 rounded shadow"},a.createElement("div",{className:"text-xs text-gray-500"},"Ticket Mdio"),a.createElement("div",{className:"font-semibold"},_.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})))),a.createElement("div",{className:"mt-4 bg-white rounded-lg shadow overflow-hidden"},a.createElement("div",{className:"overflow-x-auto"},a.createElement("div",{className:"min-w-[1200px] grid grid-cols-[4rem_1fr_8rem_8rem_10rem_10rem_8rem_10rem_8rem_14rem] items-center px-4 py-3 text-xs text-gray-500 border-b gap-3"},a.createElement("div",null,"O.S."),a.createElement("div",null,"Cliente"),a.createElement("div",null,"Atendente"),a.createElement("div",null,"Tcnico"),a.createElement("div",null,"Modelo"),a.createElement("div",null,"N de Srie"),a.createElement("div",null,"Data de abertura"),a.createElement("div",null,"Previso de entrega"),a.createElement("div",{className:"text-right"},"Valor"),a.createElement("div",null,"Status")),a.createElement("div",{className:"min-w-[1200px] divide-y divide-gray-200"},P.map(O=>a.createElement("div",{key:O.id,onClick:()=>sd(O),className:"grid grid-cols-[4rem_1fr_8rem_8rem_10rem_10rem_8rem_10rem_8rem_14rem] items-center px-4 py-3 text-sm cursor-pointer hover:bg-gray-50 gap-3"},a.createElement("div",null,O.number||O.id),a.createElement("div",{className:"leading-tight"},a.createElement("div",{className:"font-medium"},O.client)),a.createElement("div",null,O.attendant),a.createElement("div",null,O.technician),a.createElement("div",null,O.model),a.createElement("div",null,O.serialNumber),a.createElement("div",null,O.dateIn?new Date(O.dateIn.seconds?O.dateIn.seconds*1e3:O.dateIn).toLocaleDateString("pt-BR"):"-"),a.createElement("div",null,O.expectedDate?new Date(O.expectedDate.seconds?O.expectedDate.seconds*1e3:O.expectedDate).toLocaleDateString("pt-BR"):"-"),a.createElement("div",{className:"text-right"},(O.total??O.totalProducts??O.valor??(Array.isArray(O.products)?O.products.reduce((ie,de)=>ie+(parseFloat(de.price)||0)*(parseFloat(de.quantity)||0),0):0)).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),a.createElement("div",null,(()=>{const ie=String(O.status||"").trim(),de=ie.toLowerCase();let He="bg-gray-200 text-gray-700";return de.includes("finaliz")?He="bg-green-100 text-green-700":de.includes("cancel")?He="bg-red-100 text-red-700":de.includes("garantia")?He="bg-purple-100 text-purple-700":(de.includes("aguardando")||de.includes("pea"))&&(He="bg-amber-100 text-amber-700"),a.createElement("span",{className:`px-2 py-1 rounded text-xs ${He}`},ie||"-")})()))))))):a.createElement("div",{className:"mt-2"},a.createElement("div",{className:"flex items-center justify-between mb-3"},a.createElement("button",{onClick:()=>s("list"),className:"px-3 py-2 border rounded text-sm"}," Voltar"),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("button",{className:"px-3 py-2 border rounded text-sm"},"Opes"),a.createElement("button",{className:"px-3 py-2 rounded text-sm bg-green-600 text-white"},"+ Nova"))),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},a.createElement("div",{className:"font-semibold text-lg"},"Dados Gerais"),a.createElement("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Cliente"),a.createElement("input",{readOnly:!0,value:v,onClick:()=>M(!0),className:"mt-1 w-full border rounded px-3 py-2 text-sm cursor-pointer bg-gray-50",placeholder:"Selecionar cliente"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Tcnico"),a.createElement("input",{readOnly:!0,value:T,onClick:()=>Ae(!0),className:"mt-1 w-full border rounded px-3 py-2 text-sm cursor-pointer bg-gray-50",placeholder:"Selecionar tcnico"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Atendente"),a.createElement("input",{readOnly:!0,value:R,onClick:()=>q(!0),className:"mt-1 w-full border rounded px-3 py-2 text-sm cursor-pointer bg-gray-50",placeholder:"Selecionar atendente"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Data Entrada"),a.createElement("input",{type:"datetime-local",value:Z,onChange:O=>K(O.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Previso de entrega"),a.createElement("input",{type:"datetime-local",value:se,onChange:O=>U(O.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Marca"),a.createElement("input",{value:G,onChange:O=>re(O.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Modelo"),a.createElement("input",{value:fe,onChange:O=>Ee(O.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Nmero de srie"),a.createElement("input",{value:ke,onChange:O=>Y(O.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Equipamento"),a.createElement("textarea",{value:ae,onChange:O=>it(O.target.value),rows:4,className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Problema"),a.createElement("textarea",{value:ot,onChange:O=>oe(O.target.value),rows:4,className:"mt-1 w-full border rounded px-3 py-2 text-sm"}))),a.createElement("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Observaes de recebimento"),a.createElement("textarea",{value:Je,onChange:O=>tn(O.target.value),rows:4,className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Observaes internas"),a.createElement("textarea",{value:ce,onChange:O=>_t(O.target.value),rows:4,className:"mt-1 w-full border rounded px-3 py-2 text-sm"})))),a.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},a.createElement("div",{className:"font-semibold text-lg"},"Outros"),a.createElement("div",{className:"mt-4 flex gap-3"},a.createElement("button",{type:"button",className:"px-3 py-2 border rounded text-sm"},"Adicionar Senha"),a.createElement("button",{type:"button",className:"px-3 py-2 border rounded text-sm"},"Adicionar Checklist"),a.createElement("button",{type:"button",className:"px-3 py-2 border rounded text-sm"},"Adicionar Arquivo"))),a.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},a.createElement("div",{className:"font-semibold text-lg"},"Servios"),a.createElement("div",{className:"mt-3 text-sm text-gray-600"},"Nenhum servio adicionado..."),a.createElement("div",{className:"mt-3"},a.createElement("button",{type:"button",className:"px-3 py-2 border rounded text-sm"},"Adicionar Servio"))),a.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},a.createElement("div",{className:"font-semibold text-lg"},"Produtos"),Ze.length===0?a.createElement("div",{className:"mt-3 text-sm text-gray-600"},"Nenhum produto adicionado..."):a.createElement("div",{className:"mt-3"},Ze.map((O,ie)=>a.createElement("div",{key:ie,className:"grid grid-cols-[1fr_6rem_8rem_2rem] items-center gap-3 py-2 border-b last:border-0 text-sm"},a.createElement("div",null,a.createElement("div",{className:"font-medium"},O.name),O.variationName&&a.createElement("div",{className:"text-xs text-gray-600"}," ",O.variationName)),a.createElement("div",{className:"text-right"},O.quantity),a.createElement("div",{className:"text-right"},(O.price*O.quantity).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),a.createElement("button",{type:"button",onClick:()=>la(ie),className:"text-gray-500"},"")))),a.createElement("div",{className:"mt-3"},a.createElement("button",{type:"button",onClick:Vn,className:"px-3 py-2 border rounded text-sm"},"Adicionar Produto")))),a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},a.createElement("div",{className:"font-semibold text-lg"},"Total"),a.createElement("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4"},a.createElement("div",{className:"p-3 border rounded"},a.createElement("div",{className:"text-xs text-gray-500"},"Total de servios"),a.createElement("div",{className:"text-right"},0 .toLocaleString("pt-BR",{style:"currency",currency:"BRL"}))),a.createElement("div",{className:"p-3 border rounded"},a.createElement("div",{className:"text-xs text-gray-500"},"Total de produtos"),a.createElement("div",{className:"text-right"},Gt.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}))),a.createElement("div",{className:"p-3 border rounded"},a.createElement("div",{className:"text-xs text-gray-500"},"Desconto"),a.createElement("div",{className:"text-right"},0 .toLocaleString("pt-BR",{style:"currency",currency:"BRL"}))),a.createElement("div",{className:"p-3 border rounded"},a.createElement("div",{className:"text-xs text-gray-500"},"Total da OS"),a.createElement("div",{className:"text-right"},Gt.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}))))),a.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},a.createElement("div",{className:"font-semibold text-lg"},"Pagamento"),Kt.length===0?a.createElement("div",{className:"mt-3 text-sm text-gray-600"},"Nenhum pagamento adicionado..."):a.createElement("div",{className:"mt-3 space-y-2"},Kt.map((O,ie)=>a.createElement("div",{key:ie,className:"grid grid-cols-[1fr_8rem] items-center gap-3 text-sm"},a.createElement("div",{className:"leading-tight"},a.createElement("div",{className:"font-medium"},O.method),O.change>0&&a.createElement("div",{className:"text-xs text-gray-600"},"Troco: ",O.change.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}))),a.createElement("div",{className:"text-right"},O.amount.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})))),a.createElement("div",{className:"grid grid-cols-[1fr_8rem] items-center gap-3 text-sm border-t pt-2 mt-2"},a.createElement("div",{className:"text-gray-600"},"Restante a pagar"),a.createElement("div",{className:"text-right font-semibold"},ft.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})))),a.createElement("div",{className:"mt-3"},a.createElement("button",{type:"button",onClick:()=>pn(!0),className:"px-3 py-2 border rounded text-sm"},"Editar Pagamento"))),a.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},a.createElement("div",{className:"font-semibold text-lg"},"Observaes"),a.createElement("textarea",{rows:3,className:"mt-3 w-full border rounded px-3 py-2 text-sm",placeholder:"Observaes do servio"}),a.createElement("div",{className:"mt-6"},a.createElement("div",{className:"text-sm text-gray-600"},"Informaes de garantia"),a.createElement("textarea",{rows:6,value:sr,onChange:O=>ze(O.target.value),className:"mt-2 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",{className:"mt-4"},a.createElement("div",{className:"text-sm text-gray-700"},"Status atual: ",a.createElement("span",{className:"inline-block px-2 py-1 rounded bg-gray-100 border text-gray-800"},qt))),a.createElement("div",{className:"mt-6 flex items-center justify-end gap-3"},a.createElement("button",{type:"button",onClick:()=>J(!0),className:"px-3 py-2 border rounded text-sm"},"Alterar Status"),a.createElement("button",{type:"button",className:"px-3 py-2 border rounded text-sm"},"Salvar e Imprimir"),a.createElement("button",{disabled:$,type:"button",onClick:ur,className:"px-3 py-2 rounded text-sm bg-green-600 text-white disabled:opacity-60"},"Salvar"))))),lt&&a.createElement(KP,{open:lt,onClose:()=>xt(!1),product:$e,variation:Nt,onOpenSelect:()=>hn(!0),onOpenVariation:()=>{$e&&$e.variations>0&&$e.variationsData&&$e.variationsData.length>0&&Pn(!0)},qty:fn,setQty:Zr,price:qn,setPrice:es,onConfirm:()=>{if(!$e)return;const O={productId:$e.id,name:$e.name,variationName:Nt?Nt.name:null,price:parseFloat(qn)||0,quantity:parseFloat(fn)||1};wt(ie=>[...ie,O]),xt(!1)}}),Wt&&a.createElement(Uv,{open:Wt,onClose:()=>hn(!1),products:nn,onChoose:O=>{ar(O),Pr(null),hn(!1),O.variations>0&&O.variationsData&&O.variationsData.length>0?Pn(!0):xt(!0)},onNew:()=>{hn(!1),Tn(!0)}}),ir&&a.createElement(Fv,{open:ir,onClose:()=>Pn(!1),product:$e,onChoose:O=>{Pr(O),Pn(!1),xt(!0)}}),a.createElement(gu,{open:Hn,onClose:()=>Tn(!1),categories:et,suppliers:An,storeId:t}),D&&a.createElement(Zl,{open:D,onClose:()=>M(!1),clients:g,onChoose:O=>{I(O.name||""),M(!1)},onNew:()=>{M(!1),b(!0)}}),a.createElement(pu,{open:V,onClose:()=>b(!1),storeId:t}),we&&a.createElement(Zl,{open:we,onClose:()=>Ae(!1),clients:Yt,onChoose:O=>{k(O.name||""),Ae(!1)}}),H&&a.createElement(Zl,{open:H,onClose:()=>q(!1),clients:Rr,onChoose:O=>{C(O.name||""),q(!1)}}),In&&a.createElement(zP,{open:In,onClose:()=>J(!1),initialDate:Z,initialStatus:qt,internalNotes:ce,receiptNotes:Je,onConfirm:O=>{Pe(O.status),K(O.dateIn),_t(O.internalNotes),tn(O.receiptNotes),J(!1)}}),Mt&&a.createElement($P,{open:Mt,onClose:()=>pn(!1),remaining:ft,payments:Kt,onRemovePayment:O=>Rn(ie=>ie.filter((de,He)=>He!==O)),onChooseMethod:O=>{rs(O),as(String(ft)),ye(""),Lt(!0)},onConfirm:()=>pn(!1)}),Wn&&a.createElement(HP,{open:Wn,onClose:()=>Lt(!1),method:tt,remaining:ft,amount:ss,setAmount:as,error:B,setError:ye,onConfirm:()=>{const O=parseFloat(ss)||0;if(tt)if(tt.code==="cash"){const ie=Math.min(O,ft),de=Math.max(O-ft,0),He=Math.max(ft-ie,0);Rn(gn=>[...gn,{method:tt.label,methodCode:tt.code,amount:ie,change:de}]),Lt(!1),os(He),He>0&&cr(!0)}else{if(O>ft){Lt(!1),ht(!0);return}const ie=Math.max(ft-O,0);Rn(de=>[...de,{method:tt.label,methodCode:tt.code,amount:O}]),Lt(!1),os(ie),ie>0&&cr(!0)}}}),Qt&&a.createElement(qP,{open:Qt,amount:parseFloat(ss)||0,remaining:ft,method:tt,onCancel:()=>{ht(!1),Lt(!0)},onConfirm:()=>{const O=parseFloat(ss)||0,ie=Math.min(O,ft),de=Math.max(ft-ie,0);Rn(He=>[...He,{method:tt==null?void 0:tt.label,methodCode:tt==null?void 0:tt.code,amount:ie}]),ht(!1),Dn(!0),os(de),de>0&&cr(!0)}}),is&&a.createElement(WP,{open:is,remaining:ia,onClose:()=>cr(!1),onAddMore:()=>{cr(!1),pn(!0)}}),lr&&a.createElement(GP,{open:lr,method:tt,remaining:ia,onClose:()=>Dn(!1)}),Wt&&a.createElement(Uv,{open:Wt,onClose:()=>hn(!1),products:nn,onChoose:O=>{ar(O),Pr(null),hn(!1),O.variations>0&&O.variationsData&&O.variationsData.length>0?Pn(!0):xt(!0)},onNew:()=>{hn(!1),Tn(!0)}}),ir&&a.createElement(Fv,{open:ir,onClose:()=>Pn(!1),product:$e,onChoose:O=>{Pr(O),Pn(!1),xt(!0)}}),a.createElement(gu,{open:Hn,onClose:()=>Tn(!1),categories:et,suppliers:An,storeId:t}),D&&a.createElement(Zl,{open:D,onClose:()=>M(!1),clients:g,onChoose:O=>{I(O.name||""),M(!1)},onNew:()=>{M(!1),b(!0)}}),a.createElement(pu,{open:V,onClose:()=>b(!1),storeId:t})))}function Fv({open:t,onClose:e,product:n,onChoose:r}){const[s,i]=E.useState("");if(!t||!n)return null;const c=(n.variationsData||[]).filter(u=>(u.name||"").toLowerCase().includes(s.trim().toLowerCase()));return a.createElement("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg w-[680px] max-w-[95vw]"},a.createElement("div",{className:"flex items-center justify-between p-4 border-b"},a.createElement("h3",{className:"font-semibold text-lg"},"Selecionar Variao"),a.createElement("button",{onClick:e,className:"text-gray-400 hover:text-gray-600"},"")),a.createElement("div",{className:"p-4"},a.createElement("input",{value:s,onChange:u=>i(u.target.value),placeholder:"Pesquisar variao...",className:"w-full border rounded px-3 py-2 text-sm"}),a.createElement("div",{className:"mt-3 max-h-[60vh] overflow-y-auto"},c.map((u,d)=>{const h=u.promoPrice??u.salePrice??0,p=u.stock??u.stockInitial??0;return a.createElement("div",{key:d,className:"grid grid-cols-[1fr_8rem_6rem] items-center gap-3 px-2 py-3 border-b last:border-0 text-sm cursor-pointer hover:bg-gray-50",onClick:()=>r(u)},a.createElement("div",null,a.createElement("div",{className:"font-medium"},u.name)),a.createElement("div",{className:"text-right"},h.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),a.createElement("div",{className:"text-right text-gray-600"},"Est: ",p))}),c.length===0&&a.createElement("div",{className:"text-sm text-gray-600 px-2 py-3"},"Nenhuma variao encontrada."))),a.createElement("div",{className:"p-4 border-t flex items-center justify-end"},a.createElement("button",{type:"button",onClick:e,className:"px-3 py-2 border rounded text-sm"},"Voltar"))))}function zP({open:t,onClose:e,initialDate:n,initialStatus:r,internalNotes:s,receiptNotes:i,onConfirm:o}){const[c,u]=E.useState(n||""),[d,h]=E.useState(r||"Iniciado"),[p,y]=E.useState(s||""),[S,P]=E.useState(i||"");if(!t)return null;const w=["Iniciado","Finalizado","Os Finalizada e Faturada Cliente Final","Cancelado","Servio Aprovado Em Procedimento Com tecnico","Os Finalizada e Faturada Cliente lojista","Servio Realizado Pronto Na gaveta","Servio No Aprovado P/cliente Devoluao na gaveta","Garantia de Pea e Servio Cliente lojista","Devoluo cliente Lojista J na gaveta","Pea Para Troca e Devoluo ao Fornecedor","Servio Aguardando Pea Na Gaveta","Devoluo Cliente Final J na gaveta","Garantia de Pea e Servio Cliente Final","Servio No Realizado Devoluo Na gaveta","Servio em Oramento com tecnico","Os j devolvido ao Cliente final - Sem Conserto","Os j devolvida ao lojista - Sem conserto","Devoluo j entreque ao cliente"];return a.createElement("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95vw]"},a.createElement("div",{className:"flex items-center justify-between p-4 border-b"},a.createElement("h3",{className:"font-semibold text-lg"},"Atualizar Status"),a.createElement("button",{onClick:e,className:"text-gray-500 hover:text-gray-700"},"")),a.createElement("div",{className:"p-4 space-y-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Data de Entrada"),a.createElement("input",{type:"datetime-local",value:c,onChange:A=>u(A.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Status"),a.createElement("select",{value:d,onChange:A=>h(A.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"},w.map(A=>a.createElement("option",{key:A,value:A},A)))),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Observaes Internas"),a.createElement("textarea",{rows:3,value:p,onChange:A=>y(A.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Observaes para o cliente"),a.createElement("textarea",{rows:3,value:S,onChange:A=>P(A.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",{className:"text-xs text-gray-600"},"* As informaes acima sero atualizadas aps confirmar.")),a.createElement("div",{className:"p-4 border-t flex items-center justify-end gap-2"},a.createElement("button",{type:"button",onClick:e,className:"px-3 py-2 border rounded text-sm"},"Cancelar"),a.createElement("button",{type:"button",onClick:()=>o&&o({status:d,dateIn:c||"",internalNotes:p,receiptNotes:S}),className:"px-3 py-2 rounded text-sm bg-green-600 text-white"},"Confirmar"))))}function $P({open:t,onClose:e,onChoose:n,onChooseMethod:r,onConfirm:s,remaining:i,payments:o,onRemovePayment:c}){if(!t)return null;const u=n||r,d=[{code:"cash",label:"Dinheiro",icon:a.createElement("svg",{className:"w-8 h-8 text-green-600",fill:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{d:"M7,15H9C9,16.08 10.37,17 12,17C13.63,17 15,16.08 15,15C15,13.9 13.96,13.5 11.76,12.97C9.64,12.44 7,11.78 7,9C7,7.21 8.47,5.69 10.5,5.18V3H13.5V5.18C15.53,5.69 17,7.21 17,9H15C15,7.92 13.63,7 12,7C10.37,7 9,7.92 9,9C9,10.1 10.04,10.5 12.24,11.03C14.36,11.56 17,12.22 17,15C17,16.79 15.53,18.31 13.5,18.82V21H10.5V18.82C8.47,18.31 7,16.79 7,15Z"}))},{code:"pix",label:"PIX Lojista",icon:a.createElement("svg",{className:"w-8 h-8 text-green-600",fill:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{d:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M12,6A6,6 0 0,1 18,12A6,6 0 0,1 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6M12,8A4,4 0 0,0 8,12A4,4 0 0,0 12,16A4,4 0 0,0 16,12A4,4 0 0,0 12,8Z"}))},{code:"debit_card",label:"Carto De Dbito",icon:a.createElement("svg",{className:"w-8 h-8 text-green-600",fill:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{d:"M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.11,4 20,4M20,18H4V12H20V18M20,8H4V6H20V8Z"}))},{code:"debit_card_lojista",label:"Carto De Dbito Lojista",icon:a.createElement("svg",{className:"w-8 h-8 text-green-600",fill:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{d:"M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.11,4 20,4M20,18H4V12H20V18M20,8H4V6H20V8Z"}))},{code:"credit_card",label:"Carto De Crdito",icon:a.createElement("svg",{className:"w-8 h-8 text-green-600",fill:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{d:"M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.11,4 20,4M20,18H4V12H20V18M20,8H4V6H20V8M7,15H9V17H7V15M11,15H17V17H11V15Z"}))},{code:"credit_card_lojista",label:"Carto De Crdito Lojista",icon:a.createElement("svg",{className:"w-8 h-8 text-green-600",fill:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{d:"M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.11,4 20,4M20,18H4V12H20V18M20,8H4V6H20V8M7,15H9V17H7V15M11,15H17V17H11V15Z"}))},{code:"cheque",label:"Cheque",icon:a.createElement("svg",{className:"w-8 h-8 text-green-600",fill:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{d:"M21,5C21,3.89 20.1,3 19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5M19,19H5V5H19V19M17,17H7V15H17V17M17,13H7V11H17V13M17,9H7V7H17V9Z"}))},{code:"conta",label:"Conta",icon:a.createElement("svg",{className:"w-8 h-8 text-green-600",fill:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{d:"M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,19H5V5H19V19M17,12H7V10H17V12M15,16H7V14H15V16M17,8H7V6H17V8Z"}))},{code:"troca_pecas",label:"TROCA DE PEAS - SH",icon:a.createElement("svg",{className:"w-8 h-8 text-green-600",fill:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{d:"M12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6A6,6 0 0,1 18,12A6,6 0 0,1 12,18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"}))},{code:"vale_funcionario",label:"Vale Funcionrio",icon:a.createElement("svg",{className:"w-8 h-8 text-green-600",fill:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{d:"M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"}))},{code:"garantia_conserto",label:"GARANTIA DE CONSERTO - GRATUITO",icon:a.createElement("svg",{className:"w-8 h-8 text-green-600",fill:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{d:"M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.6 14.8,10V11.5H16.3V16H7.7V11.5H9.2V10C9.2,8.6 10.6,7 12,7M12,8.2C11.2,8.2 10.5,8.7 10.5,10V11.5H13.5V10C13.5,8.7 12.8,8.2 12,8.2Z"}))},{code:"garantia_produto",label:"GARANTIA DE PRODUTO ESPECFICO",icon:a.createElement("svg",{className:"w-8 h-8 text-green-600",fill:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{d:"M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M10,17L6,13L7.41,11.59L10,14.17L16.59,7.58L18,9L10,17Z"}))},{code:"crediario",label:"Credirio",icon:a.createElement("svg",{className:"w-8 h-8 text-green-600",fill:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{d:"M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,19H5V5H19V19M17,12H7V10H17V12M15,16H7V14H15V16M17,8H7V6H17V8Z"}))}];return a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg w-[600px] max-w-[95vw] md:max-w-[80vw] max-h-[90vh] md:max-h-[80vh] overflow-y-auto md:overflow-hidden"},a.createElement("div",{className:"p-4 border-b"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"text-sm text-gray-600"},"Restante a pagar:"),a.createElement("div",{className:"text-3xl font-bold"},"R$ ",Number(i||0).toFixed(2))),o&&o.length>0&&a.createElement("div",{className:"mt-3"},o.map((h,p)=>a.createElement("div",{key:p,className:"flex items-center justify-between py-2"},a.createElement("div",{className:"flex items-center"},a.createElement("div",{className:"mr-2"},(d.find(y=>y.code===h.methodCode)||{}).icon),a.createElement("span",{className:"text-gray-700"},h.method)),a.createElement("div",{className:"flex items-center"},a.createElement("span",{className:"mr-3 font-medium"},h.amount.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})),c&&a.createElement("button",{type:"button",onClick:()=>c(p),className:"text-gray-500 hover:text-red-600"},"")))),a.createElement("div",{className:"border-t"})),a.createElement("h2",{className:"text-sm font-medium mt-2 text-center"},"Selecionar forma de pagamento:")),a.createElement("div",{className:"p-4 max-h-[60vh] md:max-h-96 overflow-y-auto"},a.createElement("div",{className:"grid grid-cols-3 gap-2"},d.map(h=>a.createElement("button",{key:h.code,onClick:()=>u&&u(h),className:"flex flex-col items-center p-3 bg-green-50 border border-green-200 rounded-lg hover:bg-green-100 hover:border-green-300 transition-colors min-h-[80px]"},a.createElement("div",{className:"mb-1"},h.icon),a.createElement("div",{className:"text-xs font-medium text-center text-green-800 leading-tight"},h.label))))),a.createElement("div",{className:"p-4 border-t flex items-center justify-end space-x-2"},a.createElement("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded text-sm hover:bg-gray-50"}," Cancelar"),a.createElement("button",{type:"button",onClick:s,className:"px-4 py-2 bg-green-500 text-white rounded text-sm hover:bg-green-600"}," Confirmar"))))}function HP({open:t,onClose:e,method:n,remaining:r,amount:s,setAmount:i,error:o,setError:c,onConfirm:u}){if(!t)return null;const d=P=>{const w=P.target.value;i(w),c("")},h=()=>{if((parseFloat(s)||0)<=0){c("Valor deve ser maior que zero");return}u()},p=parseFloat(s)||0,y=(n==null?void 0:n.code)==="cash"&&p>r,S=y?p-r:0;return n==null||n.code,Math.min(p,r),a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg w-96 max-h-[80vh] overflow-hidden"},a.createElement("div",{className:"p-4 border-b"},a.createElement("h2",{className:"text-lg font-semibold"},"Valor do pagamento"),a.createElement("div",{className:"text-center mt-1 font-medium"},n==null?void 0:n.label)),a.createElement("div",{className:"p-4"},a.createElement("div",{className:"mb-4"},a.createElement("div",{className:"flex items-center space-x-3"},a.createElement("input",{type:"number",step:"0.01",min:"0",value:s,onChange:d,placeholder:"0,00",className:"flex-1 p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg",autoFocus:!0}),a.createElement("div",{className:"px-3 py-2 border rounded-lg text-sm"},a.createElement("div",{className:"text-gray-500"},"Valor"),a.createElement("div",{className:"font-semibold"},"R$ ",p.toFixed(2)))),o&&a.createElement("p",{className:"text-red-500 text-sm mt-1"},o)),a.createElement("div",{className:"text-sm text-gray-600"},"Restante a pagar: R$ ",r.toFixed(2)),p>0&&a.createElement("div",{className:"space-y-3 mt-3"},(n==null?void 0:n.code)==="cash"&&y&&a.createElement("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg"},a.createElement("p",{className:"text-sm text-green-800"}," Troco de R$ ",S.toFixed(2)," ser registrado")),(n==null?void 0:n.code)!=="cash"&&p>r&&a.createElement("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg"},a.createElement("p",{className:"text-sm text-yellow-800"}," Valor acima do restante. Ser aplicado apenas R$ ",r.toFixed(2))))),a.createElement("div",{className:"p-4 border-t flex items-center justify-end space-x-2"},a.createElement("button",{type:"button",onClick:e,className:"px-4 py-2 border rounded-lg text-sm hover:bg-gray-50"},"Cancelar"),a.createElement("button",{type:"button",onClick:h,className:"px-4 py-2 bg-blue-500 text-white rounded-lg text-sm hover:bg-blue-600"},"Confirmar"))))}function qP({open:t,amount:e,remaining:n,method:r,onCancel:s,onConfirm:i}){if(!t)return null;const o=e-n;return a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg w-96 max-h-[80vh] overflow-hidden"},a.createElement("div",{className:"p-4 border-b"},a.createElement("h2",{className:"text-lg font-semibold flex items-center"},a.createElement("svg",{className:"w-5 h-5 text-yellow-500 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{d:"M12,2L13.09,8.26L22,9L13.09,9.74L12,16L10.91,9.74L2,9L10.91,8.26L12,2Z"})),"Valor Acima do Restante")),a.createElement("div",{className:"p-4"},a.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4"},a.createElement("div",{className:"flex items-center justify-between mb-2"},a.createElement("span",{className:"text-sm text-gray-600"},"Valor informado:"),a.createElement("span",{className:"font-bold text-lg"},"R$ ",e.toFixed(2))),a.createElement("div",{className:"flex items-center justify-between mb-2"},a.createElement("span",{className:"text-sm text-gray-600"},"Valor restante:"),a.createElement("span",{className:"font-medium"},"R$ ",n.toFixed(2))),a.createElement("div",{className:"border-t border-yellow-300 pt-2 mt-2"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("span",{className:"text-sm text-gray-600"},"Excesso:"),a.createElement("span",{className:"font-medium text-yellow-700"},"R$ ",o.toFixed(2))))),a.createElement("div",{className:"flex items-center mb-4"},(r==null?void 0:r.icon)&&a.createElement("div",{className:"mr-2"},r.icon),a.createElement("div",null,a.createElement("p",{className:"font-medium"},"Mtodo: ",r==null?void 0:r.label),a.createElement("p",{className:"text-sm text-gray-600"},"Ser aplicado apenas R$ ",n.toFixed(2)," para este mtodo"))),a.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3"},a.createElement("p",{className:"text-sm text-blue-800"}," O valor ser ajustado automaticamente para no exceder o restante da compra."))),a.createElement("div",{className:"p-4 border-t flex items-center justify-end space-x-2"},a.createElement("button",{type:"button",onClick:s,className:"px-4 py-2 border rounded-lg text-sm hover:bg-gray-50"},"Voltar e Corrigir"),a.createElement("button",{type:"button",onClick:i,className:"px-4 py-2 bg-blue-500 text-white rounded-lg text-sm hover:bg-blue-600"},"Aplicar R$ ",n.toFixed(2)))))}function WP({open:t,remaining:e,onClose:n,onAddMore:r}){if(!t)return null;const s=e>0?100-e/(e+100)*100:100;return a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg w-96 max-h-[80vh] overflow-hidden"},a.createElement("div",{className:"p-4 border-b"},a.createElement("h2",{className:"text-lg font-semibold flex items-center"},a.createElement("svg",{className:"w-5 h-5 text-orange-500 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{d:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,17A1.5,1.5 0 0,1 10.5,15.5A1.5,1.5 0 0,1 12,14A1.5,1.5 0 0,1 13.5,15.5A1.5,1.5 0 0,1 12,17M12,10A1,1 0 0,1 13,11V13A1,1 0 0,1 11,13V11A1,1 0 0,1 12,10Z"})),"Pagamento Parcial")),a.createElement("div",{className:"p-4"},a.createElement("div",{className:"text-center mb-4"},a.createElement("div",{className:"text-3xl font-bold text-orange-600 mb-2"},"R$ ",e.toFixed(2)),a.createElement("p",{className:"text-gray-600"},"ainda resta para completar o pagamento")),a.createElement("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4"},a.createElement("div",{className:"flex items-center justify-between text-sm mb-2"},a.createElement("span",null,"Status do pagamento:"),a.createElement("span",{className:"font-medium text-orange-600"},"Parcial")),a.createElement("div",{className:"w-full bg-gray-200 rounded-full h-2"},a.createElement("div",{className:"bg-orange-500 h-2 rounded-full transition-all duration-300",style:{width:`${Math.max(s,10)}%`}}))),a.createElement("p",{className:"text-center text-gray-600 mb-4"},"Voc pode finalizar com pagamento parcial ou adicionar outro mtodo de pagamento.")),a.createElement("div",{className:"p-4 border-t flex items-center justify-end space-x-2"},a.createElement("button",{type:"button",onClick:n,className:"px-4 py-2 border rounded-lg text-sm hover:bg-gray-50"},"Finalizar Parcial"),a.createElement("button",{type:"button",onClick:r,className:"px-4 py-2 bg-blue-500 text-white rounded-lg text-sm hover:bg-blue-600"},"+ Adicionar Pagamento"))))}function GP({open:t,method:e,remaining:n,onClose:r}){return t?a.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg w-96 max-h-[80vh] overflow-hidden"},a.createElement("div",{className:"p-4 border-b"},a.createElement("h2",{className:"text-lg font-semibold flex items-center"},a.createElement("svg",{className:"w-5 h-5 text-green-500 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},a.createElement("path",{d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"})),"Pagamento Ajustado com Sucesso")),a.createElement("div",{className:"p-4"},a.createElement("div",{className:"flex items-center mb-4"},(e==null?void 0:e.icon)&&a.createElement("div",{className:"mr-2"},e.icon),a.createElement("div",null,a.createElement("p",{className:"font-medium"},"Mtodo: ",e==null?void 0:e.label),a.createElement("p",{className:"text-sm text-gray-600"},"Pagamento registrado com sucesso"))),a.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4"},a.createElement("p",{className:"text-sm text-green-800"}," O pagamento foi ajustado automaticamente para no exceder o valor restante da compra.")),n>0&&a.createElement("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("span",{className:"text-sm text-gray-600"},"Ainda resta:"),a.createElement("span",{className:"font-bold text-lg text-orange-600"},"R$ ",n.toFixed(2))),a.createElement("p",{className:"text-sm text-orange-700 mt-1"},"Voc pode adicionar mais formas de pagamento para completar."))),a.createElement("div",{className:"p-4 border-t flex items-center justify-end"},a.createElement("button",{type:"button",onClick:r,className:"px-4 py-2 bg-green-500 text-white rounded-lg text-sm hover:bg-green-600"},"Continuar")))):null}function KP({open:t,onClose:e,product:n,variation:r,onOpenSelect:s,onOpenVariation:i,qty:o,setQty:c,price:u,setPrice:d,onConfirm:h}){if(!t)return null;const p=n&&n.variations>0&&n.variationsData&&n.variationsData.length>0;return a.createElement("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg w-[640px] max-w-[95vw]"},a.createElement("div",{className:"flex items-center justify-between p-4 border-b"},a.createElement("h3",{className:"font-semibold text-lg"},"Adicionar Produto"),a.createElement("button",{onClick:e,className:"text-gray-500 hover:text-gray-700"},"")),a.createElement("div",{className:"p-4 space-y-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Produto"),a.createElement("button",{type:"button",onClick:s,className:"mt-1 w-full border rounded px-3 py-2 text-sm text-left flex items-center justify-between"},a.createElement("span",null,n?n.name:"Selecionar produto"),a.createElement("span",null,""))),p&&a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Variao"),a.createElement("button",{type:"button",onClick:i,className:"mt-1 w-full border rounded px-3 py-2 text-sm text-left flex items-center justify-between"},a.createElement("span",null,r?r.name:"Selecionar variao"),a.createElement("span",null,""))),a.createElement("div",{className:"grid grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Quantidade"),a.createElement("input",{type:"number",min:"1",step:"1",value:o,onChange:y=>c(y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Preo"),a.createElement("input",{type:"number",step:"0.01",value:u,onChange:y=>d(y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})))),a.createElement("div",{className:"p-4 border-t flex items-center justify-end gap-2"},a.createElement("button",{type:"button",onClick:e,className:"px-3 py-2 border rounded text-sm"},"Cancelar"),a.createElement("button",{type:"button",onClick:h,className:"px-3 py-2 rounded text-sm bg-green-600 text-white"},"Confirmar"))))}function Uv({open:t,onClose:e,products:n,onChoose:r,onNew:s}){const[i,o]=E.useState("");if(!t)return null;const c=(n||[]).filter(u=>(u.name||"").toLowerCase().includes(i.trim().toLowerCase()));return a.createElement("div",{className:"fixed inset-0 bg-black/30 flex items-center justify-center z-50"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg w-[680px] max-w-[95vw]"},a.createElement("div",{className:"flex items-center justify-between p-4 border-b"},a.createElement("h3",{className:"font-semibold text-lg"},"Selecionar Produto"),a.createElement("button",{onClick:s,className:"px-3 py-1 rounded text-xs bg-green-600 text-white"},"+ Novo")),a.createElement("div",{className:"p-4"},a.createElement("input",{value:i,onChange:u=>o(u.target.value),placeholder:"Pesquisar...",className:"w-full border rounded px-3 py-2 text-sm"}),a.createElement("div",{className:"mt-3 max-h-[60vh] overflow-y-auto"},c.map(u=>a.createElement("div",{key:u.id,className:"grid grid-cols-[1fr_8rem] items-center gap-3 px-2 py-3 border-b last:border-0 text-sm cursor-pointer",onClick:()=>r(u)},a.createElement("div",null,a.createElement("div",{className:"font-medium"},u.name)),a.createElement("div",{className:"text-right"},(u.priceMin??u.salePrice??0).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})))),c.length===0&&a.createElement("div",{className:"text-sm text-gray-600 px-2 py-3"},"Nenhum produto encontrado."))),a.createElement("div",{className:"p-4 border-t flex items-center justify-end"},a.createElement("button",{type:"button",onClick:e,className:"px-3 py-2 border rounded text-sm"},"Voltar"))))}function to({title:t,children:e}){return a.createElement("div",{className:"rounded-lg bg-white p-4 shadow"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("h3",{className:"font-semibold text-base"},t)),a.createElement("div",{className:"mt-2 divide-y"},e))}function gt({label:t,onClick:e,rightSlot:n}){return a.createElement("div",{className:"py-3 px-2 flex items-center justify-between cursor-pointer hover:bg-gray-50",onClick:e,role:"button"},a.createElement("span",{className:"text-sm text-gray-800"},t),n??a.createElement("span",{className:"text-gray-400"},""))}function QP({user:t,store:e,onNavigate:n,onLogout:r,darkMode:s=!1,onToggleDark:i}){const o=u=>()=>{window.alert(`${u}  em breve`)},c=()=>{i&&i()};return a.createElement("div",{className:"grid grid-cols-2 gap-6"},a.createElement(to,{title:"Configuraes de empresa"},a.createElement(gt,{label:"Dados da empresa",onClick:()=>n&&n("dadosEmpresa")}),a.createElement(gt,{label:"Usurios",onClick:()=>n&&n("usuarios")}),a.createElement(gt,{label:"Assistente",onClick:o("Assistente")})),a.createElement(to,{title:"Configuraes de venda"},a.createElement(gt,{label:"Formas de pagamento",onClick:o("Formas de pagamento")}),a.createElement(gt,{label:"Taxas adicionais",onClick:()=>n&&n("taxas")}),a.createElement(gt,{label:"Recibo",onClick:o("Recibo")}),a.createElement(gt,{label:"Credirio",onClick:o("Credirio")}),a.createElement(gt,{label:"Comisso",onClick:o("Comisso")})),a.createElement(to,{title:"Configuraes fiscais"},a.createElement(gt,{label:"Configuraes fiscais",onClick:o("Configuraes fiscais")}),a.createElement(gt,{label:"Naturezas de operao",onClick:o("Naturezas de operao")})),a.createElement(to,{title:"Configuraes adicionais"},a.createElement(gt,{label:"Clculos de O.A.",onClick:o("Clculos de O.A.")}),a.createElement(gt,{label:"Catlogo Online",onClick:o("Catlogo Online")}),a.createElement(gt,{label:"Configurar O.S",onClick:o("Configurar O.S")}),a.createElement(gt,{label:"Mdulos de mensagens",onClick:o("Mdulos de mensagens")}),a.createElement(gt,{label:"Integraes",onClick:o("Integraes")})),a.createElement(to,{title:"Outras configuraes"},a.createElement(gt,{label:"Dados do usurio",onClick:()=>n&&n("dadosUsuario")}),a.createElement(gt,{label:"Modo escuro",onClick:c,rightSlot:a.createElement("button",{type:"button",className:Wc("w-12 h-6 rounded-full relative transition-all",s?"bg-green-600":"bg-gray-300")},a.createElement("span",{className:Wc("absolute top-0.5 h-5 w-5 rounded-full bg-white shadow transition-all",s?"right-0.5":"left-0.5")}))}),a.createElement(gt,{label:"Atualizar App",onClick:o("Atualizar App")}),a.createElement(gt,{label:"Sair",onClick:()=>r&&r()})))}function YP({storeId:t,onBack:e}){const[n,r]=E.useState(!0),[s,i]=E.useState(!1),[o,c]=E.useState(""),[u,d]=E.useState(""),[h,p]=E.useState(""),[y,S]=E.useState(""),[P,w]=E.useState(""),[A,_]=E.useState(""),[v,I]=E.useState(""),[D,M]=E.useState(""),[V,b]=E.useState(""),[g,x]=E.useState(""),[T,k]=E.useState(""),[R,C]=E.useState(""),[te,Se]=E.useState(""),[we,Ae]=E.useState(""),[H,q]=E.useState(""),[Z,K]=E.useState(""),[se,U]=E.useState(""),[G,re]=E.useState(""),[fe,Ee]=E.useState("");E.useEffect(()=>{async function Y(){try{r(!0);const ae=await TP(t);ae&&(p(ae.razaoSocial||""),S(ae.fantasyName||ae.nomeFantasia||ae.name||""),w(ae.cnpj||""),_(ae.emailEmpresarial||ae.email||""),I(ae.whatsapp||""),M(ae.telefone||""),b(ae.cep||""),x(ae.endereco||ae.address||""),k(ae.numero||ae.addressNumber||""),C(ae.complemento||ae.addressComplement||""),Se(ae.bairro||""),Ae(ae.cidade||ae.city||""),q(ae.estado||ae.state||""),K(ae.ie||ae.inscricaoEstadual||""),U(ae.im||ae.inscricaoMunicipal||""),re(ae.cnae||""),Ee(ae.regimeTributario||"")),c("")}catch{c("Falha ao carregar dados da empresa.")}finally{r(!1)}}t&&Y()},[t]);async function ke(Y){var ae;(ae=Y==null?void 0:Y.preventDefault)==null||ae.call(Y);try{i(!0),d(""),c(""),await AP(t,{name:y||h||"",razaoSocial:h,fantasyName:y,cnpj:P,emailEmpresarial:A,whatsapp:v,telefone:D,cep:V,endereco:g,numero:T,complemento:R,bairro:te,cidade:we,estado:H,ie:Z,im:se,cnae:G,regimeTributario:fe}),d("Dados salvos com sucesso.")}catch{c("Falha ao salvar dados. Verifique as informaes e tente novamente.")}finally{i(!1)}}return a.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("h2",{className:"text-lg font-semibold"},"Dados da empresa"),a.createElement("div",{className:"flex items-center gap-2"},e&&a.createElement("button",{type:"button",onClick:e,className:"px-3 py-2 border rounded text-sm"},"Voltar"),a.createElement("button",{disabled:s,onClick:ke,className:"px-3 py-2 rounded text-sm bg-green-600 text-white disabled:opacity-60"},"Salvar"))),n?a.createElement("div",{className:"mt-4 text-sm text-gray-600"},"Carregando..."):a.createElement("form",{className:"mt-4 space-y-6",onSubmit:ke},a.createElement("div",null,a.createElement("div",{className:"font-semibold text-sm mb-2"},"Dados da empresa"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Razo Social"),a.createElement("input",{value:h,onChange:Y=>p(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Nome Fantasia"),a.createElement("input",{value:y,onChange:Y=>S(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",{className:"md:col-span-2"},a.createElement("label",{className:"text-xs text-gray-600"},"CNPJ"),a.createElement("input",{value:P,onChange:Y=>w(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm",placeholder:"00.000.000/0000-00"})))),a.createElement("div",null,a.createElement("div",{className:"font-semibold text-sm mb-2"},"Dados de contato"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"WhatsApp principal"),a.createElement("input",{value:v,onChange:Y=>I(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm",placeholder:"(00) 00000-0000"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Telefone"),a.createElement("input",{value:D,onChange:Y=>M(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"E-mail empresarial"),a.createElement("input",{type:"email",value:A,onChange:Y=>_(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm",placeholder:"email@empresa.com"})))),a.createElement("div",null,a.createElement("div",{className:"font-semibold text-sm mb-2"},"Endereo"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"CEP"),a.createElement("input",{value:V,onChange:Y=>b(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",{className:"md:col-span-2"},a.createElement("label",{className:"text-xs text-gray-600"},"Endereo (Rua)"),a.createElement("input",{value:g,onChange:Y=>x(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Nmero"),a.createElement("input",{value:T,onChange:Y=>k(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Complemento"),a.createElement("input",{value:R,onChange:Y=>C(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Bairro"),a.createElement("input",{value:te,onChange:Y=>Se(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Cidade"),a.createElement("input",{value:we,onChange:Y=>Ae(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Estado"),a.createElement("input",{value:H,onChange:Y=>q(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm",placeholder:"UF"})))),a.createElement("div",null,a.createElement("div",{className:"font-semibold text-sm mb-2"},"Dados fiscais"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4"},a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Inscrio Estadual"),a.createElement("input",{value:Z,onChange:Y=>K(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Inscrio Municipal"),a.createElement("input",{value:se,onChange:Y=>U(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"CNAE"),a.createElement("input",{value:G,onChange:Y=>re(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm"})),a.createElement("div",null,a.createElement("label",{className:"text-xs text-gray-600"},"Regime Tributrio"),a.createElement("input",{value:fe,onChange:Y=>Ee(Y.target.value),className:"mt-1 w-full border rounded px-3 py-2 text-sm",placeholder:"Ex.: Simples Nacional"})))),o&&a.createElement("div",{className:"text-sm text-red-600"},o),u&&a.createElement("div",{className:"text-sm text-green-600"},u),a.createElement("div",{className:"flex items-center justify-end gap-2"},a.createElement("button",{type:"button",className:"px-3 py-2 border rounded text-sm",onClick:e},"Cancelar"),a.createElement("button",{disabled:s,type:"submit",className:"px-3 py-2 rounded text-sm bg-green-600 text-white disabled:opacity-60"},"Salvar"))))}function XP(t){try{return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Number(t||0))}catch{return`R$ ${Number(t||0).toFixed(2)}`}}function JP({active:t}){return a.createElement("span",{className:`px-2 py-0.5 text-xs rounded-full border ${t?"bg-emerald-50 text-emerald-700 border-emerald-100":"bg-slate-100 text-slate-600 border-slate-200"}`},t?"Ativo":"Inativo")}function ZP({value:t,onChange:e}){return a.createElement("div",{className:"relative w-[420px] max-w-[70vw]"},a.createElement("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400"},a.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},a.createElement("circle",{cx:"11",cy:"11",r:"8"}),a.createElement("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}))),a.createElement("input",{className:"w-full pl-9 pr-3 py-2 text-sm rounded-md border border-slate-300 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-emerald-500 bg-white",placeholder:"Pesquisar...",value:t,onChange:n=>e(n.target.value)}))}function eR({open:t,onClose:e,onCreated:n}){const[r,s]=E.useState(""),[i,o]=E.useState(""),[c,u]=E.useState("fixed"),[d,h]=E.useState(!1),[p,y]=E.useState({});return E.useEffect(()=>{t||(s(""),o(""),u("fixed"),h(!0))},[t]),t?a.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center modal-overlay"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg w-[600px] max-w-[92vw] p-6 modal-card"},a.createElement("h3",{className:"text-base font-semibold mb-4"},"Nova taxa"),a.createElement("div",{className:"space-y-4"},a.createElement("input",{className:`w-full rounded-md px-3 py-2 text-sm bg-slate-50 border ${p.name?"border-red-400":"border-slate-300"} placeholder-slate-400`,placeholder:"Nome",value:r,onChange:S=>s(S.target.value)}),p.name?a.createElement("div",{className:"text-xs text-red-600"},"Informe o nome da taxa."):null,a.createElement("input",{className:`w-full rounded-md px-3 py-2 text-sm bg-slate-50 border ${p.value?"border-red-400":"border-slate-300"} placeholder-slate-400`,placeholder:c==="percent"?"Valor Percentual":"Valor Fixo",value:i,onChange:S=>o(S.target.value)}),p.value?a.createElement("div",{className:"text-xs text-red-600"},"Informe um valor vlido ",c==="percent"?"entre 0 e 100":"maior ou igual a 0","."):null,a.createElement("div",{className:"flex items-center gap-2"},a.createElement("button",{className:`text-xs px-3 py-1 rounded-full ${c==="fixed"?"bg-emerald-100 text-emerald-700":"bg-slate-200 text-slate-700"}`,onClick:()=>u("fixed")},"Valor Fixo"),a.createElement("button",{className:`text-xs px-3 py-1 rounded-full ${c==="percent"?"bg-emerald-100 text-emerald-700":"bg-slate-200 text-slate-700"}`,onClick:()=>u("percent")},"Valor Percentual")),a.createElement("div",{className:"flex items-center gap-3 text-sm"},a.createElement(he,{checked:d,onChange:h}),a.createElement("span",null,"Ativo"))),a.createElement("div",{className:"mt-6 flex items-center justify-between"},a.createElement("button",{className:"text-sm px-3 py-2 text-slate-600 hover:text-slate-800 flex items-center gap-2",onClick:e},a.createElement("span",null,""),"Voltar"),a.createElement("button",{className:"text-sm px-3 py-2 rounded bg-[#00c853] hover:bg-[#00b74a] text-white flex items-center gap-2",onClick:()=>{const S={};r!=null&&r.trim()||(S.name=!0);const P=Number(i);!Number.isNaN(P)?(c==="percent"&&(P<0||P>100)||c==="fixed"&&P<0)&&(S.value=!0):S.value=!0,y(S),Object.keys(S).length===0&&n({name:r.trim(),value:P,type:c,active:d})}},a.createElement("span",null,""),"Confirmar")))):null}function tR({open:t,onClose:e,item:n,storeId:r,onUpdated:s}){const[i,o]=E.useState(""),[c,u]=E.useState(""),[d,h]=E.useState("fixed"),[p,y]=E.useState(!0),[S,P]=E.useState({});if(E.useEffect(()=>{t&&n&&(o(n.name||""),u(String(n.value??"")),h(n.type==="percent"?"percent":"fixed"),y(!!n.active),P({}))},[t,n]),!t||!n)return null;const w=()=>{const _={};String(i).trim()||(_.name=!0);const v=Number(c);return!Number.isNaN(v)?(d==="percent"&&(v<0||v>100)||d!=="percent"&&v<0)&&(_.value=!0):_.value=!0,P(_),Object.keys(_).length===0},A=async()=>{if(w())try{await RP(r,n.id,{name:String(i).trim(),value:Number(c),type:d,active:p}),s&&s(),e&&e()}catch(_){console.error("updateFee error",_),P(v=>({...v,submit:"Falha ao salvar. Tente novamente."}))}};return a.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center modal-overlay"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg w-[600px] max-w-[92vw] p-6 modal-card"},a.createElement("h3",{className:"text-base font-semibold mb-4"},"Editar taxa"),a.createElement("div",{className:"space-y-4"},a.createElement("input",{className:`w-full rounded-md px-3 py-2 text-sm bg-slate-50 border ${S.name?"border-red-400":"border-slate-300"} placeholder-slate-400`,placeholder:"Nome",value:i,onChange:_=>o(_.target.value)}),S.name?a.createElement("div",{className:"text-xs text-red-600"},"Informe o nome da taxa."):null,a.createElement("input",{className:`w-full rounded-md px-3 py-2 text-sm bg-slate-50 border ${S.value?"border-red-400":"border-slate-300"} placeholder-slate-400`,placeholder:d==="percent"?"Valor Percentual":"Valor Fixo",value:c,onChange:_=>u(_.target.value)}),S.value?a.createElement("div",{className:"text-xs text-red-600"},"Informe um valor vlido ",d==="percent"?"entre 0 e 100":"maior ou igual a 0","."):null,a.createElement("div",{className:"flex items-center gap-2"},a.createElement("button",{className:`text-xs px-3 py-1 rounded-full ${d==="fixed"?"bg-emerald-100 text-emerald-700":"bg-slate-200 text-slate-700"}`,onClick:()=>h("fixed")},"Valor Fixo"),a.createElement("button",{className:`text-xs px-3 py-1 rounded-full ${d==="percent"?"bg-emerald-100 text-emerald-700":"bg-slate-200 text-slate-700"}`,onClick:()=>h("percent")},"Valor Percentual")),a.createElement("div",{className:"flex items-center gap-3 text-sm"},a.createElement(he,{checked:p,onChange:y}),a.createElement("span",null,"Ativo")),S.submit&&a.createElement("div",{className:"text-xs text-red-600"},S.submit)),a.createElement("div",{className:"mt-6 flex items-center justify-between"},a.createElement("button",{className:"text-sm px-3 py-2 text-slate-600 hover:text-slate-800 flex items-center gap-2",onClick:e},a.createElement("span",null,""),"Cancelar"),a.createElement("button",{className:"text-sm px-3 py-2 rounded bg-[#00c853] hover:bg-[#00b74a] text-white flex items-center gap-2",onClick:A},a.createElement("span",null,""),"Confirmar"))))}function nR({storeId:t,onBack:e}){const[n,r]=E.useState([]),[s,i]=E.useState(""),[o,c]=E.useState("all"),[u,d]=E.useState(!1),[h,p]=E.useState(null),[y,S]=E.useState(!0),[P,w]=E.useState(null),[A,_]=E.useState(!1),[v,I]=E.useState(null);E.useEffect(()=>{if(!t){S(!1);return}S(!0);const V=kP(t,b=>{r(b),S(!1)},b=>{p(b),S(!1)});return()=>V&&V()},[t]);const D=E.useMemo(()=>n.filter(V=>o==="active"?V.active:o==="inactive"?!V.active:!0).filter(V=>{var b;return(b=V.name)==null?void 0:b.toLowerCase().includes(s.toLowerCase())}),[n,s,o]);async function M(V){if(V!=null&&V.name)try{await PP(t,V),d(!1),p(null)}catch(b){console.error("addFee error",b),p(b)}}return t?a.createElement("div",{className:"p-4"},a.createElement("div",{className:"flex items-center justify-between mb-4"},a.createElement("h2",{className:"text-sm font-semibold text-slate-700"},"Configurar taxas adicionais"),a.createElement("div",{className:"flex items-center gap-2"},a.createElement("button",{className:"px-3 py-2 border border-slate-300 rounded text-sm",onClick:e},"Voltar"),a.createElement("button",{className:"px-3 py-2 rounded text-sm bg-[#00c853] hover:bg-[#00b74a] text-white flex items-center gap-2",onClick:()=>d(!0)},a.createElement("span",{className:"text-lg leading-none"},"+"),"Novo"))),y&&a.createElement("div",{className:"mb-3 px-3 py-2 rounded bg-slate-50 text-slate-700 text-sm"},"Carregando taxas..."),h&&a.createElement("div",{className:"mb-3 px-3 py-2 rounded bg-red-50 text-red-700 text-sm"},"Falha ao carregar taxas. Verifique regras do Firestore e conexo."),a.createElement("div",{className:"flex items-center gap-2 mb-3"},a.createElement(ZP,{value:s,onChange:i}),a.createElement("button",{className:`text-xs px-2 py-1 rounded border ${o==="active"?"bg-slate-800 text-white border-slate-800":"bg-white text-slate-700 border-slate-300"}`,onClick:()=>c("active")},"Ativo"),a.createElement("button",{className:`text-xs px-2 py-1 rounded border ${o==="inactive"?"bg-slate-800 text-white border-slate-800":"bg-white text-slate-700 border-slate-300"}`,onClick:()=>c("inactive")},"Inativo"),a.createElement("button",{className:`text-xs px-2 py-1 rounded border ${o==="all"?"bg-slate-800 text-white border-slate-800":"bg-white text-slate-700 border-slate-300"}`,onClick:()=>c("all")},"Todos")),a.createElement("div",{className:"border rounded overflow-hidden"},a.createElement("div",{className:"grid grid-cols-[1fr_120px_120px] px-4 py-2 text-xs font-semibold text-slate-600 bg-slate-50 border-b"},a.createElement("div",null,"Nome"),a.createElement("div",null,"Valor"),a.createElement("div",null,"Status")),D.map(V=>a.createElement("button",{key:V.id,type:"button",className:"grid grid-cols-[1fr_120px_120px] w-full text-left px-4 py-2 text-sm border-b hover:bg-slate-50 transition-colors cursor-pointer",onClick:()=>{I(V),_(!0)}},a.createElement("div",{className:"truncate",title:V.name},V.name),a.createElement("div",null,V.type==="percent"?`${Number(V.value||0)}%`:XP(V.value)),a.createElement("div",null,a.createElement(JP,{active:!!V.active})))),D.length===0&&!h&&a.createElement("div",{className:"px-4 py-6 text-sm text-slate-500"},"Nenhuma taxa encontrada.")),a.createElement(eR,{open:u,onClose:()=>d(!1),onCreated:M}),a.createElement(tR,{open:A,onClose:()=>{_(!1),I(null)},item:v,storeId:t,onUpdated:()=>{}})):a.createElement("div",{className:"p-4"},a.createElement("div",{className:"rounded-lg bg-white p-6 shadow"},a.createElement("h2",{className:"text-lg font-semibold mb-2"},"Configurar taxas adicionais"),a.createElement("p",{className:"text-sm text-gray-600"},"Selecione uma loja para gerenciar taxas."),a.createElement("div",{className:"mt-3"},a.createElement("button",{className:"px-3 py-2 border border-slate-300 rounded text-sm",onClick:e},"Voltar"))))}function rR({user:t,onSelect:e}){const[n,r]=E.useState([]),[s,i]=E.useState(!0);return E.useEffect(()=>{let o=!0;async function c(){i(!0);const u=await IP(t.id);o&&r(u),i(!1)}return c(),()=>{o=!1}},[t.id]),a.createElement("div",{className:"min-h-screen bg-[#f7faf9] p-6"},a.createElement("div",{className:"max-w-3xl mx-auto"},a.createElement("h1",{className:"text-2xl font-bold"},"Selecione a loja"),a.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Bem-vindo, ",t.name,". Escolha uma loja para continuar."),s?a.createElement("div",{className:"mt-6"},"Carregando lojas..."):n.length===0?a.createElement("div",{className:"mt-6 text-sm text-gray-600"},"Nenhuma loja encontrada para sua conta."):a.createElement("div",{className:"grid grid-cols-3 gap-4 mt-6"},n.map(o=>a.createElement("div",{key:o.id,className:"bg-white rounded-lg shadow p-4 cursor-pointer hover:border-green-600 border",onClick:()=>e(o)},a.createElement("div",{className:"font-semibold"},o.name),a.createElement("div",{className:"text-xs text-gray-600 mt-1"},"ID: ",o.id))))))}const jv={products:{create:!1,edit:!1},sales:{viewAll:!1,finalize:!1,refund:!1,cancel:!1,changePrice:!1,sellUnregistered:!1},serviceOrders:{view:!1,create:!1,edit:!1,changeStatus:!1,changeValues:!1},services:{create:!1,edit:!1},categories:{create:!1,edit:!1},suppliers:{create:!1,edit:!1,view:!1},purchases:{create:!1,edit:!1,view:!1},clients:{create:!1,edit:!1},receivables:{create:!1,edit:!1,view:!1,cancel:!1},payables:{create:!1,edit:!1,view:!1},cash:{view:!1,open:!1,close:!1,viewReopenPrevious:!1}};function sR({open:t,onClose:e,initialPermissions:n={},onConfirm:r}){const[s,i]=E.useState(jv);if(E.useEffect(()=>{if(t){const u=JSON.parse(JSON.stringify(jv)),d=n||{};for(const h of Object.keys(u))u[h]={...u[h],...d[h]||{}};i(u)}},[t,n]),!t)return null;const o=(u,d)=>h=>{i(p=>({...p,[u]:{...p[u],[d]:h}}))},c=({title:u,children:d})=>a.createElement("div",{className:"border-b py-3"},a.createElement("div",{className:"font-semibold text-sm mb-2"},u),a.createElement("div",{className:"space-y-3"},d));return a.createElement("div",{className:"fixed inset-0 z-[70] bg-black/30 flex items-center justify-center"},a.createElement("div",{className:"bg-white rounded-lg shadow-lg w-[760px] max-w-[95vw]"},a.createElement("div",{className:"flex items-center justify-between p-4 border-b"},a.createElement("div",{className:"font-semibold text-lg"},"Permisses"),a.createElement("button",{onClick:e,className:"text-gray-500 hover:text-gray-700"},"")),a.createElement("div",{className:"p-4 max-h-[70vh] overflow-y-auto"},a.createElement(c,{title:"Produtos"},a.createElement(he,{checked:s.products.create,onChange:o("products","create"),label:"Cadastrar produtos"}),a.createElement(he,{checked:s.products.edit,onChange:o("products","edit"),label:"Editar produtos"})),a.createElement(c,{title:"Vendas"},a.createElement(he,{checked:s.sales.viewAll,onChange:o("sales","viewAll"),label:"Pode visualizar todas as vendas"}),a.createElement(he,{checked:s.sales.finalize,onChange:o("sales","finalize"),label:"Pode finalizar venda"}),a.createElement(he,{checked:s.sales.refund,onChange:o("sales","refund"),label:"Pode realizar devoluo"}),a.createElement(he,{checked:s.sales.cancel,onChange:o("sales","cancel"),label:"Pode cancelar venda"}),a.createElement(he,{checked:s.sales.changePrice,onChange:o("sales","changePrice"),label:"Pode alterar o valor dos produtos"}),a.createElement(he,{checked:s.sales.sellUnregistered,onChange:o("sales","sellUnregistered"),label:"Vender produto no cadastrado"})),a.createElement(c,{title:"Ordens de servio"},a.createElement(he,{checked:s.serviceOrders.view,onChange:o("serviceOrders","view"),label:"Pode Visualizar ordens de servio"}),a.createElement(he,{checked:s.serviceOrders.create,onChange:o("serviceOrders","create"),label:"Pode Cadastrar ordens de servio"}),a.createElement(he,{checked:s.serviceOrders.edit,onChange:o("serviceOrders","edit"),label:"Pode Editar ordens de servio"}),a.createElement(he,{checked:s.serviceOrders.changeStatus,onChange:o("serviceOrders","changeStatus"),label:"Pode Alterar status da ordem de servio"}),a.createElement(he,{checked:s.serviceOrders.changeValues,onChange:o("serviceOrders","changeValues"),label:"Pode Alterar o valor dos produtos/servios"})),a.createElement(c,{title:"Servios"},a.createElement(he,{checked:s.services.create,onChange:o("services","create"),label:"Cadastrar servios"}),a.createElement(he,{checked:s.services.edit,onChange:o("services","edit"),label:"Editar servios"})),a.createElement(c,{title:"Categorias"},a.createElement(he,{checked:s.categories.create,onChange:o("categories","create"),label:"Cadastrar categorias"}),a.createElement(he,{checked:s.categories.edit,onChange:o("categories","edit"),label:"Editar categorias"})),a.createElement(c,{title:"Fornecedores"},a.createElement(he,{checked:s.suppliers.create,onChange:o("suppliers","create"),label:"Cadastrar fornecedores"}),a.createElement(he,{checked:s.suppliers.edit,onChange:o("suppliers","edit"),label:"Editar fornecedores"}),a.createElement(he,{checked:s.suppliers.view,onChange:o("suppliers","view"),label:"Visualizar fornecedores"})),a.createElement(c,{title:"Compras"},a.createElement(he,{checked:s.purchases.create,onChange:o("purchases","create"),label:"Cadastrar compras"}),a.createElement(he,{checked:s.purchases.edit,onChange:o("purchases","edit"),label:"Editar compras"}),a.createElement(he,{checked:s.purchases.view,onChange:o("purchases","view"),label:"Visualizar compras"})),a.createElement(c,{title:"Clientes"},a.createElement(he,{checked:s.clients.create,onChange:o("clients","create"),label:"Cadastrar clientes"}),a.createElement(he,{checked:s.clients.edit,onChange:o("clients","edit"),label:"Editar clientes"})),a.createElement(c,{title:"Contas a receber"},a.createElement(he,{checked:s.receivables.create,onChange:o("receivables","create"),label:"Cadastrar contas a receber"}),a.createElement(he,{checked:s.receivables.edit,onChange:o("receivables","edit"),label:"Editar contas a receber"}),a.createElement(he,{checked:s.receivables.view,onChange:o("receivables","view"),label:"Visualizar contas a receber"}),a.createElement(he,{checked:s.receivables.cancel,onChange:o("receivables","cancel"),label:"Pode cancelar contas a receber"})),a.createElement(c,{title:"Contas a pagar"},a.createElement(he,{checked:s.payables.create,onChange:o("payables","create"),label:"Cadastrar contas a pagar"}),a.createElement(he,{checked:s.payables.edit,onChange:o("payables","edit"),label:"Editar contas a pagar"}),a.createElement(he,{checked:s.payables.view,onChange:o("payables","view"),label:"Visualizar contas a pagar"})),a.createElement(c,{title:"Caixa"},a.createElement(he,{checked:s.cash.view,onChange:o("cash","view"),label:"Visualizar caixa"}),a.createElement(he,{checked:s.cash.open,onChange:o("cash","open"),label:"Pode abrir o caixa"}),a.createElement(he,{checked:s.cash.close,onChange:o("cash","close"),label:"Pode fechar o caixa"}),a.createElement(he,{checked:s.cash.viewReopenPrevious,onChange:o("cash","viewReopenPrevious"),label:"Visualizar/Reabrir caixas anteriores"}))),a.createElement("div",{className:"p-4 flex items-center justify-end gap-2 border-t"},a.createElement("button",{type:"button",className:"px-3 py-2 rounded border text-sm",onClick:e},"Cancelar"),a.createElement("button",{type:"button",className:"px-3 py-2 rounded bg-green-600 text-white text-sm",onClick:()=>r&&r(s)},"Salvar"))))}function aR({user:t,onClose:e,onSave:n}){const[r,s]=E.useState((t==null?void 0:t.name)||""),[i,o]=E.useState((t==null?void 0:t.email)||""),[c,u]=E.useState((t==null?void 0:t.whatsapp)||""),[d,h]=E.useState(!!(t!=null&&t.isSeller)),[p,y]=E.useState(!!(t!=null&&t.isTech)),[S,P]=E.useState(!!(t!=null&&t.isAdmin)),[w,A]=E.useState(!!(t!=null&&t.allowDiscount)),[_,v]=E.useState((t==null?void 0:t.discountMaxPercent)!=null?String(t.discountMaxPercent):""),[I,D]=E.useState(!!(t!=null&&t.unlimitedDiscount)),[M,V]=E.useState((t==null?void 0:t.active)!==!1),[b,g]=E.useState((t==null?void 0:t.permissions)||{}),[x,T]=E.useState(!1),[k,R]=E.useState(""),[C,te]=E.useState(""),[Se,we]=E.useState("");E.useEffect(()=>{s((t==null?void 0:t.name)||""),o((t==null?void 0:t.email)||""),u((t==null?void 0:t.whatsapp)||""),h(!!(t!=null&&t.isSeller)),y(!!(t!=null&&t.isTech)),P(!!(t!=null&&t.isAdmin)),A(!!(t!=null&&t.allowDiscount)),v((t==null?void 0:t.discountMaxPercent)!=null?String(t.discountMaxPercent):""),D(!!(t!=null&&t.unlimitedDiscount)),V((t==null?void 0:t.active)!==!1),g((t==null?void 0:t.permissions)||{}),we(""),R(""),te("")},[t]);const Ae=()=>S?"admin":d?"manager":"staff";function H(q){var K;if((K=q==null?void 0:q.preventDefault)==null||K.call(q),!t){const se=String(k||"");if(se.length<6){we("A senha deve ter pelo menos 6 caracteres.");return}if(se!==String(C||"")){we("As senhas no coincidem.");return}}we("");const Z={name:r.trim(),email:i.trim(),whatsapp:c.trim(),isSeller:d,isTech:p,isAdmin:S,allowDiscount:w,discountMaxPercent:w&&!I?Number(_||0):null,unlimitedDiscount:I,active:M,role:Ae(),permissions:b,...t?{}:{password:String(k)}};n(Z)}return a.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40"},a.createElement("div",{className:"w-full max-w-2xl rounded-lg bg-white shadow"},a.createElement("div",{className:"border-b p-4"},a.createElement("h3",{className:"text-lg font-semibold"},t?"Editar Usurio":"Novo Usurio")),a.createElement("form",{onSubmit:H,className:"p-4 space-y-6"},a.createElement("div",null,a.createElement("div",{className:"font-semibold text-sm mb-2"},"Dados do usurio"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm text-gray-700"},"Nome"),a.createElement("input",{className:"input w-full",value:r,onChange:q=>s(q.target.value),placeholder:"Nome do usurio"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm text-gray-700"},"Whatsapp"),a.createElement("input",{className:"input w-full",value:c,onChange:q=>u(q.target.value),placeholder:"(00) 00000-0000"})),a.createElement("div",{className:"md:col-span-2"},a.createElement("label",{className:"block text-sm text-gray-700"},"E-mail"),a.createElement("input",{className:"input w-full",value:i,onChange:q=>o(q.target.value),placeholder:"email@exemplo.com",type:"email"})))),!t&&a.createElement("div",null,a.createElement("div",{className:"font-semibold text-sm mb-2"},"Credenciais"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-sm text-gray-700"},"Senha"),a.createElement("input",{className:"input w-full",type:"password",value:k,onChange:q=>R(q.target.value),placeholder:"Mnimo 6 caracteres"})),a.createElement("div",null,a.createElement("label",{className:"block text-sm text-gray-700"},"Confirmar senha"),a.createElement("input",{className:"input w-full",type:"password",value:C,onChange:q=>te(q.target.value),placeholder:"Repita a senha"}))),Se&&a.createElement("div",{className:"mt-2 text-xs text-red-600"},Se)),a.createElement("div",null,a.createElement("div",{className:"font-semibold text-sm mb-2"},"Funes e permisses"),a.createElement("div",{className:"space-y-3"},a.createElement(he,{checked:d,onChange:h,label:" vendedor"}),a.createElement(he,{checked:p,onChange:y,label:" tcnico (Ordem de servio)"}),a.createElement(he,{checked:S,onChange:P,label:" administrador"}),a.createElement("div",{className:"text-xs text-gray-500"},"Administradores pode acessar e ver todas as informaes."),a.createElement("button",{type:"button",className:"px-3 py-2 rounded text-sm bg-gray-100 hover:bg-gray-200",onClick:()=>T(!0)},"Adicionar Permisses"))),a.createElement("div",null,a.createElement("div",{className:"font-semibold text-sm mb-2"},"Configuraes de desconto para vendedor"),a.createElement("div",{className:"space-y-3"},a.createElement(he,{checked:w,onChange:A,label:"Permitir desconto"}),a.createElement("div",{className:"text-xs text-gray-600 bg-gray-100 rounded p-3"},'Informe o "Valor mximo de desconto (%)" que o vendedor poder aplicar. Se preferir liberar sem restries, marque "Desconto ilimitado".'),a.createElement("div",{className:"grid grid-cols-[1fr_auto] items-center gap-4"},a.createElement("div",null,a.createElement("label",{className:"block text-xs text-gray-700"},"Valor mximo de desconto (%)"),a.createElement("input",{className:"input w-full",type:"number",step:"0.01",min:"0",value:_,disabled:!w||I,onChange:q=>v(q.target.value)})),a.createElement("div",{className:"mt-6"},a.createElement(he,{checked:I,onChange:D,label:"Desconto ilimitado",disabled:!w}))))),a.createElement("div",null,a.createElement(he,{checked:M,onChange:V,label:"Cadastro ativo"})),a.createElement("div",{className:"flex items-center justify-end gap-2 pt-2"},a.createElement("button",{type:"button",className:"btn btn-light",onClick:e},"Cancelar"),a.createElement("button",{type:"submit",className:"btn btn-primary"},"Salvar")))),a.createElement(sR,{open:x,initialPermissions:b,onClose:()=>T(!1),onConfirm:q=>{g(q),T(!1)}}))}function iR({owner:t}){const[e,n]=E.useState([]),[r,s]=E.useState(!0),[i,o]=E.useState(!1),[c,u]=E.useState(!1),[d,h]=E.useState(null);E.useEffect(()=>{if(!(t!=null&&t.id))return;const v=gp(t.id,I=>n(I));return()=>v&&v()},[t==null?void 0:t.id]);const p=E.useMemo(()=>e.filter(v=>v.active??!0?r:i),[e,r,i]),y=v=>{h(v),u(!0)};async function S(v){t!=null&&t.id&&(d?await Px(t.id,d.id,v):await VP(t.id,v),u(!1),h(null))}const P=e.filter(v=>v.active??!0).length,w=v=>(v.isSeller??!1)||String(v.role||"").toLowerCase()==="manager"||/vendedor/i.test(String(v.name||"")),A=v=>(v.isTech??!1)||/t[e]cnico/i.test(String(v.name||"")),_=v=>(v.isAdmin??!1)||String(v.role||"").toLowerCase()==="admin";return a.createElement("div",null,a.createElement("div",{className:"grid grid-cols-[1fr_auto] items-center mb-3"},a.createElement("div",{className:"flex items-center gap-2"},a.createElement("button",{className:`px-2 py-1 rounded text-xs border ${r?"bg-green-100 text-green-700 border-green-300":"text-gray-700 border-gray-300"}`,onClick:()=>s(v=>!v)},"Ativo"),a.createElement("button",{className:`px-2 py-1 rounded text-xs border ${i?"bg-gray-200 text-gray-700 border-gray-300":"text-gray-700 border-gray-300"}`,onClick:()=>o(v=>!v)},"Inativo")),a.createElement("button",{className:"px-3 py-2 rounded bg-green-600 text-white text-sm",onClick:()=>u(!0)},"+ Novo")),a.createElement("div",{className:"bg-white rounded-lg shadow overflow-hidden"},a.createElement("div",{className:"grid grid-cols-[1.5rem_1fr_10rem_8rem_2rem] items-center px-4 py-3 text-xs text-gray-500 border-b"},a.createElement("div",null),a.createElement("div",null,"Usurios (",p.length,")"),a.createElement("div",{className:"text-right"},"Whatsapp"),a.createElement("div",{className:"text-right"},"Status"),a.createElement("div",null)),p.map((v,I)=>a.createElement("div",{key:v.id,className:"grid grid-cols-[1.5rem_1fr_10rem_8rem_2rem] items-center px-4 py-3 border-b last:border-0"},a.createElement("div",{className:"text-gray-400"},""),a.createElement("div",{className:"text-sm"},a.createElement("div",{className:"font-medium cursor-pointer",onClick:()=>y(v)},v.name||"-"),a.createElement("div",{className:"mt-1 flex flex-wrap gap-1"},_(v)&&a.createElement("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs bg-green-50 text-green-700 border border-green-200"},"Administrador"),w(v)&&a.createElement("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs bg-gray-100 text-gray-700 border border-gray-300"},"Vendedor",typeof I=="number"?` #${I+1}`:""),A(v)&&a.createElement("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs bg-gray-100 text-gray-700 border border-gray-300"},"Tcnico"))),a.createElement("div",{className:"text-sm text-right"},v.whatsapp||"-"),a.createElement("div",{className:"text-sm text-right"},a.createElement("div",{className:`px-2 py-1 rounded text-xs ${v.active??!0?"bg-green-100 text-green-700":"bg-gray-200 text-gray-700"}`},v.active??!0?"Ativo":"Inativo")),a.createElement("div",{className:"text-right text-sm"},"")))),a.createElement("div",{className:"mt-3 text-xs text-gray-600"},P>=10&&a.createElement("div",null,"Voc atingiu o limite de usurios ativos permitidos pelo seu plano (10 usurios), para adicionar mais usurios, entre em contato o suporte.")),c&&a.createElement(aR,{user:d,onClose:()=>{u(!1),h(null)},onSave:S}))}function oR({onLoggedIn:t}){const[e,n]=E.useState(""),[r,s]=E.useState(""),[i,o]=E.useState(!1),[c,u]=E.useState(""),[d,h]=E.useState(""),[p,y]=E.useState(!1),[S,P]=E.useState(""),w=v=>{const I=(v==null?void 0:v.code)||"";return I==="auth/operation-not-allowed"?"Login por e-mail/senha no habilitado ou mtodo de link desativado. Ative em Authentication.":I==="auth/invalid-email"?"E-mail invlido.":(v==null?void 0:v.message)||"Falha no login"};E.useEffect(()=>{async function v(){var I;try{if(!Nv(Qa,window.location.href))return;o(!0),u(""),h("Finalizando login por link...");let D=window.localStorage.getItem("emailForSignIn")||"";if(!D){h("Informe seu e-mail para finalizar o login por link."),y(!0),o(!1);return}const M=await bv(Qa,D,window.location.href),V=((I=M==null?void 0:M.user)==null?void 0:I.email)||D,b=await xh(V);if(b){t(b),h("");return}const g=await Nh(V);if(g){t({id:g.ownerId,ownerId:g.ownerId,memberId:g.id,name:g.name||"Usurio",email:g.email||V,role:g.role||"staff",isSeller:!!g.isSeller,isTech:!!g.isTech,isAdmin:!!g.isAdmin,active:g.active!==!1}),h("");return}u("Login concludo, mas nenhum perfil encontrado no banco de dados."),o(!1)}catch(D){u(w(D)),o(!1)}}v()},[t]);async function A(v){v.preventDefault(),o(!0),u(""),h("");const I=e.trim();if(!I||!p&&!r){u("Informe e-mail e senha (ou use login por link)."),o(!1);return}try{if(p){const D={url:window.location.origin,handleCodeInApp:!0};await Uk(Qa,I,D),window.localStorage.setItem("emailForSignIn",I),h("Link de login enviado para seu e-mail. Abra o link no mesmo dispositivo para finalizar automaticamente.")}else{const D=await LP(I,r);t(D)}}catch(D){u(w(D))}finally{o(!1)}}async function _(v){var D,M;(D=v==null?void 0:v.preventDefault)==null||D.call(v);const I=S.trim();if(!I){u("Informe o e-mail para finalizar o login.");return}try{o(!0),u("");const V=await bv(Qa,I,window.location.href),b=((M=V==null?void 0:V.user)==null?void 0:M.email)||I,g=await xh(b);if(g){t(g),h("");return}const x=await Nh(b);if(x){t({id:x.ownerId,ownerId:x.ownerId,memberId:x.id,name:x.name||"Usurio",email:x.email||b,role:x.role||"staff",isSeller:!!x.isSeller,isTech:!!x.isTech,isAdmin:!!x.isAdmin,active:x.active!==!1}),h("");return}u("Login concludo, mas nenhum perfil encontrado no banco de dados.")}catch(V){u(w(V))}finally{o(!1)}}return a.createElement("div",{className:"min-h-screen flex items-center justify-center bg-[#f7faf9]"},a.createElement("div",{className:"w-[420px] bg-white rounded-lg shadow p-6"},a.createElement("div",{className:"text-center"},a.createElement("div",{className:"font-bold text-xl"},"Siste",a.createElement("span",{className:"text-green-600"},"Mix")),a.createElement("div",{className:"text-sm text-gray-600 mt-1"},"Acesse sua conta")),a.createElement("form",{className:"mt-6 space-y-4",onSubmit:A},a.createElement("div",null,a.createElement("label",{className:"text-sm"},"Email"),a.createElement("input",{className:"mt-1 w-full border rounded p-2",type:"email",value:e,onChange:v=>n(v.target.value),placeholder:"voce@exemplo.com"})),!p&&a.createElement("div",null,a.createElement("label",{className:"text-sm"},"Senha"),a.createElement("input",{className:"mt-1 w-full border rounded p-2",type:"password",value:r,onChange:v=>s(v.target.value),placeholder:""})),c&&a.createElement("div",{className:"text-red-600 text-sm"},c),d&&a.createElement("div",{className:"text-blue-600 text-sm"},d),a.createElement("button",{className:"w-full bg-green-600 text-white py-2 rounded disabled:opacity-60",disabled:i,type:"submit"},i?p?"Enviando link...":"Entrando...":p?"Enviar link por e-mail":"Entrar")),Nv(Qa,window.location.href)&&!window.localStorage.getItem("emailForSignIn")&&a.createElement("div",{className:"mt-6 border-t pt-4"},a.createElement("div",{className:"font-semibold text-sm mb-2"},"Finalizar login por link"),a.createElement("form",{className:"space-y-3",onSubmit:_},a.createElement("div",null,a.createElement("label",{className:"text-sm"},"Confirme seu e-mail"),a.createElement("input",{className:"mt-1 w-full border rounded p-2",type:"email",value:S,onChange:v=>P(v.target.value),placeholder:"voce@exemplo.com"})),a.createElement("button",{className:"w-full bg-green-600 text-white py-2 rounded disabled:opacity-60",disabled:i,type:"submit"},i?"Finalizando...":"Finalizar login")))))}function lR({user:t,onBack:e}){const n=!!(t!=null&&t.memberId),[r,s]=E.useState((t==null?void 0:t.name)||""),[i,o]=E.useState((t==null?void 0:t.email)||""),[c,u]=E.useState((t==null?void 0:t.whatsapp)||""),[d,h]=E.useState(!!(t!=null&&t.notifyEmail)),[p,y]=E.useState(!1),[S,P]=E.useState(""),[w,A]=E.useState(""),[_,v]=E.useState(""),[I,D]=E.useState(""),[M,V]=E.useState(""),[b,g]=E.useState(""),[x,T]=E.useState(""),[k,R]=E.useState(!1),[C,te]=E.useState(!1),[Se,we]=E.useState(!1),[Ae,H]=E.useState(!1);E.useEffect(()=>{s((t==null?void 0:t.name)||""),o((t==null?void 0:t.email)||""),u((t==null?void 0:t.whatsapp)||""),h(!!(t!=null&&t.notifyEmail))},[t]);async function q(K){var se;(se=K==null?void 0:K.preventDefault)==null||se.call(K),y(!0),A(""),P("");try{const U={name:r.trim(),whatsapp:c.trim(),notifyEmail:d};n?await Px(t.ownerId,t.memberId,U):await DP(t.id,U),P("Dados atualizados com sucesso.")}catch(U){A((U==null?void 0:U.message)||"Falha ao salvar dados")}finally{y(!1)}}async function Z(K){var re;(re=K==null?void 0:K.preventDefault)==null||re.call(K),H(!0),T(""),g("");const se=_,U=I,G=M;if(!se||!U||!G){T("Preencha todos os campos de senha."),H(!1);return}if(U.length<6){T("Nova senha deve ter ao menos 6 caracteres."),H(!1);return}if(U!==G){T("Confirmao no corresponde  nova senha."),H(!1);return}try{n?await MP(t.ownerId,t.memberId,se,U):await OP(t.id,se,U),g("Senha alterada com sucesso."),v(""),D(""),V("")}catch(fe){T((fe==null?void 0:fe.message)||"Falha ao alterar senha")}finally{H(!1)}}return a.createElement("div",{className:"space-y-6"},a.createElement("div",{className:"flex items-center justify-between"},a.createElement("h2",{className:"text-lg font-semibold"},"Dados do usurio"),a.createElement("button",{type:"button",onClick:()=>e&&e(),className:"text-sm text-gray-600 hover:text-gray-800"},"Voltar")),a.createElement("div",{className:"rounded-lg bg-white dark:bg-[#101a2d] p-4 shadow"},a.createElement("label",{className:"text-sm text-gray-700 dark:text-gray-200"},"Seu nome"),a.createElement("input",{type:"text",className:"mt-2 w-full border rounded p-2 bg-gray-50 dark:bg-[#0b1320] dark:text-white dark:border-gray-700",value:r,onChange:K=>s(K.target.value),placeholder:"Seu nome"})),a.createElement("div",{className:"rounded-lg bg-white dark:bg-[#101a2d] p-4 shadow"},a.createElement("div",{className:"font-medium text-sm mb-3 text-gray-800 dark:text-gray-100"},"Dados de contato"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},a.createElement("div",null,a.createElement("label",{className:"text-sm text-gray-700 dark:text-gray-200"},"E-mail"),a.createElement("input",{type:"email",className:"mt-2 w-full border rounded p-2 bg-gray-100 dark:bg-[#0b1320] dark:text-white dark:border-gray-700",value:i,readOnly:!0})),a.createElement("div",null,a.createElement("label",{className:"text-sm text-gray-700 dark:text-gray-200"},"Telefone"),a.createElement("input",{type:"tel",className:"mt-2 w-full border rounded p-2 bg-gray-50 dark:bg-[#0b1320] dark:text-white dark:border-gray-700",value:c,onChange:K=>u(K.target.value),placeholder:"(00) 0 0000-0000"}))),a.createElement("div",{className:"mt-3 flex items-center gap-2"},a.createElement("button",{type:"button",onClick:()=>h(K=>!K),className:`w-11 h-6 rounded-full relative ${d?"bg-green-600":"bg-gray-300"}`,"aria-pressed":d},a.createElement("span",{className:`absolute top-0.5 h-5 w-5 rounded-full bg-white shadow transition-all ${d?"right-0.5":"left-0.5"}`})),a.createElement("span",{className:"text-sm text-gray-700 dark:text-gray-200"},"Receber notificaes por E-mail")),a.createElement("div",{className:"mt-4 flex gap-3"},a.createElement("button",{type:"button",onClick:()=>{s((t==null?void 0:t.name)||""),u((t==null?void 0:t.whatsapp)||""),h(!!(t!=null&&t.notifyEmail)),A(""),P("")},className:"text-sm text-gray-600 hover:text-gray-800"},"Cancelar"),a.createElement("button",{type:"button",onClick:q,disabled:p,className:"px-3 py-2 rounded bg-green-600 text-white text-sm disabled:opacity-60"},p?"Salvando...":"Salvar alteraes")),w&&a.createElement("div",{className:"mt-2 text-sm text-red-600"},w),S&&a.createElement("div",{className:"mt-2 text-sm text-green-600"},S)),a.createElement("div",{className:"rounded-lg bg-white dark:bg-[#101a2d] p-4 shadow"},a.createElement("div",{className:"font-medium text-sm mb-3 text-gray-800 dark:text-gray-100"},"Senha"),a.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3"},a.createElement("div",null,a.createElement("label",{className:"text-sm text-gray-700 dark:text-gray-200"},"Senha atual"),a.createElement("div",{className:"mt-2 flex items-center gap-2"},a.createElement("input",{type:k?"text":"password",className:"flex-1 border rounded p-2 bg-gray-50 dark:bg-[#0b1320] dark:text-white dark:border-gray-700",value:_,onChange:K=>v(K.target.value),placeholder:""}),a.createElement("button",{type:"button",onClick:()=>R(K=>!K),className:"text-sm text-gray-600 dark:text-gray-300"},k?"Ocultar":"Mostrar"))),a.createElement("div",null,a.createElement("label",{className:"text-sm text-gray-700 dark:text-gray-200"},"Nova senha"),a.createElement("div",{className:"mt-2 flex items-center gap-2"},a.createElement("input",{type:C?"text":"password",className:"flex-1 border rounded p-2 bg-gray-50 dark:bg-[#0b1320] dark:text-white dark:border-gray-700",value:I,onChange:K=>D(K.target.value),placeholder:""}),a.createElement("button",{type:"button",onClick:()=>te(K=>!K),className:"text-sm text-gray-600 dark:text-gray-300"},C?"Ocultar":"Mostrar"))),a.createElement("div",null,a.createElement("label",{className:"text-sm text-gray-700 dark:text-gray-200"},"Confirmar nova senha"),a.createElement("div",{className:"mt-2 flex items-center gap-2"},a.createElement("input",{type:Se?"text":"password",className:"flex-1 border rounded p-2 bg-gray-50 dark:bg-[#0b1320] dark:text-white dark:border-gray-700",value:M,onChange:K=>V(K.target.value),placeholder:""}),a.createElement("button",{type:"button",onClick:()=>we(K=>!K),className:"text-sm text-gray-600 dark:text-gray-300"},Se?"Ocultar":"Mostrar")))),a.createElement("div",{className:"mt-4 flex gap-3"},a.createElement("button",{type:"button",onClick:()=>{v(""),D(""),V(""),T(""),g("")},className:"text-sm text-gray-600 hover:text-gray-800"},"Cancelar"),a.createElement("button",{type:"button",onClick:Z,disabled:Ae,className:"px-3 py-2 rounded bg-green-600 text-white text-sm disabled:opacity-60"},Ae?"Salvando...":"Salvar alteraes")),x&&a.createElement("div",{className:"mt-2 text-sm text-red-600"},x),b&&a.createElement("div",{className:"mt-2 text-sm text-green-600"},b)))}const cR={inicio:"Incio",clientes:"Clientes",produtos:"Produtos",vendas:"Vendas",os:"Ordem de Servio",configuracoes:"Configuraes",usuarios:"Usurios",taxas:"Taxas adicionais",metas:"Metas",dadosUsuario:"Dados do usurio"},Bv=60*60*1e3;function uR(){const[t,e]=E.useState("inicio"),[n,r]=E.useState(null),[s,i]=E.useState(null),[o,c]=E.useState(!1),[u,d]=E.useState(0),[h,p]=E.useState(0),[y,S]=E.useState(0),[P,w]=E.useState(null),[A,_]=E.useState(!1);if(E.useEffect(()=>{try{const M=localStorage.getItem("session");if(!M)return;const{user:V,store:b,lastActivity:g}=JSON.parse(M),x=Date.now();V&&typeof g=="number"&&x-g<Bv?(r(V),i(b||null)):localStorage.removeItem("session")}catch{}},[]),E.useEffect(()=>{if(n){const M=localStorage.getItem("session");let V={};try{V=M?JSON.parse(M):{}}catch{}localStorage.setItem("session",JSON.stringify({...V,user:n,store:s,lastActivity:Date.now()}))}else localStorage.removeItem("session")},[n,s]),E.useEffect(()=>{try{const V=localStorage.getItem("darkMode")==="1";_(V);const b=document.documentElement;V?b.classList.add("dark"):b.classList.remove("dark")}catch{}},[]),E.useEffect(()=>{try{localStorage.setItem("darkMode",A?"1":"0");const M=document.documentElement;A?M.classList.add("dark"):M.classList.remove("dark")}catch{}},[A]),E.useEffect(()=>{if(!n)return;const M=()=>{try{const g=localStorage.getItem("session"),x=g?JSON.parse(g):{};x.lastActivity=Date.now(),x.user=n,x.store=s,localStorage.setItem("session",JSON.stringify(x))}catch{}},V=["mousemove","mousedown","keydown","touchstart","scroll"];V.forEach(g=>document.addEventListener(g,M,{passive:!0}));const b=setInterval(()=>{const g=localStorage.getItem("session");let x=0;try{x=(g?JSON.parse(g):{}).lastActivity||0}catch{}Date.now()-x>=Bv&&I()},60*1e3);return()=>{V.forEach(g=>document.removeEventListener(g,M)),clearInterval(b)}},[n,s]),!n)return a.createElement(oR,{onLoggedIn:r});if(!s)return a.createElement(rR,{user:n,onSelect:M=>i(M)});function v(M){e(M),c(!1)}function I(){localStorage.removeItem("session"),i(null),r(null),e("inicio")}const D={name:`${n.name}  ${(s==null?void 0:s.name)||""}`.trim()};return a.createElement("div",{className:"min-h-screen bg-[#f7faf9] dark:bg-[#0b1320] overflow-x-hidden"},a.createElement("div",{className:"md:flex"},a.createElement(d1,{onNavigate:v,active:t,onLogout:I,mobileOpen:o,onMobileClose:()=>c(!1)}),o?a.createElement("div",{className:"fixed inset-0 bg-black/40 md:hidden","aria-hidden":"true",onClick:()=>c(!1)}):null,a.createElement("div",{className:"flex-1 p-4 md:p-6 w-full max-w-full overflow-x-hidden"},a.createElement(m1,{user:D,title:cR[t]||"Incio",onUserClick:()=>i(null),mobileControls:{open:()=>c(!0),close:()=>c(!1),toggle:()=>c(M=>!M),isOpen:o},rightAction:t==="produtos"?a.createElement("button",{className:"md:hidden h-9 px-3 rounded bg-green-600 text-white text-sm flex items-center gap-2 shadow-sm active:scale-[0.98]",onClick:()=>d(M=>M+1),"aria-label":"Adicionar novo",title:"Adicionar novo"},a.createElement("span",null,"+ Novo")):t==="os"?a.createElement("button",{className:"md:hidden h-9 px-3 rounded bg-green-600 text-white text-sm flex items-center gap-2 shadow-sm active:scale-[0.98]",onClick:()=>p(M=>M+1),"aria-label":"Nova OS",title:"Nova OS"},a.createElement("span",null,"+ Nova")):t==="clientes"?a.createElement("button",{className:"md:hidden h-9 px-3 rounded bg-green-600 text-white text-sm flex items-center gap-2 shadow-sm active:scale-[0.98]",onClick:()=>S(M=>M+1),"aria-label":"Novo cliente",title:"Novo cliente"},a.createElement("span",null,"+ Novo")):null}),t==="inicio"?a.createElement("div",{className:"mt-4 md:mt-6"},a.createElement(xP,{storeId:s==null?void 0:s.id,onNavigate:v,onOpenSalesDay:M=>{w(M),v("vendas")}})):t==="vendas"?a.createElement("div",{className:"mt-4 md:mt-6"},a.createElement(vP,{initialDayFilter:P})):t==="produtos"?a.createElement("div",{className:"mt-4 md:mt-6"},a.createElement(mP,{storeId:s==null?void 0:s.id,addNewSignal:u})):t==="os"?a.createElement("div",{className:"mt-4 md:mt-6"},a.createElement(BP,{storeId:s==null?void 0:s.id,ownerId:n==null?void 0:n.id,addNewSignal:h})):t==="clientes"?a.createElement("div",{className:"mt-4 md:mt-6"},a.createElement(rP,{storeId:s==null?void 0:s.id,addNewSignal:y})):t==="configuracoes"?a.createElement("div",{className:"mt-4 md:mt-6"},a.createElement(QP,{user:n,store:s,onNavigate:v,onLogout:I,darkMode:A,onToggleDark:()=>_(M=>!M)})):t==="dadosEmpresa"?a.createElement("div",{className:"mt-4 md:mt-6"},a.createElement(YP,{storeId:s==null?void 0:s.id,onBack:()=>v("configuracoes")})):t==="taxas"?a.createElement("div",{className:"mt-4 md:mt-6"},a.createElement(nR,{storeId:s==null?void 0:s.id,onBack:()=>v("configuracoes")})):t==="usuarios"?a.createElement("div",{className:"mt-4 md:mt-6"},a.createElement(iR,{owner:n})):t==="metas"?a.createElement("div",{className:"mt-4 md:mt-6"},a.createElement(jP,{storeId:s==null?void 0:s.id,owner:n})):t==="dadosUsuario"?a.createElement("div",{className:"mt-4 md:mt-6"},a.createElement(lR,{user:n,onBack:()=>v("configuracoes")})):a.createElement("div",{className:"rounded-lg bg-white p-6 shadow mt-6"},a.createElement("p",{className:"text-sm text-gray-600"},"Pgina em construo.")))))}J0(document.getElementById("root")).render(a.createElement(a.StrictMode,null,a.createElement(uR,null)));
